



<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>&#23609;&#30427;&amp;&#26361;&#38160;&#24609;&#23130;&#23476;&#36992;&#32422;</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="2015&#24180;05&#26376;02&#26085;"/>

	<link href="./code.photoswipe-3.0.5/3.0.5/examples/styles_leo2.css" type="text/css" rel="stylesheet" />
	<link href="./code.photoswipe-3.0.5/3.0.5/photoswipe.css" type="text/css" rel="stylesheet" />
	<script type="text/javascript" src="./code.photoswipe-3.0.5/3.0.5/lib/klass.min.js"></script>






<link rel="stylesheet" href="css/jquery-ui-1.8.18.custom.full_leo2.css" type="text/css" media="screen" charset="utf-8">
<link rel="stylesheet" type="text/css" href="css/jquery.Jcrop.css" />    
<link rel="stylesheet" href="css/frosty.min.css" type="text/css" media="screen" charset="utf-8">

<script type="text/javascript" src="firefox_xml_maxthon.js"></script>
<script type="text/javascript" src="js/jquery-latest.js"></script>
<script type="text/javascript" src="js/jquery.xdomainrequest.min.js"></script>
<script type="text/javascript" src="js/jquery-ui-1.8.18.full.min.js"></script>
<script type="text/javascript" src="js/jquery.Jcrop.min.js"></script>  
<script type="text/javascript" src="js/frosty.min.js"></script>
<script type="text/javascript" src="js/jquery-scrolltofixed-min.js"></script>


	<script src="http://api.map.baidu.com/api?v=2.0&ak=HACDI785p3wu9r5kynf6fY1i" type="text/javascript"></script>

<script type="text/javascript" src="/ckeditor4.3.4_leo/ckeditor.js"></script>
<script type="text/javascript" src="js/date.format.js"></script>
<script type="text/javascript">



function MM_goToURL() { //v3.0
  var i, args=MM_goToURL.arguments; document.MM_returnValue = false;
  for (i=0; i<(args.length-1); i+=2) eval(args[i]+".location='"+args[i+1]+"'");
}
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d=document; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}




		
  		var bshow2270339 = 1;
		
  		var bshow2270340 = 1;
		
  		var bshow2270343 = 1;

			
				  var geocoder2270343;
				  
				  function codeAddress2270343(address) {
					//var address = document.getElementById("address2270343").value;
				 
			//alert(address);	 
					// Baidu map ?建地址解析器?例
					geocoder2270343 = new BMap.Geocoder();
					// ?地址解析?果?示在地?上,并?整地??野
					geocoder2270343.getPoint(address, function(point){
					  if (point) {
						map2270343.setCenter(point);
						marker2270343.setPosition(point);
						$('#invite_detail_latcenter2270343').val(point.lat);  
						$('#invite_detail_lngcenter2270343').val(point.lng);  
						$('#invite_detail_latmarker2270343').val(point.lat);  
						$('#invite_detail_lngmarker2270343').val(point.lng);  
				
						$('#iframepage').get(0).contentWindow.setMapCenter2270343(point.lng,point.lat);	
						$('#iframepage').get(0).contentWindow.setMarkerPos2270343(point.lng,point.lat);	  
				
				
					  } else {
						alert("定位失败, 请修改地址後再试一次，失败原因： " + status);
					  }
					}, "");
				
				  }
				  
				//baidu map
				  var map2270343 = null;
				  var marker2270343;
				  var map2270343_latcenter = 40.007474;
				  var map2270343_lngcenter = 116.397859;
				  var map2270343_latmarker = 40.007474;
				  var map2270343_lngmarker = 116.397859;
				  
				  
				  
				  function initialize2270343() {
				
				//Baidu MAP Control
					map2270343 = new BMap.Map("map_canvas2270343",{enableMapClick: false});
				//alert (map2270343_latcenter + "," + map2270343_lngcenter);
				
					//var point = new BMap.Point(116.404, 39.915);  // ?建?坐?
					//var point = new BMap.Point(map2270343_lngcenter, map2270343_latcenter );  // ?建?坐?
					map2270343.centerAndZoom(new BMap.Point(map2270343_lngcenter, map2270343_latcenter ),  16);                 // 初始化地?，?置中心?坐?和地???

				/*	
					
					var  mapStyle ={ 
							features: ["road", "building","water","land"],//隐藏地图上的poi
							style : "dark"  //设置地图风格为高端黑
						}
					map2270343.setMapStyle(mapStyle);
 
				*/
					var opts = {type: BMAP_NAVIGATION_CONTROL_ZOOM}  
					map2270343.addControl(new BMap.NavigationControl(opts));  
					//map2270343.addControl(new BMap.ScaleControl());  
					//map2270343.addControl(new BMap.OverviewMapControl());  
					//map2270343.addControl(new BMap.MapTypeControl());
					//var opts = {anchor: BMAP_ANCHOR_BOTTOM_RIGHT }  
					//map2270343.addControl(new CopyrightControl(opts));
				
				
					map2270343.addEventListener("click", function(e){
						//alert("你??了地?");
						$('#invite_detail_latmarker2270343').val(e.point.lat);  
						$('#invite_detail_lngmarker2270343').val(e.point.lng);  
						marker2270343.setPosition(e.point);
						$('#iframepage').get(0).contentWindow.setMarkerPos2270343(e.point.lng,e.point.lat);	  
					});
				
					map2270343.addEventListener("moving", function(){  
					 var center = map2270343.getCenter();  
					 //alert("地?中心??更?：" + center.lng + ", " + center.lat);  
					 $('#invite_detail_latcenter2270343').val(center.lat);  
					 $('#invite_detail_lngcenter2270343').val(center.lng);  
					 $('#iframepage').get(0).contentWindow.setMapCenter2270343(center.lng,center.lat);	
					});  
				
					map2270343.addEventListener("zoomend", function(){  
					 $('#invite_detail_zoom2270343').val(map2270343.getZoom());  
					 $('#iframepage').get(0).contentWindow.setMapZoom2270343(map2270343.getZoom());	  
					});
				
					// ?建???象  
					var myIcon = new BMap.Icon("images/mobile_invite/map_marker.png", new BMap.Size(34, 34), {  
					// 指定定位位置。  
					// ??注?示在地?上?，其所指向的地理位置距离??左上  
					   // 角各偏移10像素和25像素。您可以看到在本例中?位置即是  
					   // ??中央下端的尖角位置。  
					   offset: new BMap.Size(17, 34),  
					   // ?置?片偏移。  
					   // ?您需要?一幅?大的?片中截取某部分作??注???，您  
					   // 需要指定大?的偏移位置，此做法与css sprites技??似。  
					   imageOffset: new BMap.Size(0,0)   // ?置?片偏移  
					 });    
					 // ?建?注?象并添加到地?  
				
					marker2270343 = new BMap.Marker(
						new BMap.Point(map2270343_lngmarker, map2270343_latmarker), 
						{	
							icon: myIcon, 
							enableDragging: true,
							raiseOnDrag: true,
							title: "拖拽以俗⒌攸c" 
						}
					); // ?建?注  
					
					marker2270343.addEventListener("dragging", function(e){
					
					 $('#invite_detail_latmarker2270343').val(e.point.lat);  
					 $('#invite_detail_lngmarker2270343').val(e.point.lng);  
					 $('#iframepage').get(0).contentWindow.setMarkerPos2270343(e.point.lng,e.point.lat);	  
					
					
					});
					map2270343.addOverlay(marker2270343);                     
				  }
				  
			
			
					
  		var bshow2270344 = 1;
		
  		var bshow2270341 = 0;
		
  		var bshow2270342 = 0;
		
  		var bshow2270345 = 0;
		
  		var bshow2270346 = 0;
		
  		var bshow2270347 = 0;

			
				  var geocoder2270347;
				  
				  function codeAddress2270347(address) {
					//var address = document.getElementById("address2270347").value;
				 
			//alert(address);	 
					// Baidu map ?建地址解析器?例
					geocoder2270347 = new BMap.Geocoder();
					// ?地址解析?果?示在地?上,并?整地??野
					geocoder2270347.getPoint(address, function(point){
					  if (point) {
						map2270347.setCenter(point);
						marker2270347.setPosition(point);
						$('#invite_detail_latcenter2270347').val(point.lat);  
						$('#invite_detail_lngcenter2270347').val(point.lng);  
						$('#invite_detail_latmarker2270347').val(point.lat);  
						$('#invite_detail_lngmarker2270347').val(point.lng);  
				
						$('#iframepage').get(0).contentWindow.setMapCenter2270347(point.lng,point.lat);	
						$('#iframepage').get(0).contentWindow.setMarkerPos2270347(point.lng,point.lat);	  
				
				
					  } else {
						alert("定位失败, 请修改地址後再试一次，失败原因： " + status);
					  }
					}, "");
				
				  }
				  
				//baidu map
				  var map2270347 = null;
				  var marker2270347;
				  var map2270347_latcenter = 31.240629;
				  var map2270347_lngcenter = 121.512625;
				  var map2270347_latmarker = 31.241401;
				  var map2270347_lngmarker = 121.512876;
				  
				  
				  
				  function initialize2270347() {
				
				//Baidu MAP Control
					map2270347 = new BMap.Map("map_canvas2270347",{enableMapClick: false});
				//alert (map2270347_latcenter + "," + map2270347_lngcenter);
				
					//var point = new BMap.Point(116.404, 39.915);  // ?建?坐?
					//var point = new BMap.Point(map2270347_lngcenter, map2270347_latcenter );  // ?建?坐?
					map2270347.centerAndZoom(new BMap.Point(map2270347_lngcenter, map2270347_latcenter ),  16);                 // 初始化地?，?置中心?坐?和地???

				/*	
					
					var  mapStyle ={ 
							features: ["road", "building","water","land"],//隐藏地图上的poi
							style : "dark"  //设置地图风格为高端黑
						}
					map2270347.setMapStyle(mapStyle);
 
				*/
					var opts = {type: BMAP_NAVIGATION_CONTROL_ZOOM}  
					map2270347.addControl(new BMap.NavigationControl(opts));  
					//map2270347.addControl(new BMap.ScaleControl());  
					//map2270347.addControl(new BMap.OverviewMapControl());  
					//map2270347.addControl(new BMap.MapTypeControl());
					//var opts = {anchor: BMAP_ANCHOR_BOTTOM_RIGHT }  
					//map2270347.addControl(new CopyrightControl(opts));
				
				
					map2270347.addEventListener("click", function(e){
						//alert("你??了地?");
						$('#invite_detail_latmarker2270347').val(e.point.lat);  
						$('#invite_detail_lngmarker2270347').val(e.point.lng);  
						marker2270347.setPosition(e.point);
						$('#iframepage').get(0).contentWindow.setMarkerPos2270347(e.point.lng,e.point.lat);	  
					});
				
					map2270347.addEventListener("moving", function(){  
					 var center = map2270347.getCenter();  
					 //alert("地?中心??更?：" + center.lng + ", " + center.lat);  
					 $('#invite_detail_latcenter2270347').val(center.lat);  
					 $('#invite_detail_lngcenter2270347').val(center.lng);  
					 $('#iframepage').get(0).contentWindow.setMapCenter2270347(center.lng,center.lat);	
					});  
				
					map2270347.addEventListener("zoomend", function(){  
					 $('#invite_detail_zoom2270347').val(map2270347.getZoom());  
					 $('#iframepage').get(0).contentWindow.setMapZoom2270347(map2270347.getZoom());	  
					});
				
					// ?建???象  
					var myIcon = new BMap.Icon("images/mobile_invite/map_marker.png", new BMap.Size(34, 34), {  
					// 指定定位位置。  
					// ??注?示在地?上?，其所指向的地理位置距离??左上  
					   // 角各偏移10像素和25像素。您可以看到在本例中?位置即是  
					   // ??中央下端的尖角位置。  
					   offset: new BMap.Size(17, 34),  
					   // ?置?片偏移。  
					   // ?您需要?一幅?大的?片中截取某部分作??注???，您  
					   // 需要指定大?的偏移位置，此做法与css sprites技??似。  
					   imageOffset: new BMap.Size(0,0)   // ?置?片偏移  
					 });    
					 // ?建?注?象并添加到地?  
				
					marker2270347 = new BMap.Marker(
						new BMap.Point(map2270347_lngmarker, map2270347_latmarker), 
						{	
							icon: myIcon, 
							enableDragging: true,
							raiseOnDrag: true,
							title: "拖拽以俗⒌攸c" 
						}
					); // ?建?注  
					
					marker2270347.addEventListener("dragging", function(e){
					
					 $('#invite_detail_latmarker2270347').val(e.point.lat);  
					 $('#invite_detail_lngmarker2270347').val(e.point.lng);  
					 $('#iframepage').get(0).contentWindow.setMarkerPos2270347(e.point.lng,e.point.lat);	  
					
					
					});
					map2270347.addOverlay(marker2270347);                     
				  }
				  
			
			
					
  		var bshow2270348 = 0;
		
  		var bshow2270349 = 0;
		
  		var bshow2270350 = 0;
  
  


$(function() {

	$( "#accordion_header" ).accordion({
		autoHeight: false, 
		collapsible: true
	});
	
	$("#accordion_header").bind('accordionchange', function(event, ui) {
	 // ui.newHeader // jQuery object, activated header
	 // ui.oldHeader // jQuery object, previous header
	 // ui.newContent // jQuery object, activated content
	 // ui.oldContent // jQuery object, previous content
	 //  alert($(ui.newHeader).attr("id") + " was opened, " + $(ui.oldHeader).attr("id") + " was closed");
	 //   console.log(ui.newHeader.attr('id'));
		if (ui.newHeader.attr('id') == 'header')
		{
			 $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
			 
			 
		}
        $('html, body').animate({scrollTop: $("#accordion_header").offset().top} );
		
		
	});
		
	
	$( "#accordion_detail" ).accordion({
		autoHeight: false, 
		collapsible: false
	});


});



$(document).ready(function(){
  $('input[type=text][title],input[type=password][title],textarea[title]').each(function(i){
    $(this).addClass('input-prompt-' + i);
    var promptSpan = $('<span class="input-prompt"/>');
    $(promptSpan).attr('id', 'input-prompt-' + i);
    $(promptSpan).append($(this).attr('title'));
    $(promptSpan).click(function(){
      $(this).hide();
      $('.' + $(this).attr('id')).focus();
    });
    if($(this).val() != ''){
      $(promptSpan).hide();
    }
    $(this).before(promptSpan);
    $(this).focus(function(){
      $('#input-prompt-' + i).hide();
    });

    $(this).change(function(){
      if($(this).val() != ''){
        $('#input-prompt-' + i).hide();
      }
    });
    $(this).blur(function(){
      if($(this).val() == ''){
        $('#input-prompt-' + i).show();
      }
    });
  });
});


function indexOfStr(strArray, searchString) {
	var found = -1;
	
	for (var i = 0; i < strArray.length; i++) {
	  if (strArray[i] == searchString) {
		found = i;
		break;
	  }
	}
	return found;
}

function getMinTextInOrder(txt){
	var txt_array_inorder = txt.split('').sort();
	
	if (txt_array_inorder.length > 0) {
		txt_min = txt_array_inorder[0]; 
		prechr = txt_array_inorder[0];
		for (i=1; i<txt_array_inorder.length; i++){
			if (txt_array_inorder[i] != prechr){
				prechr = txt_array_inorder[i];
				txt_min = txt_min + txt_array_inorder[i];
			}
		}
	} else {
		txt_min = "";
	}

	return txt_min;	
}



function getMainPanelText(){

	var panel_text = '本服务由YouVivid.com提供' + $('#invite_maintitle').val() + $('#invite_subtitle').val();
	$('.tab_name').each( function () {
		panel_text = panel_text + $(this).val();
	});
	return encodeURIComponent(getMinTextInOrder(panel_text));
}

var delay = (function(){
  var timer = 0;
  return function(callback, ms){
	clearTimeout (timer);
	timer = setTimeout(callback, ms);
  };
})();


var webfont_index = 1;

function reloadMainPanelFont(){

	var fontData = $("#invite_fontface option:selected").val();
	//alert(fontData);
	var fontfamily = fontData.split('|')[0];
	var fontface = fontData.split('|')[1];
	var bwebfont = fontData.split('|')[2];
	var webfonttype = fontData.split('|')[3];
	
	if (bwebfont == 1) {
		if (webfonttype==3){
			$('#iframepage').contents().find(".fontcss").attr("href",fontface); 
		} else {
			fontfamily = fontfamily.split(',')[0] + webfont_index;
			fontface = fontface.split('&font=')[0] + webfont_index + '&font=' + fontface.split('&font=')[1];
		//alert(fontfamily );
		//alert(fontface );
			fontface=fontface + "&text=" + getMainPanelText();
		//	alert( 'fontfamily=' + fontfamily + ', fontface=' + fontface);
			//alert(fontface);
			//$('#iframepage').contents().find(".fontcss").remove();
			//$('#iframepage').contents().find('head').append('<link class="fontcss"  rel="stylesheet" type="text/css" href="'+ fontface +'">');
			
			$('#iframepage').contents().find(".fontcss").attr("href",fontface); 
			webfont_index = webfont_index + 1;
		}
		
	}
	$('#iframepage').contents().find("body").css("font-family",fontfamily); 
	$('#iframepage').contents().find(".ui-widget").css("font-family",fontfamily); 

}




(function($, undefined) {
    if (!$.xui) {
        $.xui = {};
    }
    var tabs = $.extend({}, $.ui.tabs.prototype),
        _super = {
            _create: tabs._create,
            _destroy: tabs._destroy,
            _update: tabs._update
        };
    $.xui.tabs = $.extend(tabs, {
        options: $.extend({}, tabs.options, {
            scrollable: false,
            changeOnScroll: false,
            closable: false,
            resizable: false,
            resizeHandles: "e,s,se"
        }),
        _create: function() {
            var self = this,
                o = self.options;
            _super._create.apply(self);
            if (o.scrollable) {
                self.element.addClass("ui-tabs-scrollable");
                var scrollContainer = $('<div class="ui-tabs-scroll-container"></div>').prependTo(this.element);
                self.header = $('<div class="ui-tabs-nav-scrollable ui-widget-header ui-corner-all"></div>').prependTo(scrollContainer);
                var nav = self.element.find(".ui-tabs-nav:first").removeClass("ui-widget-header ui-corner-all").appendTo(this.header);
                var arrowsNav = $('<ol class="ui-helper-reset ui-helper-clearfix ui-tabs-nav-arrows"></ol>').prependTo(self.element);
                var navPrev = $('<li class="ui-tabs-arrow-previous ui-state-default ui-corner-bl ui-corner-tl" title="左移"><a href="#"><span class="ui-icon ui-icon-carat-1-w">Previous tab</span></a></li>').prependTo(arrowsNav).hide(),
                    navNext = $('<li class="ui-tabs-arrow-next ui-state-default ui-corner-tr ui-corner-br" title="右移"><a href="#"><span class="ui-icon ui-icon-carat-1-e">Next tab</span></a></li>').appendTo(arrowsNav).hide();
                
                
                var scrollTo = function(to, delay) {
                    var navWidth = 0,
                        arrowWidth = navPrev.outerWidth(),
                        marginLeft = -(parseInt(nav.css("marginLeft"), 10)),
                        hwidth = self.header.width(),
                        newMargin = 0;
                    
                    nav.find("li").each(function() {
                        navWidth += $(this).outerWidth(true);
                    });
                    
                    if (to instanceof $.Event) {
                        
                    } else {
                        newMargin = marginLeft+to;
                        if (newMargin > (navWidth-hwidth)) {
                            newMargin = (navWidth-hwidth);
                        } else if (newMargin < 0) {
                            newMargin = 0;
                        }
                        nav.stop(true).animate({
                            marginLeft: -(newMargin)
                        }, delay, function(){
                            $(window).trigger("resize.tabs");
                        });
                    }
                }
                
                
                var holdTimer = false;
                navPrev.add(navNext).bind({
                    "click": function(e) {
                        var isNext = this === navNext[0];
                        e.preventDefault();
                        if (o.changeOnScroll) {
                            self.select(self.options.selected + (isNext ? 1 : -1));
                        } else {
                            if (!holdTimer)
                                scrollTo(isNext ? 150 : -150, 250);
                        }
                    },
                    "mousedown": function(e){
                        if (!o.changeOnScroll) {
                            var isNext = this === navNext[0],
                                duration = 10, pos = 15, timer;
                            if (holdTimer)
                                clearTimeout(holdTimer);
                            holdTimer = setTimeout(timer = function(){
                                scrollTo(isNext ? pos : -(pos), duration);
                                holdTimer = setTimeout(arguments.callee, duration);
                            }, 150);
                        }
                    },
                    "mouseup mouseout": function(e){
                        if (!o.changeOnScroll) {
                            clearTimeout(holdTimer);
                            holdTimer = false;
                            nav.stop();
                        }
                    }
                });
                
                self.header.bind('mousewheel', function(e, d, dX, dY) {
                    e.preventDefault();
                    if (d === -1) {
                        navNext.click();
                    } else if (d === 1) {
                        navPrev.click();
                    }
                });

                $(window).bind("resize.tabs", function(e) {
                    var navWidth = 0;
                    var arrowWidth = navPrev.outerWidth();
                    nav.find("li").each(function() {
                        navWidth += $(this).outerWidth(true);
                    });
                    
                    var marginLeft = -(parseInt(nav.css("marginLeft"), 10)),
                        hwidth = self.header.width();
                    
                    if (navWidth > (hwidth+marginLeft)) {
                        self.header.addClass("ui-tabs-arrow-r");
                        navNext.show("fade");
                        if (marginLeft > 0) {
                            self.header.addClass("ui-tabs-arrow-l");
                            navPrev.show("fade");
                        } else {
                            self.header.removeClass("ui-tabs-arrow-l");
                            navPrev.hide("fade");
                        }
                    } else {
                        self.header.removeClass("ui-tabs-arrows ui-tabs-arrow-l");
                        navNext.hide("fade");
                        if (marginLeft > 0) {
                            self.header.addClass("ui-tabs-arrow-l");
                            navPrev.show("fade");
                        } else {
                            self.header.removeClass("ui-tabs-arrow-l");
                            navPrev.hide("fade");
                        }
                    }
                }).trigger("resize.tabs");
                
                arrowsNav.find("li").bind({
                    "mouseenter focus": function(e) {
                        $(this).addClass("ui-state-hover");
                    },
                    "mouseleave blur": function(e) {
                        $(this).removeClass("ui-state-hover");
                    }
                });

                this.anchors.bind("click.tabs", function(){
                    var li = $(this).parent(),
                        arrowWidth = navPrev.outerWidth(),
                        width = li.outerWidth(true),
                        hwidth = self.header.width(),
                        pos = li.position().left,
                        marginLeft = -(parseInt(nav.stop(true,true).css("marginLeft"),10)),
                        newMargin = -1;

                    if (li.index() === 0) {
                        newMargin = 0;
                    } else if ((pos+width) >= (hwidth+marginLeft)) {
                        newMargin = pos-hwidth+width;
                        if ((li.index()+1) < nav.find("li").length) {
                            newMargin += arrowWidth;
                        }
                    } else if (pos < marginLeft) {
                        newMargin = pos-arrowWidth;
                    }
                    
                    if (newMargin > -1) {
                        nav.animate({
                            marginLeft: -(newMargin)
                        }, 250, function(){
                            $(window).trigger("resize.tabs");
                        });
                    }
                });
            }
            return self;
        },
        _update: function(){
            ////console.log(arguments);
            _super._update.apply(this);
        }
    });
    $.widget("xui.tabs", $.xui.tabs);
})(jQuery);


$(document).ready(function() { 



//alert(getMainPanelText());
	$("#invite_style").change(function() {
		$('#invite_stylename').val($("#invite_style option:selected").text());  

		var stylecssurl = $(this).val().split('|')[0];
		var styleimagefolder = $(this).val().split('|')[1];
		var customstylecssurl = $(this).val().split('|')[2];
		var styletype = $(this).val().split('|')[3];
		$('#invite_styleid').val($(this).val().split('|')[4]);  

		$('#iframepage').contents().find(".themecss").attr("href",stylecssurl); 
		$('#iframepage').contents().find(".customcss").attr("href",customstylecssurl); 
//alert($('#iframepage').contents().find('#iconimage').attr('alt'));
		$('#iframepage').contents().find('.iconimage').each(function () {
			//alert($(this).attr('alt'));
			imageName = $(this).attr('alt');
			$(this).attr('src', styleimagefolder + imageName);
			//alert($(this).attr('src'));
		});
		$('#iframepage').get(0).contentWindow.invite_styletype = styletype;
		
		$('#iframepage').get(0).contentWindow.initProcessButtonBackground();	//call iframe function to reset id	 

		
	});



	$("#invite_fontface").change(function() {
		$('#invite_fontname').val($("#invite_fontface option:selected").text());  
		reloadMainPanelFont();
	});







	$("#invite_maintitle,#invite_subtitle,.tab_name").keyup(function() {


		delay(function(){

			reloadMainPanelFont();

		}, 1000 );

	});




	$(".tab_name").addClass("tab_name_idle");
/*
	$(".tab_name").focus(function() {
		$(this).removeClass("tab_name_idle").addClass("tab_name_focus");
	});
	$(".tab_name").blur(function() {
		$(this).removeClass("tab_name_focus").addClass("tab_name_idle");
	});
	
	$(".tab_name").hover(function() {
		  $(this).removeClass('tab_name_idle'); 
		  $(this).addClass('tab_name_hover');
	   }, 
	   function() {
		  $(this).removeClass('tab_name_hover'); 
		  $(this).addClass('tab_name_idle');
	   }
	);
*/

	//$( "#tabs" ).tabs({selected: 3});
	$( "#tabs" ).tabs({
		selected: -1,
        scrollable: true,
        changeOnScroll: false,
        closable: false
	});
	//$( "#tabs" ).tabs({ disabled: [2, 3] });

	$( "#tabs" ).tabs().find( ".ui-tabs-nav" ).sortable({ axis: "x",
		//start: function(event, ui) { alert("start sort") },
		items: 'li',
		update: function(event, ui) {
			var id_selected = ui.item.attr("id");
			var id_array = $(this).sortable('toArray');
			 //console.log( id_selected );
			 //console.log( id_array );
	
			 
			 //index_selected = id_array.indexOf(id_selected);
			 index_selected = indexOfStr(id_array,id_selected);
			 
			 
//			 console.log( index_selected );
			 if (index_selected != 0) {
				var id_moveto = id_array[index_selected-1];
				$('#iframepage').contents().find('#invite_detail_title' + id_selected ).insertAfter($('#iframepage').contents().find('#invite_detail_content' + id_moveto));	 
				 
			 } else {
				var id_moveto =  id_array[1];
				$('#iframepage').contents().find('#invite_detail_title' + id_selected ).insertBefore($('#iframepage').contents().find('#invite_detail_title' + id_moveto));	 
			 }
			try { 
				$('#iframepage').contents().find('#invite_detail_content' + id_selected ).insertAfter($('#iframepage').contents().find('#invite_detail_title' + id_selected));
			}
			catch(err) {
				//do nothing
			}
			finally {
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 
				// alert(id_selected + ":3");
			}
			 
			 
			 //
			 
			//var invite_detail_id = ui.tab.id.substr(19, ui.tab.id.length - 19 );
			//alert(invite_detail_id);
			//$("#div2").insertAfter("#div3");
		//$('#iframepage').contents().find('#invite_detail_title660').insertAfter($('#iframepage').contents().find('#invite_detail_content657'));
			//$('#iframepage').contents().find('#invite_detail_content660').insertAfter($('#iframepage').contents().find('#invite_detail_title660'));

			//$('#iframepage').contents().find('div[name="button1"]').attr('id','button400'); 
			//var id_buf = $('#iframepage').contents().find('div[name="button1"]').attr('id'); 
			//alert(id_buf);
			
		}
		//change: function(event, ui) { alert("change sort")}

	});



	$('#tabs').bind('tabsselect', function(event, ui) {
		//ui.tab     // anchor element of the selected (clicked) tab
		//ui.panel   // element, that contains the selected/clicked tab contents
		//ui.index   // zero-based index of the selected (clicked) tab
		//alert($("#accordion_header").accordion("activate"));
		$("#accordion_header").accordion("activate", false );
		
		
		//"invite_detail_title" length = 19
		var invite_detail_id = ui.tab.id.substr(19, ui.tab.id.length - 19 );
		
		//alert(invite_detail_id);
		$(".tab_name").removeClass("tab_name_idle");
		//$(".tab_name").removeClass("tab_name_focus");
		$(".tab_name").addClass("tab_name_idle");
		$("#invite_detail_name" + invite_detail_id ).removeClass("tab_name_idle");

		var tabSelected = ui.index;
		//alert($('#tabs').tabs( "option", "selected" ))
		var accordionActive = $('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active" );
	    //console.log("tabSelected=" + tabSelected + ", " + "accordionActive=" + accordionActive );		
		
		if (accordionActive===false){
			accordionActive = -1;
		}
//	    console.log("tabSelected=" + tabSelected + ", " + "accordionActive=" + accordionActive );		
//	    console.log(accordionActive);		
//		console.log($('#iframepage').contents().find('h3>a[id^="invite_detail_title"]')[accordionActive].id);
		//console.log($("input[id='invite_detail_id']")[0]);
		
		//var bshow = eval("bshow" + $("input[id='invite_detail_id']")[ui.index].value);
		var bshow = eval("bshow" + invite_detail_id);
		//console.log("bshow" + $("input[id='invite_detail_id']")[ui.index].value + "=" + bshow );
		//console.log($("input[id='invite_detail_id']")[0]);
		if (tabSelected != accordionActive && bshow == 1) {
			//alert("open accordion:" + tabSelected);
		//if (tabSelected != accordionActive ) {
			
			if($.browser.msie && parseInt($.browser.version, 10) <= 8) {
				// delay for open accordion because ie7 ie8 will hang
				setTimeout(function() {$('#iframepage').get(0).contentWindow.$("#accordion").accordion("activate",tabSelected);},1250);
			} else {
				$('#iframepage').get(0).contentWindow.$("#accordion").accordion("activate",tabSelected);
			}
			
			// '#accordion > div:has(#item117) > h3'
			//$('#iframepage').get(0).contentWindow.$("#accordion").accordion("activate","h3:has(#" + ui.tab.id +")" );
		}
	});


	 // initial when tab open 
	
	var bReloadWebFontOnce = 1;

			// reload web font when new created invite replace text from dialog 
	
			$('#tabs').bind('tabsshow', function(event, ui) {
				if (ui.panel.id == 'invite_detail_content2270339' )
				{
					//if (bReloadWebFontOnce == 1) {
						ck_editor2270339.execCommand( 'reloadWebFont');
						bReloadWebFontOnce = 0;
						document.getElementById("bshow2270339").focus(); //prevent chrome can not input chinese bug
						
					//}
					
				}
			});


	

	
			$('#tabs').bind('tabsshow', function(event, ui) {
				if (ui.panel.id == 'invite_detail_content2270343' && !map2270343 && $("#invite_detail_mapimgurl2270343").val() == '')
				{
					//alert("initialize2270343");
					initialize2270343();
					//resizeMap();
					
				}
			});

			// reload web font when new created invite replace text from dialog 
	
			$('#tabs').bind('tabsshow', function(event, ui) {
				if (ui.panel.id == 'invite_detail_content2270346' )
				{
					//if (bReloadWebFontOnce == 1) {
						ck_editor2270346.execCommand( 'reloadWebFont');
						bReloadWebFontOnce = 0;
						document.getElementById("bshow2270346").focus(); //prevent chrome can not input chinese bug
						
					//}
					
				}
			});


	

	
			$('#tabs').bind('tabsshow', function(event, ui) {
				if (ui.panel.id == 'invite_detail_content2270347' && !map2270347 && $("#invite_detail_mapimgurl2270347").val() == '')
				{
					//alert("initialize2270347");
					initialize2270347();
					//resizeMap();
					
				}
			});

			// reload web font when new created invite replace text from dialog 
	
			$('#tabs').bind('tabsshow', function(event, ui) {
				if (ui.panel.id == 'invite_detail_content2270349' )
				{
					//if (bReloadWebFontOnce == 1) {
						ck_editor2270349.execCommand( 'reloadWebFont');
						bReloadWebFontOnce = 0;
						document.getElementById("bshow2270349").focus(); //prevent chrome can not input chinese bug
						
					//}
					
				}
			});


	

			// reload web font when new created invite replace text from dialog 
	
			$('#tabs').bind('tabsshow', function(event, ui) {
				if (ui.panel.id == 'invite_detail_content2270350' )
				{
					//if (bReloadWebFontOnce == 1) {
						ck_editor2270350.execCommand( 'reloadWebFont');
						bReloadWebFontOnce = 0;
						document.getElementById("bshow2270350").focus(); //prevent chrome can not input chinese bug
						
					//}
					
				}
			});


	






});

/*
$('#iframepage').ready(function() { 

	$("#load_title").click(function() {
		alert("load_title");
		//$('#title_editor').elrte('val', $('#iframepage').contents().find("#title").html() );
		//$('#title_editor').elrte('updateSource');
	});

	$("#save_title").click(function() {
		alert("save_title");
		//$('#iframepage').contents().find("#title").html($('#title_editor').elrte('val')) ;
	});


	alert("iframepage ready: " + $('#iframepage').contents().find("#title").html() );
	//$('#title_editor').elrte('val',$('#iframepage').contents().find("#title").html() );
	return false;

});
*/






</script>






<script src="./unslider.js"></script>

<link href="main.css.asp?langid=2" rel="stylesheet" type="text/css">
<link href="css/popbox.css" type="text/css" rel="stylesheet" />

<script language='javascript'>
<!--


  
$(document).ready(function() { 
  

});  


<!-- fix jquery dialog bug of modal:true scrollbar  -->
(function( $, undefined ) {
  if ($.ui && $.ui.dialog) {
    $.ui.dialog.overlay.events = $.map('focus,keydown,keypress'.split(','), function(event) { return event + '.dialog-overlay'; }).join(' ');
  }
}(jQuery));


  String.prototype.trim = function() { return this.replace(/^\s\s*/, '').replace(/\s\s*$/, '');};
  
  String.prototype.ReplaceAll = function (AFindText,ARepText){
  
    raRegExp = new RegExp(AFindText,"g");
    return this.replace(raRegExp,ARepText)
  } 

  function countWords(){
    
    var limitcount, keycount;
        
    if (engstr( document.form_invite.remindmsg.value)){
        limitcount = 140;  
    }else{
        limitcount = 70;
    }    
    
    //keycount = document.form_invite.remindmsg.value.trim().ReplaceAll(' ', '').replace(/\r\n/g,'').length;
    
    keycount = document.form_invite.remindmsg.value.length;
        
    document.getElementById('limitcount').innerHTML = limitcount;
    
    
    
    if (keycount > limitcount){
        
        //alert('您入的热莩^字盗');  
        document.form_invite.remindmsg.value = document.form_invite.remindmsg.value.substring(0,limitcount);
        
        keycount = document.form_invite.remindmsg.value.length;
    }
    
    
    document.getElementById('keycount').innerHTML = keycount;
        
  }


function engstr(str){
   var subStr = "";
   for (i=0,n=str.length;i<n;i++){
      subStr = str.charCodeAt(i);
      if ((subStr > 256)){
         return false;
      }
   }
   return true;
}

  function isIns(){
    
    
    
  }


  var maxid = -10000;

  function addRow(parent_node){
  
   
    maxid++;
    
    //取得凫兑用新增列的^K
    var obj=document.getElementById( parent_node);
    //取得目前有多少谖
    //var sIndex=obj.getElementsByTagName('div').length+1;
    var sIndex = maxid;
    
    //依照原表胃袷,先建一div
    var div=document.createElement('div');
    div.id = 's'+sIndex; 
	div.style="vertical-align:middle;valign: middle;";

    
    //再建立文字谖,K指定相P傩
    //var input=document.createElement('input');
    //input.type='radio';
    //input.name='q'+parent_node.replace('q', '');
    //input.id='t'+sIndex;
    //把文字谖缓桶粹o加到div中

    //var span=document.createElement('div');
    //span.className='editable';



    //var txt=document.createElement('input');
    //txt.type='text';
    var txt=document.createElement('textarea');
    txt.rows = 1;
    txt.cols = 48;
    txt.name='o'+parent_node.replace('q', '');
    txt.value='新增选项';
    txt.className='showText';
    txt.onfocus = function(){this.className='showInput';};   
    txt.onblur = function(){this.className='showText';};   
    txt.onkeyup = function(){
  		$(this).css('height','auto');
  		$(this).height(this.scrollHeight );    
      setOptionTitle( sIndex, this.value);
      
    };   
    

    var del=document.createElement('img');
    del.src='./image/del.png';
    del.onclick = function(){ delRow( parent_node , 's' + sIndex );};   
    del.style.cursor='pointer';
    del.vspace='5';
    del.hspace='5';
    del.align='top';
    
    //span.appendChild(txt);

    div.appendChild(del);

    //div.appendChild(span);
    div.appendChild(txt);
	
    // div.appendChild(input);
    
  
     
    //把div加到^K中
    obj.appendChild(div);
    
    window.frames.iframepage.addRow(parent_node, maxid);
    
  }

  function delRow(q, t){

    d = document.getElementById(t);

    d.parentNode.removeChild(d);
    

    window.frames.iframepage.delRow(q, t);
    
  }

  function addOption(parent_node){
  
   
    maxid++;
    
    //取得凫兑用新增列的^K
    var obj=document.getElementById( parent_node);
    //取得目前有多少谖
    //var sIndex=obj.getElementsByTagName('div').length+1;
    var sIndex = maxid;
    
    //依照原表胃袷,先建一div
    var div=document.createElement('div');
    div.id = 's'+sIndex; 
    
    //var span=document.createElement('div');
    //span.className='editable';

    //再建立文字谖,K指定相P傩
    //var input=document.createElement('input');
    //input.type='radio';
    //input.name='q'+parent_node.replace('q', '');
    //input.id='t'+sIndex;
    //把文字谖缓桶粹o加到div中

    var txt=document.createElement('input');
    txt.type='text';
    txt.name='o'+parent_node.replace('q', '');
    txt.value='新增选项';
    txt.className='showText';
    txt.onfocus = function(){this.className='showInput';this.size=20;};   
    txt.onblur = function(){this.className='showText';this.size=this.value.length*2;};   
    txt.onkeyup = function(){
      window.frames.iframepage.updateSelect(parent_node, this.value);
  		$(this).css('height','auto');
  		$(this).height(this.scrollHeight );      
    };   
    txt.onclick = function(){window.frames.iframepage.updateSelect(parent_node, this.value);};   
    


    var del=document.createElement('img');
    del.src='./image/del.png';
    del.onclick = function(){ delOption( parent_node , 's' + sIndex );};   
    del.style.cursor='pointer';
    del.vspace='5';
    del.hspace='5';
    del.align='top';
    
	//span.appendChild(txt);
    div.appendChild(del);
    // div.appendChild(input);
    //div.appendChild(span);
    div.appendChild(txt);
    
  
     
    //把div加到^K中
    obj.appendChild(div);
    
    //alert(document.getElementById(parent_node).innerHTML);
    
    window.frames.iframepage.updateSelect(parent_node, '新增选项');
    
  }

  function delOption(q, t){

    d = document.getElementById(t);

    d.parentNode.removeChild(d);
    

    window.frames.iframepage.updateSelect(q);
    
  }


  function updateOption(t){
    
    
   var s = document.getElementById(t);
   var a = document.getElementById(t.replace('t', 'n'));
    
    var arr = a.value.split('\n')
    
    s.options.length = 0;
    
    s.options[0] = new Option(  'x', 0);
    for (var i=0; i<arr.length; i++){
      
        if (arr[i] != ''){
           s.options[i+1] = new Option( arr[i], arr[i]);
        }
    }
    
  }

  function updateSelect(t){
    
    
   var s = document.getElementById(t);
   var a = document.getElementById(t.replace('t', 'n'));
    
    var arr = a.value.split('\n')
    
    s.options.length = 0;
    
    s.options[0] = new Option('x', 0);
    for (var i=0; i<arr.length; i++){
      
        if (arr[i].Trim().length != 0){
           s.options[i+1] = new Option( arr[i], arr[i]);
        }
    }
    
  }


  function setQuestionTitle(qq, txt){
    
    
    
    window.frames.iframepage.setQuestionTitle(qq, txt.ReplaceAll('\n','<BR>'));          
    
  }

  function setOptionTitle(o, txt){
    
    
    window.frames.iframepage.setOptionTitle(o, txt.ReplaceAll('\n','<BR>'));          
    
  }
  
  function showQuestion(parent_node, check, pos){
    
    window.frames.iframepage.showQuestion(parent_node, check);      
    
    if (check){
      document.form_invite.switch_status[pos].value = '1';
    }else{
      document.form_invite.switch_status[pos].value = '0';
    }    
    
  }

  function showCheckin( bcheckin){
    
    
    
    window.frames.iframepage.showCheckin( bcheckin);      
    
    if (bcheckin == true){
        
        document.getElementById('_authcode').style.display = '';  
    
    }else{
       
        document.getElementById('_authcode').style.display = 'none';
    }
    
    
  }

  function doBold(id){
    
    var txt;
    
    txt = window.frames.iframepage.document.getElementById(id).childNodes[0];
    
    if ( txt.style.fontWeight == 'bold'){
      
         txt.style.fontWeight = 'normal';
         selOff( document.getElementById(id+'bold'));
                  
    }else{

         txt.style.fontWeight = 'bold';
         selOn( document.getElementById(id+'bold'));
         
    }
    
    setHiddenHtml(id);
    
    //alert( window.frames.iframepage.document.getElementById(id).innerHTML);
    
  }

  function doItalic(id){
    
    var txt;
    
    txt = window.frames.iframepage.document.getElementById(id).childNodes[0];
    
    if ( txt.style.fontStyle == 'italic'){
      
         txt.style.fontStyle = 'normal';
         selOff( document.getElementById(id+'italic'));
                  
    }else{
         
         txt.style.fontStyle = 'italic';
         selOn( document.getElementById(id+'italic'));

              
    }
    
    setHiddenHtml(id);
    
    //alert( window.frames.iframepage.document.getElementById(id).innerHTML);
    
  }
    
  function doUnderline(id){
    
    var txt;
    
    txt = window.frames.iframepage.document.getElementById(id).childNodes[0];
    
    if ( txt.style.textDecoration == 'underline'){
      
         txt.style.textDecoration = 'none';
         selOff( document.getElementById(id+'underline'));

                  
    }else{
         
         txt.style.textDecoration = 'underline';
         selOn( document.getElementById(id+'underline'));
               
    }
    
    setHiddenHtml(id);
    
    //alert( window.frames.iframepage.document.getElementById(id).innerHTML);
    
  }
  
  function doFontSize( id, fontsize){
     
    var txt;
    
    txt = window.frames.iframepage.document.getElementById(id).childNodes[0];
    
    txt.style.fontSize = fontsize + 'px';
    
    setHiddenHtml(id);              
    
  }

  function selOn(ctrl)
  {
  	ctrl.style.borderColor = '#000000';
  	ctrl.style.backgroundColor = '#B5BED6';
  	
  }
  
  function selOff(ctrl)
  {
  	ctrl.style.borderColor = '#ffffff';  
  	ctrl.style.backgroundColor = '#ffffff';
  }


  function setHiddenHtml(id){
  
     document.getElementById(id).value = window.frames.iframepage.document.getElementById(id).innerHTML;  
     
     //alert(document.getElementById(id).value);
  }
  
  function setMusic( name, url){
    
	$("#invite_mp3name").val(name); 
    window.frames.iframepage.setMusic(url);
    //alert($("#invite_mp3name").val());
    
  }
  
  
String.prototype.Trim = function() 

{ 

  return this.replace(/(^\s*)|(\s*$)/g, ""); 

} 
  

  function saveNew( act ){

	 for ( instance in CKEDITOR.instances )
         CKEDITOR.instances[instance].updateElement();
   
    var detail_id_value = '';
	var detail_id_array = $( "#tabs" ).tabs().find( ".ui-tabs-nav" ).sortable('toArray');
  	for (i=0; i<detail_id_array.length; i++){
		detail_id_value = detail_id_value + detail_id_array[i] + '|';
	}
    $("#invite_detailidarray").val(detail_id_value.substring(0,detail_id_value.length-1));
   
    $("#invite_act").val(act);
    document.form_invite.submit();
 

  } 



  function updateOld(act){
//alert(act);

    var detail_id_value = '';
	var detail_id_array = $( "#tabs" ).tabs().find( ".ui-tabs-nav" ).sortable('toArray');
  	for (i=0; i<detail_id_array.length; i++){
		detail_id_value = detail_id_value + detail_id_array[i] + '|';
	}
    $("#invite_detailidarray").val(detail_id_value.substring(0,detail_id_value.length-1));



	 for ( instance in CKEDITOR.instances )
         CKEDITOR.instances[instance].updateElement();
		 
     dataString = $("#form_invite").serialize();
 //alert(dataString);
        $.ajax({
        type: "POST",
        url: "mobile_invite_quicksave_act.asp",
        data: dataString,
        dataType: "json",
        success: function(data) {
 
            if(data.result == "OK"){
				if (act=='nextstep'){
					location.replace('mobile_invite_save.asp?invite_id=260347');
				} else {
					
						alert("已保存成功,你可随时在网页右上角 [帐户后台] > [我的请帖]中查看或修改本请帖\n\n提醒您:发布后修改请帖,必须重新发布后才会更新到手机(2次免费重新发布)");
						
				}
            } else {
				alert("储存失败! 请连系网上客服 " + data.result);
            }
 
        },
        error: function(data) {
				//alert("储存失败! 请连系网上客服 ");
				alert("储存失败! 请连系网上客服: \n\n "  + data.responseText);
        }
		
 
        });         
 

  } 



-->
</script>
<link href="css/switchButton.css" type="text/css" rel="stylesheet" />

<script type="text/javascript" src="js/switchButton.js"></script>


<style type='text/css'>
<!--
.switch-wrapper {
  display: inline-block;
  position: relative;
  top: 0px;
  margin-bottom:3px;
  
}

.tab_name_idle {
    border: 1px solid transparent;
	background-color:transparent;
}
.tab_name_hide { color:#AAA;
}

.global_setting {
	margin:3px 3px 3px 3px;
}
/*

.section-header {
	margin:4px 0px 4px 0px;
	padding:0px 0px 0px 0px;
	height:22px;
	background-color:#AAA;
	color:#FFF;
	font-size:16px;
	border-style:none;
	
}
*/

.section-content {
	padding:0px;
	margin: 0px;
}

.input-prompt {
  position: absolute;
  font-style: italic;
  color: #999;
  margin: 0.2em 0 0 0.5em;
}

 .showText:hover {
	
	
	border:2px dotted;
	
  }
  .showText{
    
    
    font-size:9pt; 
    border:0px solid #333;
    overflow: hidden;
    resize: none;    
  }

  .showInput{
    
    font-size:9pt; 
    border:1px solid #333;
    background:#FFFFEB;
	
  }
  
 .editable_image {
	border:0px solid;
	
  }

 .editable_image:hover {
	
  }    
 .editable {
  
  
	
	border:0px solid;
	
  }
 .editable:hover {
	
	
	/***border:2px dotted;***/
	
  }


.ui-tabs-nav {
    position:relative;
}

.ui-tabs .ui-tabs-nav-arrows {
    position:absolute;
    top:4px;
    right:1px;
    left:1px;
    margin:.1em;
    padding:0;
}

.ui-tabs .ui-tabs-nav-arrows .ui-tabs-arrow-next {
    float:right;
}

.ui-tabs .ui-tabs-nav-arrows li {
    list-style:none;
    position:relative;
    cursor:pointer;
    z-index:1000;
    line-height:1;
    margin:0;
    padding:0;
}

.ui-tabs .ui-tabs-nav-arrows li a {
    display: block;
    padding: .7em .1em;
}

.ui-tabs .ui-tabs-nav-arrows .ui-tabs-arrow-previous {
    float:left;
}

.ui-tabs .ui-tabs-scroll-container {
    position:relative;
    height: 3.5em;
    overflow:hidden;
}

.ui-tabs .ui-tabs-nav-scrollable {
    position:absolute;
    left:0;
    right:0;
}

.ui-tabs .ui-tabs-nav-scrollable ul {
    position:relative;
    width:10000px;
}


//-->
</style>



</head>
<body onload="init();"  bgcolor="#FFFFFF" leftmargin="0" rightmargin="0" topmargin="0" marginwidth="0" marginheight="0">



	<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
		
			hm.src = "//hm.baidu.com/hm.js?eecf4a3f1cd6b22a57444c2ba790e93d";
			  

      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
    </script>


<script type="text/javascript" src="js/common.js"></script>
<script language="JavaScript" type="text/JavaScript">
<!--
function changeAction(){ 
	var a = document.form_lang.setlangid.value; 
	//alert(a);
	document.form_lang.action = 'http://' + a + '.youvivid.com/mobile_invite_edit.asp?invite_id=260347'; 
	document.form_lang.submit();
} 


function selectTemplate(){
  
  if (document.form_objid.objid_now.value.length == 0){
  
      alert('x褚影妗');
    
  }else{
    
      location.assign('preview_new.asp?objid=' + document.form_objid.objid_now.value);
  }
  
  
}


-->
</script>
<script language='javascript'>
<!--
$(document).ready(function(){
  
    $('#_usrmenu').mouseleave(function(){
      closeMenu();
    });
});

  function openMenu(e){
        
        var mx, my;
        if (window.ActiveXObject || navigator.appVersion.indexOf('Trident') > 0){  
            mx = e.x; 
            my = e.y; 
        }else{
            mx = e.clientX; 
            my = e.clientY; 
        }    
        
        document.getElementById('_usrmenu').style.display = '';
        document.getElementById('_usrmenu').style.position = 'absolute';
        document.getElementById('_usrmenu').style.left = ( document.documentElement.scrollLeft + mx - 20) + 'px';
        document.getElementById('_usrmenu').style.top = ( document.documentElement.scrollTop + my  + 5 ) + 'px';
        
        
  }


  function closeMenu(){

               
        document.getElementById('_usrmenu').style.display = 'none';
        
        

  }
-->
</script>
<style type='text/css'>
<!--

/* CSSTerm.com Simple CSS menu */
 .menu_simple{
  
  
}
  
.menu_simple ul {
  margin: 0;
  padding: 0;
  width:155px;
  list-style-type: none;
}
   
.menu_simple ul li a {
  text-decoration: none;
  color: #000000;
  padding: 10.5px 11px;
  background-color: white;
  display:block;
}
   
.menu_simple ul li a:visited {
  color: #000000;
}
   
.menu_simple ul li a:hover, .menu_simple ul li .current {
  color: #000000;
  background-color: #EFEFEF;
}

//-->
</style>


<div class="menu_simple"  id="_usrmenu" style="width:155px; z-index:100; display: none;  background-color:#ffffff;"  >
  <ul>
    <li><a href="history_index.asp">发送及下载纪录</a></li>
    <li><a href="usr_update.asp">编辑个人资料</a></li>
    <li><a href="preview_index.asp">我的MV</a></li>
    <li><a href="invite_index.asp">我的请帖</a></li>
    <li><a href="file_index.asp">我的文件</a></li>
    <li><a href="favorite_index.asp">我的收藏</a></li>
    <li><a href="coupon_index.asp">我的优惠券</a></li>
    

    <li><a href="tag_index.asp">我的标签</a></li>
    
    <li><a href="point_index.asp">点数管理</a></li>

    <!--<li><a href="javascript: closeMenu();">P]x</a></li>-->
  </ul>
  
</div>

<table id="head_edit" width="100%" height="188" border="0" cellpadding="0" cellspacing="0" >
	<tr>
    <td width="944" height="188" align="center">
          		  
	 
	  <table width="944" height="188" border="0" cellpadding="0" cellspacing="0" >
	  	<tr>
	      <td width="268" height="188" valign="top">
        <div class="logo_edit" onclick="javascript: location.assign('http://cn.youvivid.net');"  style="width:206px;height:99px;cursor:pointer;">
	      </td>
	      <td width="46" height="188" valign="bottom">

             <table width="100%" height="188" border="0" cellpadding="0" cellspacing="0">
      		  	<tr>
      		      <td width="100%" height="188" >
      		        
      		      </td>
      		    </tr>		
	           </table>
        
        </td>
        <td width="630" height="188" > 

      		  
      		  <table width="100%" height="188" border="0" cellpadding="0" cellspacing="0">
      		  	<tr>
      		      <td width="100%" height="26" align="right">
      		         
      		         <span class="top_text">

      		           
      <!--<a href="usr_update.asp" class="link_top">sheng</a>-->
      <a href="history_index.asp" class="link_top">sheng的帐户后台
      </a>      
      <span class="link_top" style="cursor: pointer;" onclick="openMenu(event);"></span>

       		          
      		           
      		           &nbsp;|
                     
                     <a href="http://cn.youvivid.com/we_logout_act.asp" class="link_top">登出</a>&nbsp;|

      	
      		           
      		           
  		           
      		         </span>
      		         <!--<span class="youvivid_text">YOUVIVID</span>-->
      		         
      		      </td>
      		    </tr>
      		  	<tr>
      		      <td width="100%" height="162" align="center" valign="middle">

                  <div id="editmenu">
                      <ul id="edittabs">
<!--
                          <li><a href="mobile_invite_edit.asp?invite_id=260347"><img id="edit_step1" src="images_we/edit_step1_hover.png" border="0"></a></li>
                          <li><a href="mobile_invite_save.asp?invite_id=260347"><img id="edit_step2" src="images_we/edit_step2.png" border="0" onmouseover="this.src='images_we/edit_step2_hover.png'" onmouseout="this.src='images_we/edit_step2.png'"></a></li>
                          <li><a href=""><img id="edit_step3" src="images_we/edit_step3.png" border="0" onmouseover="this.src='images_we/edit_step3_hover.png'" onmouseout="this.src='images_we/edit_step3.png'"></a></li>
-->
                          


                          <li><img id="edit_step1" src="images_we/edit_step1_hover.png" border="0"></li>
                          <li><img id="edit_step2" src="images_we/edit_step2.png" border="0" onmouseover="this.src='images_we/edit_step2_hover.png'" onmouseout="this.src='images_we/edit_step2.png'" style="cursor: pointer;" onclick="javascript: updateOld('nextstep');"></li>
                          <li><img id="edit_step3" src="images_we/edit_step3.png" border="0"></li>



                                
                          
                      </ul>
                  </div>     
                  <div id="stepmenu">
                      <ul id="steptabs">
                          <li>制作</li>
                          <li>储存</li>
                          <li>发布</li>
                      </ul>
                  </div>   
      		      </td>
      		    </tr>
        		            		    
      		  </table>           
        
        </td>
	    </tr>

	  </table> 
      

    </td>
  </tr>
</table> 
		  
              
<table width="100%" border="0" cellpadding="0" cellspacing="0">
	<tr>
		<td width="100%" align="center" valign="top">

      <table width="964" border="0" cellpadding="0" cellspacing="0">
        <tr>
          <td width="10" class="left_side"></td>

          <td width="944" valign="top">
              
                  
              <table width="944" border="0" cellpadding="0" cellspacing="0">
                <tr>
                  <td width="944" height="500" align="center" valign="top">
                    
<BR><BR>



<form action="mobile_invite_edit_act.asp" method="post" name="form_invite" id="form_invite">
  
  <input type="hidden" name="we" value="0">

<table width="945" border="0" cellspacing="0" cellpadding="0">

<input type="hidden" id="invite_detailidarray" name="invite_detailidarray" value="">
<input type="hidden" id="invite_act" name="invite_act" value="">
<input type="hidden" name="invite_id" value="260347">
<input type="hidden" name="invite_bgcolor" value="#ffffff">
<input type="hidden" name="invite_color" value="#ff87c3">
<input type="hidden" name="invite_description" id="invite_description" value="">
  <tr>
    <td>
        <table width="100%" border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td width="41%"  valign="top">
                
<script type="text/javascript"> 
  
	$(document).ready(function() {
		//$('#scroller').scrollToFixed({ marginTop: -60, limit: $("#scroller-limit").offset().top-700 });
		$('#scroller').scrollToFixed({ marginTop: -60, 
			limit: function() {
				return $("#scroller-limit").offset().top-$('#scroller').outerHeight();
			}
		});
		
		
	});
  
</script> 
                
                <div id="scroller-anchor"></div> 
                <div id="scroller" >
					<div  align="left" style=" padding-left:0px; padding-top:0px; background-image: url('images/mobile_invite/iphone5_353x637.png'); width: 353px; height: 637px; background-repeat: no-repeat; position:relative" >                                              

                    <!--[if lte IE 9]>
                		<div style="position:absolute; top:52px; width:100%; text-align:center; color:#FBE486; z-index:999">
                   		<img src="images/icon-alert.png" width="12" height="12" align="absmiddle" />浏览器版本太旧不支持!请更换谷歌火狐或360浏览器
                    	</div>
                		<div style="position:absolute; bottom:40px; width:100%; text-align:center; color:#FBE486; z-index:999">
                   		<img src="images/icon-alert.png" width="12" height="12" align="absmiddle" />浏览器版本太旧不支持!请更换谷歌火狐或360浏览器
                    	</div>
                    <![endif]-->

                    <iframe  id="iframepage" name="iframepage" allowtransparency="true" scrolling="auto" style=" margin-top:77px; margin-left:8px; height: 495px; width: 337px;  position: absolute" src="mobile_invite.asp?inviteid=260347&bAutoVideo=0&adm=0&bInIframe=1"  frameborder="0" marginwidth="0"  ></iframe>

                    </div>              
                            
<br>
					
                            <div align="center" >
                            微信扫一扫二维码打开请帖<br>点右上角的箭头可转发朋友 <br>

                            
                            <img id="qrcode" width="200" height="200" src="qrcode_gen.php?url=http%3A%2F%2Fcn%2Eyouvivid%2Enet%2F%5FvW93TV&fn=W93TV.png" border="1">
                            <!--<img id="qrcode" width="200" height="200" src="qrcode_gen.php?url=http%3A%2F%2Fcn%2Eyouvivid%2Ecom%2Fmobile%5Finvite%2Easp%3FbAutoVideo%3D1%26bForceMobile%3D1%26sn%3DW93TV&fn=W93TV.png" border="1">-->
                            
                             
                            <!--<img id="qrcode" width="200" height="200" src="qrcode_gen.php?url=http%3A%2F%2Fuvivid%2Ecom%2F%5FvW93TV&fn=W93TV.png" border="0"> -->
                            
                            <!--<img id="qrcode" width="200" height="200" src="http://chart.apis.google.com/chart?cht=qr&chl=http%3A%2F%2Fuvivid%2Ecom%2F%5FvW93TV&chs=500x500" border="0">--> <br>

                                <div align="center" style=" width:200px; padding:10px 0 10px 0">
                                    <span ><font color='red'>免费版限制总共5个手机能打开请帖, 不支持短信提醒, 且手机中只能播放范例视频。付费发布后不限制人数, 所有功能都能正常使用</font></span>
                                </div>

                            
                            
                            </div>
  
					
				</div>              

            
            </td>
            <td width="59%" align="left" valign="top">
            	<div id="accordion_header">
                	<h3 id="header" ><a href="#">&nbsp;&nbsp;主页设置</a></h3>
                    <div class="section-content">
                        <div style="margin-left:20px" >
    
            
                <table width="100%" border="0" cellpadding="2" cellspacing="1">
                  <tr>
                    <td align="right" valign="top" width="120"><b>选择模板:</b></td>
                    <td colspan="2" valign="top">
                    
                    <input type="hidden" name="invite_bmapbaidu" id="invite_bmapbaidu" value="1">
                    <input type="hidden" name="invite_stylename" id="invite_stylename" value="Tiffany恋曲">
                    <input type="hidden" name="invite_styleid" id="invite_styleid" value="77">
                    <input type="hidden" name="invite_fontname" id="invite_fontname" value="粗钢笔">
Tiffany恋曲                    

                    
                    </td>
                  </tr>
                  <tr>
                    <td align="right" valign="top" width="120">字　体: </td>
                    <td colspan="2" valign="top">
                    

                    
                    <select id="invite_fontface" >
                    
                      <option value="Microsoft JhengHei,Microsoft YaHei,arial||0|0" >手机预设字体</option>
                    
                      <option value="粗钢笔2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E7%B2%97%E9%92%A2%E7%AC%942&font=%E7%B2%97%E9%92%A2%E7%AC%94|1|1" selected="selected">粗钢笔</option>
                    
                      <option value="隶书2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E9%9A%B6%E4%B9%A62&font=%E9%9A%B6%E4%B9%A6|1|1" >隶书</option>
                    
                      <option value="粗圆2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E7%B2%97%E5%9C%862&font=%E7%B2%97%E5%9C%86|1|1" >粗圆</option>
                    
                      <option value="黑体2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E9%BB%91%E4%BD%932&font=%E9%BB%91%E4%BD%93|1|1" >黑体</option>
                    
                      <option value="书宋二2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E4%B9%A6%E5%AE%8B%E4%BA%8C2&font=%E4%B9%A6%E5%AE%8B%E4%BA%8C|1|1" >书宋二</option>
                    
                      <option value="中行书2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E4%B8%AD%E8%A1%8C%E4%B9%A62&font=%E4%B8%AD%E8%A1%8C%E4%B9%A6|1|1" >中行书</option>
                    
                      <option value="古印体2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E5%8F%A4%E5%8D%B0%E4%BD%932&font=%E5%8F%A4%E5%8D%B0%E4%BD%93|1|1" >古印体</option>
                    
                      <option value="粗广告体2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%932&font=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%93|1|1" >粗广告体</option>
                    
                      <option value="粗行楷体2,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%932&font=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%93|1|1" >粗行楷体</option>
                    
                      <option value="甜妞体2,微软雅黑,宋体 Microsoft JhengHei,Microsoft YaHei,arial|http://42.121.32.43:443/Fonts/getcss?family=%E7%94%9C%E5%A6%9E%E4%BD%932&font=%E7%94%9C%E5%A6%9E%E4%BD%93|1|1" >甜妞体</option>

                    </select>
                    
                    </td>
                  </tr>
                  <tr>
                    <td align="right" valign="top">音　乐:</td>
                    <td colspan="2" valign="top">

					
                      <input type="hidden" name="invite_mp3name" id="invite_mp3name" value="花c">
              		  <select id="invite_mp3url" name="invite_mp3url" onChange="setMusic(this.options[this.selectedIndex].text, this.options[this.selectedIndex].value);">
                      
              		    <option value="audios_system/m1206064fcf0242da28e.mp3">花c</option>
                      
              		    <option value="">无音乐</option>
					
              		    <option value="audios_system/m1206064fcf0242da28e.mp3">花c</option>
					
              		    <option value="audios_system/m1206064fcf12f8bd883.mp3">邂逅</option>
					
              		    <option value="audios_system/m1206064fcf6636202b0.mp3">The Four Seasons(Winter)</option>
					
              		    <option value="audios_system/m120724500e049761c33.mp3">Canon in D major for Strings</option>
					
              		    <option value="audios_system/m1206214fe2cf707354e.mp3">Canon in D Serenade</option>
					
              		    <option value="audios_system/m120920505afbd8c1c86.mp3">Fit To Be Tied-Band</option>
					
              		    <option value="audios_system/m120920505afc2d6204c.mp3">This Ring</option>
					
              		    <option value="audios_system/m120920505afb89ab43f.mp3">Dance with Me</option>
					
              		    <option value="audios_system/m1309025223f99fc9242.mp3">She's A Rocket</option>
					
              		    <option value="audios_system/m120920505ae1cc97121.mp3">Wedding March</option>
					
              		    <option value="audios_system/m14111054608028a3187.mp3">Make It Last</option>
					
              		    <option value="audios_system/m141110546081e34f81e.mp3">Jesu Joy</option>
					
              		    <option value="audios_system/m1411105460837f667ba.mp3">The Swan</option>
					
              		    <option value="audios_system/m1411105460844d189fc.mp3">Ode To Joy</option>
					
              		    <option value="audios_system/m1411105460850690e88.mp3">Spring Vivaldi</option>
					
              		    <option value="audios_system/m14111054608d7fa2c7c.mp3">Russian Wedding</option>
					
              		    <option value="audios_system/m141110546088ef47edf.mp3">50's stories</option>
					
              		    <option value="audios_system/m1411105460968644069.mp3">American Rodeo</option>
					
              		    <option value="audios_system/t13123152c2315e4d073.mp3">舞P (30S).mp3</option>
					
              		    <option value="audios_system/t13123152c2314c8cc50.mp3">新年神到 (30S).mp3</option>
					
              		    <option value="audios_system/t13123152c2313c3ba3f.mp3">恭喜l舞曲 (30S).mp3</option>
					
              		    <option value="audios_system/t13120952a5640b372f1.mp3">}Q也狂</option>
					
              		    <option value="audios_system/t13120952a564198ed50.mp3">}Q的12天</option>
					
              		    <option value="audios_system/t13120952a5642be2a42.mp3">We wish you a X'mas</option>
					
              		    <option value="audios_system/t13120952a563f2614cf.mp3">}Q Jingle Bells</option>
					
              		    <option value="audios_system/m1512095667f74baebe8.mp3">康康舞 (30S).mp3</option>
					
              		    <option value="audios_system/m1512095667f80671b59.mp3">gc春  (30S).mp3</option>
					
              		    <option value="audios_system/m1512095667f7cdb28f2.mp3">踢踏舞 (30S).mp3</option>
					
              		    <option value="audios_system/m1512105668e2a9baebc.mp3">茉莉花海-音版 (30S).mp3</option>
					
              		    <option value="audios_system/m1512105668e2e672711.mp3">光去旅行 (30S).mp3</option>
					
              		    <option value="audios_system/m1512105668e62a5b8da.mp3">s耀起w (30S).mp3</option>
					
              		    <option value="audios_system/m1512105668e783b34a9.mp3">}火之典 (30S).mp3</option>
					                        
              		  </select>                     
					 
                    	<br>  <span style=" color:#BBB">(为尊重音乐版权,请帖不支持上传或设置无合法授权的音乐)</span>
                     
                        
                        
                    </td>
                  </tr>

                  <tr>
                    <td align="right" valign="top">主标题:</td>
                    <td colspan="2" valign="top">
                    
                    <input type="hidden"  id="maintitlehtml" name="maintitlehtml" value="&lt;span style=&quot;font-size: 22px; font-style: normal; font-weight: normal; text-decoration: none;&quot;&gt;&#23609;&#30427;&amp;amp;&#26361;&#38160;&#24609;&#23130;&#23476;&#36992;&#32422;&lt;/span&gt;"/>
					<textarea name="invite_maintitle" id="invite_maintitle" cols="30" rows="2">&#23609;&#30427;&amp;&#26361;&#38160;&#24609;&#23130;&#23476;&#36992;&#32422;</textarea>                    
                    <img id="maintitlehtmlbold" src="./image/bold.gif" border="0" style="cursor:pointer;" onclick="doBold('maintitlehtml');" align="top">
                    <img id="maintitlehtmlitalic" src="./image/italic.gif" border="0" style="cursor:pointer;" onclick="doItalic('maintitlehtml');" align="top"> 
                    <img id="maintitlehtmlunderline" src="./image/underline.gif" border="0" style="cursor:pointer;" onclick="doUnderline('maintitlehtml');" align="top">
              		  <select id="selSize1" name="selSize1" onChange="doFontSize('maintitlehtml', this.options[this.selectedIndex].value)" style="vertical-align:top">
              		    <option value="8">8</option>
              		    <option value="9">9</option>
              		    <option value="10">10</option>
              		    <option value="11">11</option>
              		    <option value="12">12</option>
              		    <option value="14">14</option>
              		    <option value="16">16</option>
              		    <option value="18">18</option>
              		    <option value="20">20</option>
              		    <option value="22">22</option>
              		    <option value="24">24</option>
              		    <option value="26">26</option>
              		    <option value="28">28</option>
              		    <option value="30">30</option>
              		    <option value="32">32</option>
              		    <option value="36">36</option>
              		    <option value="40">40</option>
              		    <option value="44">44</option>
              		    <option value="48">48</option>
              		    <option value="52">52</option>
              		  </select>                     
                    
                    </td>
                  </tr>
                  <tr>
                    <td width="55" align="right" valign="top">主　图: </td>
                    <td width="100" valign="top">
	                    <img src="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364fc98230c.jpg" width="100" align="top" id="invite_webimg"/>
                        <input type="hidden" id="invite_webimgurl" name="invite_webimgurl" value="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364fc98230c.jpg"  size="40" /> 
                        <input type="hidden" id="invite_mainimgurl" name="invite_mainimgurl" value="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364fc98230c.jpg"  size="40" /> 
                        <input type="hidden" id="photo_path" name="photo_path" value=""/> 
                        <input type="hidden" name="x1" id="x1" value="">
                        <input type="hidden" name="y1" id="y1" value="">
                        <input type="hidden" name="x2" id="x2" value="">
                        <input type="hidden" name="y2" id="y2" value="">
                        <input type="hidden" name="ww" id="ww" value="">
                        <input type="hidden" name="hh" id="hh" value=""> 
                        
                        
                        
                        <input type="hidden" name="invite_mediatype" id="invite_mediatype" value="0">
                    </td>
                    <td width="367" valign="top">
                    	<input id="select_image" name="select_image" type="button" value="选择图片" /><br>
                        <input id="cut_image" name="cut_image" type="button" value="裁剪图片" />


<script language='javascript'>
<!--
var jcrop_api; 



function showCoords(c) {  
  //@取得的 c 就是座讼嚓PY料，包含:  
  //c.x  --> 左上角的 x  
  //c.y  --> 左上角的 y  
  //c.x2 --> 右下角的 x  
  //c.y2 --> 右下角的 y  
  //c.w  --> x取的度  
  //c.h  --> x取的高度  
  

  document.form_invite.x1.value = c.x;
  document.form_invite.y1.value = c.y;
  document.form_invite.x2.value = c.x2;
  document.form_invite.y2.value = c.y2;


}



function initJcrop(){
	
	

    $('#invite_mainimg').Jcrop({  
		// trueSize: [200,200],
		boxWidth: 500, 
		boxHeight: 400,
		aspectRatio: 0,
		//allowResize: false,
		allowSelect: false,
      bgFade:     true,
      bgOpacity: .5,
      
      //setSelect: [ document.form_invite.x1.value, document.form_invite.y1.value, document.form_invite.x2.value, document.form_invite.y2.value],      
      onChange: showCoords,  
      onSelect: showCoords
      
      
    }, function(){
       
        jcrop_api = this; 
		bounds = jcrop_api.getBounds();
        boundx = bounds[0];
        boundy = bounds[1];
		
		if (document.form_invite.x1.value == '' || document.form_invite.x2.value == '') {
			document.form_invite.x1.value = 0;
			document.form_invite.y1.value = 0;
			document.form_invite.x2.value = boundx;
			document.form_invite.y2.value = boundy;
			document.form_invite.ww.value = boundx;
			document.form_invite.hh.value = boundy;
	
		}  
		
		
		//jcrop_api.animateTo( getCropRect(image_dim));       
		//jcrop_api.setSelect( getCropRect(image_dim));       
			 
		//jcrop_api.animateTo( [0, 0, 200, Math.round(200*sh/sw)]);       
		//jcrop_api.setSelect( [0, 0, 200, Math.round(200*sh/sw)]);  
		//jcrop_api.animateTo( [document.form_invite.x1.value, document.form_invite.y1.value, document.form_invite.x2.value, document.form_invite.y2.value]);       
		jcrop_api.setSelect( [document.form_invite.x1.value, document.form_invite.y1.value, document.form_invite.x2.value, document.form_invite.y2.value]);      		



    		
    }); 
  
}




$(document).ready(function(){


	$( "#imageCut" ).dialog({
		position: {my: "center", at: "top", of: document},
		width: 600, 
		height: 500, 
		modal: true, 
		autoOpen: false,
		closeOnEscape: false,
		//open: function(event, ui) {  $(".ui-dialog-titlebar-close", ui.dialog).hide(); },
		close: function(event, ui) { 
			jcrop_api.destroy();
			$('#invite_mainimg').removeAttr('style');
			},
		resizable: false,
		buttons: 
		[{
			text: '确定',
			"class": 'closeButtonClass',
			click: function() {
				//?folder=invite_cimage&id="&videoId&"&from=" &  server.URLEncode(coverurl) & "&cropdata=" & cdata				
				//resize image, 
				// param: document.form_invite.invite_mainimgurl.value
				// param: document.form_invite.x1.value
				// param: document.form_invite.y1.value
				// param: document.form_invite.x2.value
				// param: document.form_invite.y2.value
				// param: document.form_invite.ww.value
				// param: document.form_invite.hh.value



				
				cdata = "" + document.form_invite.x1.value + "," + document.form_invite.y1.value + "," + document.form_invite.x2.value + "," + document.form_invite.y2.value + "," + document.form_invite.ww.value + "," + document.form_invite.hh.value; 
				
				
				fromUrl = document.form_invite.invite_mainimgurl.value;
				fileNamePart = fromUrl.substring(fromUrl.lastIndexOf("/") + 1, fromUrl.lastIndexOf(".")) + "_" + new Date().getTime();
				fileExtPart = fromUrl.substring(fromUrl.lastIndexOf(".") + 1, fromUrl.lastIndexOf(".")+4);
				
				
				if (fromUrl.toLowerCase().indexOf("youvividcnupload1.oss.aliyuncs.com") > 0) {
					cutImgUrl = "http://42.121.32.43/ec2/resize_oss_image_invite_web.php";
					xwebimgurl = "http://youvividcnupload1.oss.aliyuncs.com/invite_wimage/" + fileNamePart + "." + fileExtPart;
				} else {
					cutImgUrl = "/ec2/resize_s3_image_invite_web.php";
					xwebimgurl = "http://youvivid-jp-s3-uploads7.youvivid.com/invite_wimage/" + fileNamePart + "." + fileExtPart;
				}
				
				//alert("fromUrl=" + fromUrl + ", cutImgUrl=" + cutImgUrl+ ", cdata=" + cdata+ ", fileNamePart=" + fileNamePart+ ", fileExtPart=" + fileExtPart+ ", xwebimgurl=" + xwebimgurl);

				var contentType ="application/x-www-form-urlencoded; charset=utf-8";
			 
				if(window.XDomainRequest)
					contentType = "text/plain";

				
				$.ajax({
				type: "POST",
				url: cutImgUrl,
			    crossDomain: true,
				//data: { folder: "invite_wimage",id: fileNamePart,from: fromUrl,cropdata: cdata},
				data:"folder=invite_wimage&id="+fileNamePart+"&from="+fromUrl+"&cropdata=" + cdata,
				contentType: contentType,
				dataType: "json",
				success: function(data) {
					if(data.result == "1"){
						$("#iframepage",document.body).contents().find('#invite_webimg').attr('src', xwebimgurl);
						//$("#iframepage",parent.document.body).contents().find('#img_videobutton').hide();
						$("#invite_webimg",document.body).attr('src', xwebimgurl);
						$("#invite_webimgurl",document.body).val(xwebimgurl);
						
						
					} else {
						alert("裁剪图片失败! 请稍后重试或截图后连系网上客服:" + data);
					}
		 
				},
				error: function(data) {
						alert("裁剪图片失败! 建议更换浏览器在试试或截图后连系网上客服:" + data);
				}
				
		 
				});         
			$( "#imageCut" ).dialog( "close" );						
				
			}
		},
		{
			text: '放弃',


			"class": 'closeButtonClass',
			click: function() {
					$( "#imageCut" ).dialog( "close" );						
			}
			
		}]
			
	}); //basicInfoDialog end

	$("#cut_image").bind('click', function (e) {
		$( "#imageCut" ).dialog( "open" );
		initJcrop();

	});




});  
-->
</script>



        <div id="imageCut" title="请以鼠标拖拉裁剪范围后点击下方确定按钮" align="center" style="display:none; font-size:16px; overflow: hidden; width:230px; vertical-align:middle" >
          <img src="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364fc98230c.jpg" align="middle" id="invite_mainimg"/>
        </div>
                        
                        
                        
                        
                    </td>
                  </tr>


                        <input type="hidden" name="invite_previewid" id="invite_previewid" value="0">

                  



                  <tr>
                    <td align="right" valign="top">副标题:</td>
                    <td colspan="2" valign="top">

                  <input type="hidden" id="subtitlehtml" name="subtitlehtml" value="&lt;span style=&quot;font-size: 18px; font-weight: normal;&quot;&gt;2015&#24180;05&#26376;02&#26085;&lt;/span&gt;" />
				  <textarea name="invite_subtitle" id="invite_subtitle" cols="30" rows="2">2015&#24180;05&#26376;02&#26085;</textarea>                  
                  
                    <img id="subtitlehtmlbold" src="./image/bold.gif" border="0" style="cursor:pointer;" onclick="doBold('subtitlehtml');" align="top">
                    <img id="subtitlehtmlitalic" src="./image/italic.gif" border="0" style="cursor:pointer;" onclick="doItalic('subtitlehtml');" align="top">
                    <img id="subtitlehtmlunderline" src="./image/underline.gif" border="0" style="cursor:pointer;" onclick="doUnderline('subtitlehtml');" align="top">
              		  <select id="selSize2" name="selSize2" onChange="doFontSize('subtitlehtml', this.options[this.selectedIndex].value)"style="vertical-align:top">
              		    <option value="8">8</option>
              		    <option value="9">9</option>
              		    <option value="10">10</option>
              		    <option value="11">11</option>
              		    <option value="12">12</option>
              		    <option value="14">14</option>
              		    <option value="16">16</option>
              		    <option value="18">18</option>
              		    <option value="20">20</option>
              		    <option value="22">22</option>
              		    <option value="24">24</option>
              		    <option value="26">26</option>
              		    <option value="28">28</option>
              		    <option value="30">30</option>
              		    <option value="32">32</option>
              		    <option value="36">36</option>
              		    <option value="40">40</option>
              		    <option value="44">44</option>
              		    <option value="48">48</option>
              		    <option value="52">52</option>
              		  </select>                                       

                    </td>
                  </tr>
                </table>
        <script>
		
var $dialog_photo, $dialog_video;		
var temprnd=0;		
function reloadSelectVideoIframe(){
	temprnd = temprnd +1;
	var tail='?r='+ temprnd;
	var oldurl=document.getElementById('selectvideoframepage').src;
	var newurl = oldurl.split('?')[0] + tail;
	document.getElementById('selectvideoframepage').src=newurl;
	//alert('reload url:' + newurl);
}
		
$(document).ready(function() { 
		
		$("#invite_maintitle").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#maintitlehtml").find("span:eq(0)").html($(this).val().ReplaceAll('\r\n','\n').ReplaceAll('\n','<br>').replace(/\s\s/g, " &nbsp;")); 
			setHiddenHtml('maintitlehtml');
		});


		//test webfont
		//$("#invite_maintitle").bind('keyup',function (){
		//	//"http://fonts.googleapis.com/css?family=Inconsolata&text=ABC"
		//	var webfonturl = $('#iframepage').contents().find(".fontcss").attr("href");
		//	var newwebfonturl = webfonturl.split('&')[0] + '&text=' + escape($(this).val());
		//	$('#iframepage').contents().find(".fontcss").attr("href",newwebfonturl);
		//});

		$("#invite_maintitle").bind('focus',function (){
			 $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
			//$('#iframepage').animate({ scrollTop: 30 }, "slow");
			//$('#iframepage').contents().animate({ scrollTop: $(document).height() }, "slow");
		});
		$("#invite_subtitle").bind('change keydown keyup paste input propertychange',function (){
			//$('#iframepage').contents().find("#subtitlehtml").find("span:eq(0)").html($(this).val().replace(/\s\s/g, " &nbsp;")); 
            $('#iframepage').contents().find("#subtitlehtml").find("span:eq(0)").html($(this).val().ReplaceAll('\r\n','\n').ReplaceAll('\n','<br>').replace(/\s\s/g, " &nbsp;")); 
			setHiddenHtml('subtitlehtml');
			
		 // alert('Handler for .change() called.');
		});
		$("#invite_subtitle").bind('focus',function (){
			 $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
			//$('#iframepage').animate({ scrollTop: 30 }, "slow");
			//$('#iframepage').contents().animate({ scrollTop: $(document).height() }, "slow");
		});
		
		$("#select_image").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			$('#iframepage').contents().find('html, body').animate({scrollTop: 0});
			//var page = 'mobile_invite_select_photo_header_plu_leo.asp?invite_detail_id=2270340';
			var page = 'mobile_invite_select_photo_header_plu_s3oss.asp?invite_detail_id=2270340';
			var pagetitle = '请选择或上传一张相片作为封面';
			$dialog_photo = $('<div></div>')
			.html('<iframe frameborder="0" border="0" cellspacing="0" style="border: none; " src="' + page + '" width="100%" height="100%"></iframe>')
			.dialog({
				position: {my: "center", at: "top", of: document},
				autoOpen: false,
				modal: false,
				//position: "right",
				height: 610,
				width: 580,
				title: pagetitle,
				buttons: [{
					text: '关闭',
					"class": 'closeButtonClass',
					click: function() {
                         $( this ).dialog( "close" );
					}
				}]
			});
			$dialog_photo.dialog('open');




			//$('#title_editor').elrte('val', $('#iframepage').contents().find("#title").html() );
			//$('#title_editor').elrte('updateSource');
		});




		$("#select_video").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			$('#iframepage').contents().find('html, body').animate({scrollTop: 0});
			var page = 'mobile_invite_select_video_header.asp';
			var pagetitle = '请选择MV视频';
			$dialog_video = $('<div></div>')
			.html('<input value="制作新MV" type="button" onClick="window.open(\'/create_mv.asp?asid=123\');" />   <input value="重新载入" type="button" onClick="reloadSelectVideoIframe();" /> <span style="color: #ff9900;">为尊重著作财产权,请帖中播放网上制作的MV时,不支持自己上传的MP3音乐</span><br/> <br><br><iframe id="selectvideoframepage" frameborder="0" border="0" cellspacing="0"  style="border: none; " src="' + page + '" width="510" height="500"></iframe>')
			.dialog({
				position: {my: "center", at: "top", of: document},
				autoOpen: false,
				modal: false,
				//position: "right",
				height: 610,
				width: 580,
				title: pagetitle,
				buttons: [{
					text: '关闭',
					"class": 'closeButtonClass',
					click: function() {
                         $( this ).dialog( "close" );
					}
				}]
			});
			$dialog_video.dialog('open');




			//$('#title_editor').elrte('val', $('#iframepage').contents().find("#title").html() );
			//$('#title_editor').elrte('updateSource');
		});

		$("#remove_video").bind('click', function (e) {
			$('#iframepage').get(0).contentWindow.invite_mediatype=0;
			$("#iframepage").contents().find('#img_videobutton').hide();
			$("#iframepage").contents().find('#img_videobutton_placeholder').hide();
			//$("#iframepage").contents().find('#invite_webimg,#img_decoration1,#img_decoration2,#img_decoration3').css('cursor', 'default');


			$('#invite_previewid').val(0);
			$("#invite_mediatype").val(0);
			//$('#video_selected').hide();
			$('#invite_previewname').html('<font color="#FF66FF">尚未选取MV视频</font>');
			$("#remove_video").attr("disabled", true);
			$('#video_selected').attr('src', 'images/select_your_mv.jpg');
			alert("移除MV视频完成");

			
		});

		$("#video_selected").bind('click', function (e) {
			if ($('#invite_previewid').val() == 0) {
				$("#select_video").click();
			} else {
				alert("请点手机封面图左下角的图标以播放MV视频");
			}

			
		});
		
		
		
		
		//$('.tab-ear').frosty({position:'bottom',classes: 'tip success'});	
		
		
		$('.tab-ear,.tab-ear-delux').frosty({position:'bottom'});	
		

});
		
		</script>


<!--
                <a id="load_title" href="#" >LOAD</a> <br>
                <a id="save_title" href="#" >SAVE</a>





-->
    
                      </div>
                    </div>
                   </div>
            	</div>
            	<div id="accordion_detail">
				   <h3><a href="#">&nbsp;&nbsp;子页编辑 <span style=" color:#BBB">(点击子页签打开后开始编辑,不需要的可打勾隐藏)</span></a></h3>
                   <div class="section-content">

<div class="ui-widget" >

<div id="tabs">
	<ul>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270339"><a id="invite_detail_title2270339" href="#invite_detail_content2270339" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270339" name="invite_detail_name2270339" value="&#29233; &#30340; &#36992; &#32422;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270339").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270339").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270340"><a id="invite_detail_title2270340" href="#invite_detail_content2270340" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270340" name="invite_detail_name2270340" value="&#23130; &#32433; &#30456; &#20876;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270340").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270340").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear-delux" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270341"><a id="invite_detail_title2270341" href="#invite_detail_content2270341" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270341" name="invite_detail_name2270341" value="&#65325; &#65334; &#35270; &#39057;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270341").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270341").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270342"><a id="invite_detail_title2270342" href="#invite_detail_content2270342" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270342" name="invite_detail_name2270342" value="&#23130; &#23476; &#22238; &#20989;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270342").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270342").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270343"><a id="invite_detail_title2270343" href="#invite_detail_content2270343" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270343" name="invite_detail_name2270343" value="&#23130; &#23476; &#22320; &#22270;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270343").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270343").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear-delux" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270344"><a id="invite_detail_title2270344" href="#invite_detail_content2270344" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270344" name="invite_detail_name2270344" value="&#21916; &#23476; &#25552; &#37266;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270344").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270344").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270345"><a id="invite_detail_title2270345" href="#invite_detail_content2270345" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270345" name="invite_detail_name2270345" value="&#21916; &#35759; &#20998; &#20139;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270345").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270345").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270346"><a id="invite_detail_title2270346" href="#invite_detail_content2270346" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270346" name="invite_detail_name2270346" value="&#30007; &#22899; &#26041; &#23476; &#23458;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270346").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270346").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270347"><a id="invite_detail_title2270347" href="#invite_detail_content2270347" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270347" name="invite_detail_name2270347" value="&#22791; &#29992; &#22320; &#22270;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270347").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270347").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270348"><a id="invite_detail_title2270348" href="#invite_detail_content2270348" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270348" name="invite_detail_name2270348" value="&#22791; &#29992; &#30456; &#20876;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270348").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270348").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270349"><a id="invite_detail_title2270349" href="#invite_detail_content2270349" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270349" name="invite_detail_name2270349" value="&#29233; &#24773; &#25925; &#20107;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270349").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270349").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>


		<li class="tab-ear" title="点击文字可修改子页标题。拖拉边框可调整子页顺序。" id="2270350"><a id="invite_detail_title2270350" href="#invite_detail_content2270350" style="cursor:w-resize;">
        
                <input class="tab_name" type="text" id="invite_detail_name2270350" name="invite_detail_name2270350" value="&#20851; &#20110; &#25105; &#20204;" size="7" >
        </a></li>
        <script>
		$("#invite_detail_name2270350").bind('change keydown keyup paste input propertychange',function () {
			$('#iframepage').contents().find("#invite_detail_name2270350").html($('<div/>').html($(this).val()).html()); 
			
		  //alert($('<div/>').html($(this).val()).html());
		});
		</script>

	</ul>









	<div id="invite_detail_content2270339">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270339" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="1" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270339" type="checkbox" id="bshow2270339" value="0"  /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270339').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270339").attr("disabled",true);
					$("#invite_detail_name2270339").addClass("tab_name_hide");


					bshow2270339 = 0
					$('#iframepage').contents().find("#invite_detail_title2270339").hide();
					$('#iframepage').contents().find("#invite_detail_content2270339").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270339").attr("disabled",false);
					$("#invite_detail_name2270339").removeClass("tab_name_hide");
					bshow2270339 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270339").show();
					$('#iframepage').contents().find("#invite_detail_content2270339").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>

        	<input type="hidden" name="invite_detail_fontindex2270339" id="invite_detail_fontindex2270339" value="0">
			<div style="color:#C6593D" ><img src="images/info.gif" width="16" height="15" /> 修改文字后,请点击工具列左侧 <img src="ckeditor/plugins/reloadwebfont/reload2.png" width="10" height="10" /> 按钮刷新。编辑时如需要上下行对齐文字请使用全角空格</div>
			<br>
			<textarea id="invite_detail_editor2270339" name="invite_detail_editor2270339"><p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">那一年，我们相遇<br />
世界这么大<br />
上天注定我们走在一起<br />
经历了初识的浪漫<br />
一起走过风雨<br />
失去了过后才知道珍惜<br />
我们看到彼此的好<br />
也看到彼此对自己的重要</span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">我的生命中不能没有你<br />
在这个美丽的日子<br />
我们决定让幸福延续<br />
期望快乐的回忆里，有您的参与</span></p>

<p>&nbsp;</p>

<p style="text-align: right;"><span style="font-size: 16px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">尹盛&amp;曹锐怡敬邀</span></span></p>

<p>&nbsp;</p>

<table border="0" cellpadding="1" cellspacing="1" style="width: 100%;">
	<tbody>
		<tr>
			<td style="width: 5%; text-align: right; vertical-align: top; white-space: nowrap;"><span style="font-size: 16px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">日期：</span></span></td>
			<td style="text-align: left; vertical-align: top;"><span style="font-size: 16px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">2015年5月2日</span></span></td>
		</tr>
		<tr>
			<td style="width: 5%; text-align: right; vertical-align: top; white-space: nowrap;"><span style="font-size: 16px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">时间：</span></span></td>
			<td style="text-align: left; vertical-align: top;"><span style="font-size: 16px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">10点18分</span></span></td>
		</tr>
		<tr>
			<td style="width: 5%; text-align: right; vertical-align: top; white-space: nowrap;"><span style="font-size: 16px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">地点：</span></span></td>
			<td style="text-align: left; vertical-align: top;"><span style="font-size: 16px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">奥雅婚礼园</span></span></td>
		</tr>
		<tr>
			<td style="width: 5%; text-align: right; vertical-align: top; white-space: nowrap;"><span style="font-size: 16px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">地址：</span></span></td>
			<td style="text-align: left; vertical-align: top;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">北京市朝阳区天辰东路2号</span></td>
		</tr>
		<tr>
			<td style="width: 5%; text-align: right; vertical-align: top; white-space: nowrap;">&nbsp;</td>
			<td style="text-align: left; vertical-align: top;">&nbsp;</td>
		</tr>
		<tr>
			<td style="width: 5%; text-align: right; vertical-align: top; white-space: nowrap;">&nbsp;</td>
			<td style="text-align: left; vertical-align: top;">&nbsp;</td>
		</tr>
	</tbody>
</table>
</textarea>
			<script type="text/javascript">
			//no use now			
			function striphtml(html)
			{
			   var tmp = document.createElement("DIV");
			   tmp.innerHTML = html;
			   return tmp.textContent||tmp.innerText;
			}			


			//?建求XMLHttpRequest?象
			function createRequest() {
				try {
					request = new XMLHttpRequest();
				} catch (trymicrosoft) {
					try {
						request = new ActiveXObject("Msxml2.XMLHTTP");
					} catch (othermicrosoft) {
						try {
							request = new ActiveXObject("Microsoft.XMLHTTP");
						} catch (failed) {
							request = false;
						}
					}
				}
				if (!request)
					alert("ERROR XMLHttpRequest!");
			}
			
			
			
			var ck_editor2270339;
			var contentcss_array =new Array();


			var webfontinfo_array = ['粗钢笔|粗钢笔1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E9%92%A2%E7%AC%941&font=%E7%B2%97%E9%92%A2%E7%AC%94|2','粗圆|粗圆1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E5%9C%861&font=%E7%B2%97%E5%9C%86|2','古印体|古印体1|http://42.121.32.43:443/Fonts/csslink?family=%E5%8F%A4%E5%8D%B0%E4%BD%931&font=%E5%8F%A4%E5%8D%B0%E4%BD%93|2','黑体|黑体1|http://42.121.32.43:443/Fonts/csslink?family=%E9%BB%91%E4%BD%931&font=%E9%BB%91%E4%BD%93|2','粗广告体|粗广告体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%931&font=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%93|2','隶书|隶书1|http://42.121.32.43:443/Fonts/csslink?family=%E9%9A%B6%E4%B9%A61&font=%E9%9A%B6%E4%B9%A6|2','书宋二|书宋二1|http://42.121.32.43:443/Fonts/csslink?family=%E4%B9%A6%E5%AE%8B%E4%BA%8C1&font=%E4%B9%A6%E5%AE%8B%E4%BA%8C|2','中行书|中行书1|http://42.121.32.43:443/Fonts/csslink?family=%E4%B8%AD%E8%A1%8C%E4%B9%A61&font=%E4%B8%AD%E8%A1%8C%E4%B9%A6|2','粗行楷体|粗行楷体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%931&font=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%93|2','甜妞体|甜妞体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%94%9C%E5%A6%9E%E4%BD%931&font=%E7%94%9C%E5%A6%9E%E4%BD%93|2'];
			var webfontnum = 10;


	        $(function() { //jquery functiom


			function   familyParser(text) {
				var familyArray = [];
				var textArray = [] ;
				var tagArray = [];
				var parser = new CKEDITOR.htmlParser();
				var font = null;
			
				parser.onText = function (text) {
					if (font == null) return;
					var indexS = font.indexOf('font-family:');
					var indexE1 = font.indexOf(',', indexS); // -1 , n
					var indexE2 = font.indexOf(';', indexS); // -1 , n
					if (indexE1 == -1 )
						indexE1 = font.length;
					if (indexE2 == -1 )
						indexE2 = font.length;
					indexE = Math.min(indexE1,indexE2);
					
					
					
					var fontName = font.substring(indexS + 12, indexE).trim().ReplaceAll("'", "").ReplaceAll('"', '');
					var bFound = false;
					for (var i = familyArray.length - 1; i >= 0; i--) {
						if (familyArray[i].localeCompare(fontName) == 0) {
							textArray[i] += text;
							bFound = true;
							break;
						}
					}
			
					if (bFound == false) {
						familyArray.push(fontName);
						textArray.push(text);
					}
				}
			
				parser.onTagClose = function (tagName) {
					tag = tagArray.pop();
					if (tag == null) return;
					if (tag.indexOf("font-family") != -1) {
						for (i = tagArray.length - 1; i >= 0; i--) {
							if (tagArray[i] == null) continue;
							if (tagArray[i].indexOf("font-family") != -1) {
								font = tagArray[i];
								return;
							}
						}
					}
					//font = null;
				}
			
				parser.onTagOpen = function (tagName, attributes, selfClosing) {
					if ((attributes == null) || (attributes.style == null)) {
						tagArray.push(null);
						return;
					}
			
					tagArray.push(attributes.style);
					if (attributes.style.indexOf("font-family") != -1) {
						font = attributes.style;
					}
			
				};
			
				parser.parse(text);
				parser = null;
				return {family:familyArray, text:textArray};
			}

			CKEDITOR.on('instanceReady', function(e) {
				
				e.editor.dataProcessor.htmlFilter.addRules(
					{
						elements:
						{
							$: function (element) {
								// Output dimensions of images as width and height
								if (element.name == 'img') {
									var style = element.attributes.style;
			
									if (style) {
										// Get the width from the style.
										var match = /(?:^|\s)width\s*:\s*(\d+)px/i.exec(style),
											width = match && match[1];
			
										// Get the height from the style.
										match = /(?:^|\s)height\s*:\s*(\d+)px/i.exec(style);
										var height = match && match[1];
			
										if (width) {
											element.attributes.style = element.attributes.style.replace(/(?:^|\s)width\s*:\s*(\d+)px;?/i, '');
											element.attributes.width = width;
										}
			
										if (height) {
											element.attributes.style = element.attributes.style.replace(/(?:^|\s)height\s*:\s*(\d+)px;?/i, '');
											element.attributes.height = height;
										}
									}
								}
			
			
			
								if (!element.attributes.style)
									delete element.attributes.style;
			
								return element;
							}
						}
					});


				//e.editor.execCommand( 'reloadWebFont');
								
			}); //CKEDITOR.on('instanceReady', function(e) 



			CKEDITOR.on( 'dialogDefinition', function( ev )
			{
			  // Take the dialog name and its definition from the event data.
			  var dialogName = ev.data.name;
			  var dialogDefinition = ev.data.definition;
			
			  // Check if the definition is from the dialog we're
			  // interested in (the 'image' dialog). This dialog name found using DevTools plugin



			  if ( dialogName == 'image' )
			  {

				 // Remove the 'Link' and 'Advanced' tabs from the 'Image' dialog.
				 dialogDefinition.removeContents( 'Link' );
				 dialogDefinition.removeContents( 'advanced' );
			
				 // Get a reference to the 'Image Info' tab.
				 var infoTab = dialogDefinition.getContents( 'info' );
			
				 // Remove unnecessary widgets/elements from the 'Image Info' tab.         
				 infoTab.remove( 'txtHSpace');
				 infoTab.remove( 'txtVSpace');
				 infoTab.remove( 'txtBorder' );
				 infoTab.remove( 'txtAlt' );
				 infoTab.remove( 'txtWidth' );
				 infoTab.remove( 'txtHeight' );
				 infoTab.remove( 'ratioLock' );
				 //infoTab.remove( 'htmlPreview' );
				 
				dialogDefinition.onSelect = function()
				{
					alert("onfocus");
					//var urlField = this.getContentElement( 'info', 'url' );
					//urlField.select();
				};
				  
			  }

			  
			  if ( dialogName == 'link' )
			  {
				// Remove the "Target" tab from the "Link" dialog.


				// Get a reference to the "Target" tab and set default to '_blank'
				/*
				var targetTab = dialogDefinition.getContents('target');
				var targetField = targetTab.get('linkTargetType');
				targetField['default'] = '_blank';
				*/
				/*
				var advTab =  dialogDefinition.getContents( 'advanced' );
				var cssField = advTab.get( 'advCSSClasses' );
				cssField['default'] = 'inviteTextLinkClass';
				*/
				
				var infoTab = dialogDefinition.getContents( 'info' );
				// Set the default value for the URL field.
				var urlField = infoTab.get( 'url' );
				urlField['default'] = 'www.example.com';
			
			
			
				// Rewrite the 'onFocus' handler to always focus 'url' field.
				dialogDefinition.onFocus = function()
				{
					var urlField = this.getContentElement( 'info', 'url' );
					urlField.select();
				};



				dialogDefinition.removeContents( 'target' );
				dialogDefinition.removeContents( 'advanced' );
				// Get a reference to the "Link Info" tab.
			
			
				// Remove the "Link Type" combo and the "Browser
				// Server" button from the "info" tab.
				infoTab.remove( 'linkType' );
				infoTab.remove( 'browse' );

			
			  }
			  
			  
			  
			});
			
			CKEDITOR.on('instanceCreated', function(e) {

				e.editor.addCommand( 'reloadWebFont',
				{
					exec : function( edr )
					{    
						htmltext2 =	edr.getData();
	
						//alert("reloadwebfont");
						//plaintext = edr.getData().replace( /(<[^<|>]+?>|\r\n|\n|\r|^\s*|\s*$|\s+|&nbsp;)/gim,'' );
						//plaintext_min = getMinTextInOrder(plaintext)
						//alert (plaintext_min);
			
						//1. update html
							cc = -1;
							//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
							$(edr.document.$).find('link').each(function() {
								
							//console.log(edr);	
							//console.log($(edr.document.$).find('link'));	
							//console.log($(CKEDITOR.instances[1].document.$).find('link'))
							//$(CKEDITOR.instances[1].document.$).find('link').each(function() {
								//	alert(cc);
								//bypass the first #webfontinfo_array.length css
								//if (cc >= 0) {
								if (cc>=0 && cc<webfontnum ) {
									tmp_webfontname = webfontinfo_array[cc].split('|')[0];
									tmp_webfont = webfontinfo_array[cc].split('|')[1];
									tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
									tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
									
									if (tmp_webfonttype==1 || tmp_webfonttype==3) {
									}else{
										new_webfont = tmp_webfont + $('#invite_detail_fontindex2270339').val();
										
										var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
										htmltext2 = htmltext2.replace(reg, new_webfont);
										htmltext2 = htmltext2.ReplaceAll(tmp_webfont+'_youvivid_dynamic_font',new_webfont);
									}
								} //if (cc>=0)
						
								cc=cc+1;
							
							
							});
							//}
	
	//console.log(htmltext);
							$('#iframepage').contents().find("#invite_detail_editor2270339").html(htmltext2);
							
							
							//////edr.setData(htmltext2, function(){
								//this.checkDirty();  // true
	
							//2. update csslink
	
								var fontArray = familyParser( htmltext2 );
	
	//console.log(fontArray);
	
								cc = -1;
								//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
								$(edr.document.$).find('link').each(function() {
								//edr.find('link').each(function() {	
									
									//bypass the first css
	
									//if (cc>=0) {
									if (cc>=0 && cc<webfontnum ) {
										tmp_webfontname = webfontinfo_array[cc].split('|')[0];
										tmp_webfont = webfontinfo_array[cc].split('|')[1];
										tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
										tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
										
	
										//if (  edr.getData().toUpperCase().indexOf(tmp_webfont.toUpperCase()) >= 0 ) {
										//	var_text = tmp_webfontname + plaintext_min;
										//}else{
										//	var_text = tmp_webfontname ;
										//}
										//fontArray_idx = fontArray.family.indexOf(tmp_webfont.toLowerCase());
	
										fontArray_idx = -1;
										
										for (var i = 0; i < fontArray.family.length; i++) {
										  if (fontArray.family[i].trim() == tmp_webfont.toLowerCase()) {
											fontArray_idx = i;
											break;
										  }
										}
										
										//alert(tmp_webfont.toLowerCase() + ", fontArray_idx:" + fontArray_idx + ", font: " +  fontArray.family[fontArray_idx]+ ", text: " +  fontArray.text[fontArray_idx] );
										
										if ( fontArray_idx == -1 ){
											//nothing to do 
										} else {
											
											var_text = getMinTextInOrder(fontArray.text[fontArray_idx]);
		
											if (tmp_webfonttype==1 || tmp_webfonttype==3) {
												//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
												new_css_url = tmp_webfonturl ;
			
											}else{
												new_webfont = tmp_webfont + $('#invite_detail_fontindex2270339').val();
												
												post_url = tmp_webfonturl.split('?')[0];
												post_vars = tmp_webfonturl.split('?')[1] + "&text=" + encodeURIComponent(var_text);
		
												post_vars=post_vars.ReplaceAll(tmp_webfont,new_webfont);
												post_vars=post_vars.ReplaceAll(encodeURIComponent(tmp_webfont),encodeURIComponent(new_webfont));
		
												createRequest();
	
												//post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
												//serverUrl = 'http://cn.youvivid.com/';
												//post_url = "http://" + serverUrl.split(/\/+/g)[1] + ":8080/Fonts/csslink";
												//alert(post_url);
	
												
							
													if($.browser.msie && parseInt($.browser.version, 10) <= 9) {
														post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
													} else {
														post_url = "http://42.121.32.43:443/Fonts/csslink";
													}
							
												
	
	
												request.open("POST", post_url, false);
												request.setRequestHeader("Content-type","application/x-www-form-urlencoded");
											//	alert(post_url+"," + post_vars);
												request.send(post_vars);
												post_response = request.responseText; //?取服?器返回的JSON字串
											//	alert("post_response=" + post_response);
												// this is for testing 
												//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
												new_css_url = post_response;
												
												//ex: http://176.34.27.47:8080/Fonts/getcss/88b676b2-ef25-4a41-98da-365bf8299d42;jsessionid=E7BD1CD3D9271040A72A5952BC4ED719?family=粗P 
												//contentcss_url_part1=post_response.split('?family=')[0];
												//contentcss_url_part2=post_response.split('?family=')[1];
												//contentcss_url = contentcss_url_part1 + '?family=' + encodeURIComponent(contentcss_url_part2);
												//new_css_url =  contentcss_url;
												
								//console.log('tmp_webfont:' + tmp_webfont + ', new_webfont:' + new_webfont);
								//				var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
								//				htmltext = htmltext.replace(reg, new_webfont);
											}
			
											
										//	alert(new_css_url);
										//	console.log(new_css_url + ", id=" + tmp_webfont);
											$('#iframepage').contents().find("#" + tmp_webfont ).attr('href', new_css_url )
											
											
											$(this).attr('href', new_css_url );
										}//( fontArray_idx == -1 ){
									} //if (cc>=0)
							
									cc=cc+1;
								
								
								});
								//}
								// useless below
								//ev.editor.config.font_names = 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w';
								//CKEDITOR.config.font_names = 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w';
								
								// new ckeditor 4.3 no need to update fontindex 
								//$('#invite_detail_fontindex2270339').val(Number($('#invite_detail_fontindex2270339').val())+1);
			
	
						//////	});//edr.setData(htmltext2, function(){
	
	
	
						edr.resetDirty();
	
	
	
					},
					async : true //FIREFOX NEED THIS
				}); //end of e.editor.addCommand( 'reloadWebFont',
				/*
					e.editor.on( 'afterCommandExec', function(ev) { 
						alert(ev.data.name );
					});
					e.editor.on( 'selectionChange', function(ev) { 
								delay(function(){
									ev.editor.execCommand( 'reloadWebFont');
								},1000);
						//console.log(ev.data.selection );
						//console.log(ev.data.path );
						//alert(ev.data.selection + "," + ev.data.path );
					});
				*/
			
				e.editor.on( 'saveSnapshot', function(ev) { 
					delay(function(){
						ev.editor.execCommand( 'reloadWebFont');
					},200);
				});
			
			 

				//onchange plugin event
				e.editor.on( 'change', function(ev) { 
					
					if (ev.editor.checkDirty()) {
					// ... ok, we've really changed: respond here ...

						//alert('change');
						htmltext =	ev.editor.getData();
						$('#iframepage').contents().find("#invite_detail_editor2270339").html(htmltext);
							
						//if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	
	
							//delay(function(){
								//ev.editor.execCommand( 'reloadWebFont');
							//},1000);
	
						//} //if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	


					}

				

				});

				e.editor.on( 'key', function(ev) { 
					if (ev.editor.checkDirty()) {
					// ... ok, we've really changed: respond here ...
						//alert('change');
						delay(function(){ //key down event use as key up event
							htmltext =	ev.editor.getData();
							$('#iframepage').contents().find("#invite_detail_editor2270339").html(htmltext);
						},1000);

					}

				});


			}); //CKEDITOR.on('instanceCreated', function(e) 
				

			CKEDITOR.config.templates_files = [
				//CKEDITOR.getUrl( 'plugins/templates/templates/default.js' )
				//CKEDITOR.getUrl( 'plugins/templates3/templates/funssage.js.asp?tcid=7' )
				CKEDITOR.getUrl( '../ckeditor_template.js.asp?tcid=7' )
			];


			if ( window.CKEDITOR && ( !CKEDITOR.env.ie || CKEDITOR.env.version > 7 ) )
				CKEDITOR.env.isCompatible = true;

			var invite_detail_editor2270339 = CKEDITOR.replace( 'invite_detail_editor2270339',
			{
				
				//filebrowserBrowseUrl: 'mobile_invite_select_photo_editor_plu_leo.asp?invite_detail_id=2270339',
				filebrowserBrowseUrl: 'mobile_invite_select_photo_editor_plu_s3oss.asp?invite_detail_id=2270339',
				filebrowserWindowWidth: '480',
				filebrowserWindowHeight: '610',
				//filebrowserImageBrowseUrl: 'mobile_invite_select_photo_editor.asp',
				//filebrowserUploadUrl: 'mobile_slideshow_select_photo_header.asp?invite_detail_id=1160483',
				//filebrowserImageUploadUrl: 'mobile_slideshow_select_photo_header.asp?invite_detail_id=1160483',
				//extraPlugins : 'templates3,reloadwebfont,devtools', 
				extraPlugins : 'templates3,reloadwebfont,confighelper,autogrow', 
				//extraPlugins : 'reloadwebfont', 
				//templates_replaceContent : true,
				//templates_files : [ CKEDITOR.getUrl( 'plugins/templates/templates/default.js.asp' )],
				toolbar :
				[
				
				
					{ name: 'reloadWebFont', items : ['reloadWebFont'] },{ name: 'source', items : ['Source'] },{ name: 'templates_page', items : ['Templates_page'] },{ name: 'templates_component', items : ['Templates_component'] },'/', //source cause problem for access document in change event
					
					//{ name: 'font face', items : [ 'Source','Font','FontSize' ] }, //source cause problem for access document in change event
					{ name: 'font face', items : [ 'Font','FontSize' ] },
					{ name: 'font type', items : [ 'Bold','Italic','TextColor','BGColor' ] },
					{ name: 'paragraph', items : [ 'JustifyLeft','JustifyCenter','JustifyRight' ] },
					{ name: 'links', items : [ 'Link','Unlink'] }
				],
				startupShowBorders : false,
				resize_enabled : false,
				toolbarCanCollapse : false,
				toolbarStartupExpanded : true,
				//height: 350,
				autoGrow_minHeight : 350,
				autoGrow_maxHeight : 700,
				//skin : 'office2003',
				skin : 'moono',
				language : 'zh-cn',
				//skin : 'v2',
				
				// use inline config instead
				//customConfig : '/ckeditor/config_leo.js'
				//enterMode : CKEDITOR.ENTER_BR,
				enterMode : CKEDITOR.ENTER_P,
				//font_names : 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w, Microsoft JhengHei, Microsoft YaHei, arial;' ,	
				font_names : "手机预设字体/Microsoft JhengHei,Microsoft YaHei,arial;粗钢笔/粗钢笔1,粗钢笔10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗圆/粗圆1,粗圆10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;古印体/古印体1,古印体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗广告体/粗广告体1,粗广告体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;隶书/隶书1,隶书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;书宋二/书宋二1,书宋二10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;中行书/中行书1,中行书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;", 
				//config.contentsCss = ['/ckeditor/contents_leo.css', 'http://176.34.27.47/fontScript/getfont.pl?family=%E7%B2%97%E9%8B%BC%E7%AD%86&text=ABCDEFG'] 
				//contentsCss : ['/ckeditor/contents_leo.css']
				//contentsCss : []	
				//contentsCss : contentcss_array, 
			    contentsCss : ["/ckeditor4.3.4_leo/contents2.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css"],
				removePlugins: 'elementspath',
				allowedContent: true 

			});				
			ck_editor2270339 = invite_detail_editor2270339;

			////console.log('手机预设字体/Microsoft JhengHei,Microsoft YaHei,arial;粗钢笔/粗钢笔1,粗钢笔10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗圆/粗圆1,粗圆10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;古印体/古印体1,古印体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗广告体/粗广告体1,粗广告体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;隶书/隶书1,隶书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;书宋二/书宋二1,书宋二10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;中行书/中行书1,中行书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;');

	
			});  //jquery functiom
					
			</script>
			


	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270340">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270340" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="7" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270340" type="checkbox" id="bshow2270340" value="0"  /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270340').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270340").attr("disabled",true);
					$("#invite_detail_name2270340").addClass("tab_name_hide");


					bshow2270340 = 0
					$('#iframepage').contents().find("#invite_detail_title2270340").hide();
					$('#iframepage').contents().find("#invite_detail_content2270340").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270340").attr("disabled",false);
					$("#invite_detail_name2270340").removeClass("tab_name_hide");
					bshow2270340 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270340").show();
					$('#iframepage').contents().find("#invite_detail_content2270340").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>


<!-- case 7 -->
<!--
<div style="color:#C6593D" > 请选择添加相酝计</div>
-->   

              <style>
              #sortable2270340 { list-style-type: none; margin: 0; padding: 0; width: 350px; }
              #sortable2270340 li { margin: 3px 3px 3px 0; padding: 1px; float: left; width: 100px; height: 110px; font-size: 8pt; text-align: center; cursor: move;}
              #sortable2270340 li span{ cursor: pointer; }
				.thumb {
					width: 100px;
					height: 100px;
					overflow: hidden;
				}
				.thumb .thumbimage  {
					width:100%; height:100%; background-size:cover; background-position:center center;
				}
              </style>
              <script>
              $(function() {
                  $("#sortable2270340").sortable({
                      
                      deactivate: function(ev, ui){
                          
                          syncGallery2270340();
                      }
                      

                  });
                  
                  $("#sortable2270340").disableSelection();
              });
              </script>
              
              <input id="select_image22270340" name="select_image22270340" type="button" value="添加相册图片" />
              

			<input type="hidden" id="slideshow2270340" name="slideshow2270340" value="6609072,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e150421553650de9172f.jpg,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f150421553650de9172f.jpg|6608954,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e15042155364f645c0b2.jpg,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364f645c0b2.jpg|6609106,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e1504215536519a86014.jpg,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f1504215536519a86014.jpg|6609091,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e150421553651365c0b1.jpg,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f150421553651365c0b1.jpg|6608897,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e15042155364d9135e58.jpg,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364d9135e58.jpg|6608843,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e15042155364b8bbb692.jpg,http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364b8bbb692.jpg">
            
            <input type="hidden" name="sn2270340" value="W93TV">
            
            <input type="hidden" name="invite_usrcookies2270340" value="">
          
            <table width="100%" cellpadding="0" cellspacing="0" border="0">
             <tr><td width="100%" height="30" >

<span id="nopicture2270340"  style="color:#C6593D" ></span>          
              
              <ul id="sortable2270340" name="sortable2270340">
<!--<li id="40240" class="ui-state-default" fileurl="uploads/image/f0904273C82W2683.jpg"  style="text-align: right"><span><img src="./images/close_button.png"></span><BR><img src="uploads/image/f0904273C82W2683.jpg" width="100" height="90"></li>-->

                <li id="6609072" class="ui-state-default thumb" fileurl="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f150421553650de9172f.jpg" style="text-align: right"><span><img src="./images/close_button.png"></span><div class="thumbimage" style="background-image: url(http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e150421553650de9172f.jpg);"><img src="images/spacer.gif" width="100%" ></div><img src="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e150421553650de9172f.jpg" width="1" height="1" ></li>

                <li id="6608954" class="ui-state-default thumb" fileurl="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364f645c0b2.jpg" style="text-align: right"><span><img src="./images/close_button.png"></span><div class="thumbimage" style="background-image: url(http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e15042155364f645c0b2.jpg);"><img src="images/spacer.gif" width="100%" ></div><img src="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e15042155364f645c0b2.jpg" width="1" height="1" ></li>

                <li id="6609106" class="ui-state-default thumb" fileurl="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f1504215536519a86014.jpg" style="text-align: right"><span><img src="./images/close_button.png"></span><div class="thumbimage" style="background-image: url(http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e1504215536519a86014.jpg);"><img src="images/spacer.gif" width="100%" ></div><img src="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e1504215536519a86014.jpg" width="1" height="1" ></li>

                <li id="6609091" class="ui-state-default thumb" fileurl="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f150421553651365c0b1.jpg" style="text-align: right"><span><img src="./images/close_button.png"></span><div class="thumbimage" style="background-image: url(http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e150421553651365c0b1.jpg);"><img src="images/spacer.gif" width="100%" ></div><img src="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e150421553651365c0b1.jpg" width="1" height="1" ></li>

                <li id="6608897" class="ui-state-default thumb" fileurl="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364d9135e58.jpg" style="text-align: right"><span><img src="./images/close_button.png"></span><div class="thumbimage" style="background-image: url(http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e15042155364d9135e58.jpg);"><img src="images/spacer.gif" width="100%" ></div><img src="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e15042155364d9135e58.jpg" width="1" height="1" ></li>

                <li id="6608843" class="ui-state-default thumb" fileurl="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/f15042155364b8bbb692.jpg" style="text-align: right"><span><img src="./images/close_button.png"></span><div class="thumbimage" style="background-image: url(http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e15042155364b8bbb692.jpg);"><img src="images/spacer.gif" width="100%" ></div><img src="http://youvividcnupload1.oss.aliyuncs.com/images/2015/17/e15042155364b8bbb692.jpg" width="1" height="1" ></li>

              </ul>
               
              
              
              
              </td></tr>
          
            </table>
            




<script>
		
var $dialog_photo2;		
		
$(document).ready(function() { 
		     
       
	
		
		$("#select_image22270340").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			//$('#iframepage').contents().find('html, body').animate({scrollTop: 1000});
			//var page = 'mobile_slideshow_select_photo_header_plu_leo.asp?invite_detail_id=2270340';
			var page = 'mobile_slideshow_select_photo_header_plu_s3oss.asp?invite_detail_id=2270340';
			var pagetitle = '请选择婚纱相册的相片';
			$dialog_photo2 = $('<div></div>')
			.html('<iframe frameborder="0" border="0" cellspacing="0" style="border: none; " src="' + page + '" width="100%" height="100%"></iframe>')
			.dialog({
				position: {my: "left top", at: "left top", of: document},
				autoOpen: false,
				modal: true,
				height: 610,
				width: 580,
				title: pagetitle,
				buttons: [{
					text: '关闭',
					"class": 'closeButtonClass',
					click: function() {
                         $( this ).dialog( "close" );
					}
				}],
				beforeClose: function (event, ui) {
				   syncGallery2270340();
			  }
				  
			});
			$dialog_photo2.dialog('open');

		});


    $("#sortable2270340 li span").live("click",function() {
      
          $(this).closest('li').remove();
           
           syncGallery2270340(); 
    
    });
    
});

function syncGallery2270340(){

         var list = '';
  
     		 $('#nopicture2270340').html("");
     		 $('#iframepage').contents().find('#nopicture2270340').html("");
     		 
     		 $('#iframepage').contents().find('#Gallery2270340 li').remove();    
         
         $('#iframepage').contents().find("#invite_webimg,#img_decoration1,#img_decoration2,#img_decoration3").css('cursor', 'default');			
         
         if ($('#sortable2270340 li').size() > 0){
             
             $('#sortable2270340 li').each(function(){
               
                var current = $(this);
    
               if(current.children().size() > 0) {
                
                   var img = current.children().eq(2); 
                   //alert( current.attr('id') + current.attr('fileurl'));    
                   //window.parent.$("#iframepage")[0].contentWindow.addPhotoSwipe( current.attr('id'), img.attr('src'), current.attr('fileurl'), $('#sortable li').size()); // prevent cross domain access restriction of xitie
                   //alert(img.attr('src'));
				   $("#iframepage")[0].contentWindow.addPhotoSwipe2270340( current.attr('id'), img.attr('src'), current.attr('fileurl'), $('#sortable2270340 li').size());
                    
                   list = list + "'" + current.attr('id') + "," +  img.attr('src') + "," + current.attr('fileurl') + "'";
                }            
                
                 
             });
             
             $('#iframepage').contents().find("#invite_webimg,#img_decoration1,#img_decoration2,#img_decoration3").css('cursor', 'pointer');			
             
             
         }else{
             $('#nopicture2270340').html("没有图片, 请点击上方按钮添加图片");
             $('#iframepage').contents().find('#nopicture2270340').html("没有图片");
             
         }
         
         document.form_invite.slideshow2270340.value = list.ReplaceAll("''", "|").ReplaceAll("'", "");

}



  var oldonload2270340 = window.onload;
  if (typeof window.onload != 'function') {
    window.onload = syncGallery2270340;
  } else {
    window.onload = function() {
      if (oldonload2270340) {
        oldonload2270340();
      }
      syncGallery2270340();
    }
  }



</script>


<!-- case 7 -->




	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270341">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270341" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="2" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270341" type="checkbox" id="bshow2270341" value="0" checked="checked" /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$("#invite_detail_name2270341").addClass("tab_name_hide");
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270341').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270341").attr("disabled",true);
					$("#invite_detail_name2270341").addClass("tab_name_hide");


					bshow2270341 = 0
					$('#iframepage').contents().find("#invite_detail_title2270341").hide();
					$('#iframepage').contents().find("#invite_detail_content2270341").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270341").attr("disabled",false);
					$("#invite_detail_name2270341").removeClass("tab_name_hide");
					bshow2270341 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270341").show();
					$('#iframepage').contents().find("#invite_detail_content2270341").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>

        <input type="hidden" name="invite_detail_previewid2270341" id="invite_detail_previewid2270341" value="225036">
        <input type="hidden" name="invite_detail_mp4url2270341" value="http://youvivid-streaming.oss-cn-hangzhou.aliyuncs.com/IVT20150219/554MAdfVDU6yNjvOZAmVeQ.mp4">
        <span style="color:#C6593D" ><img src="images/info.gif" width="16" height="15" />&nbsp;为尊重著作财产权,请帖中播放网上制作的MV时,不支持自己上传的MP3音乐</span><br/>

			<script type="text/javascript">
				<!--
		
				function toggleCreateMVPanel2270341() {
					var ele;
					ele = document.getElementById("youku_panel2270341");
					ele.style.display = "none";
					
					ele = document.getElementById("createmv_panel2270341");
					if(ele.style.display == "block") {
						ele.style.display = "none";
					}
					else {
						ele.style.display = "block";
					}
				} 
				
				-->
            </script>



		<input value="制作新MV" type="button" onClick="javascript:toggleCreateMVPanel2270341();" />
        <div id="createmv_panel2270341" style="position:absolute; left:0; right:0; margin-left:auto; margin-right:auto; display:none; font-size: 10pt; width: 500px; border: #F3C thin solid; padding:10px 10px 10px 10px; background:#FFFFCC;">
        	<div>
            您即将开启新的页面制作MV,温馨提示以下几点:<br>1. 网上制作MV并添加请帖里播放是免费的<br>2. 请使用电脑浏览器编辑MV<br>3. MV编辑完成请记得设置MV封面图(请在MV编辑页右下角点下一步)<br>4. 制作完成并保存后,请返回此页面点击[重新载入]以选取新制作完成的MV<br>5. 为尊重著作财产权,请帖中播放网上制作的MV时,不支持自己上传的MP3音乐
            </div>

			<div>
            	<input type="button" value=" 开始制作喜帖MV " onclick="javascript:window.open('/create_mv.asp?asid=123');toggleCreateMVPanel2270341();">
          
                <input type="button" value=" 开始制作宝宝MV " onclick="javascript:window.open('/create_mv.asp?asid=92');toggleCreateMVPanel2270341();">
          
                <input type="button" onClick="javascript:toggleCreateMVPanel2270341();" value=" 关闭 "></div>

        </div>

       <input value="重新载入" type="button" onClick="document.getElementById('videoframepage2270341').contentWindow.location.reload(true);" />     


        	
        
			<script type="text/javascript">
				<!--
			
		
				function toggleYoukuPanel2270341() {
					var ele;
					ele = document.getElementById("createmv_panel2270341");
					ele.style.display = "none";
					ele = document.getElementById("youtube_panel2270341");
					ele.style.display = "none";
					ele = document.getElementById("youku_panel2270341");
					if(ele.style.display == "block") {
						ele.style.display = "none";
					}
					else {
						ele.style.display = "block";
					}
				} 
				
				function parseYoukuVID2270341(url) {
				 	//urlBuf = url.toLowerCase();
					urlBuf = url;
					if (urlBuf.indexOf("youku.com/v_show/id_") > 0) { 
						strArrayBuf = urlBuf.split("youku.com/v_show/id_"); 
						strBuf = strArrayBuf[1]; 
						if ( strBuf.indexOf(".") > 0 ) { 
							strArrayBuf = strBuf.split("."); 
							return strArrayBuf[0]; 
						} else { 
							return "ERR"; 
						}
					} else { 
						return "ERR"; 
					}
				} 
				
				
				
				
				function setYouKuUrl2270341() {
					
					youkuUrl = document.form_invite.invite_detail_youkuurl2270341.value;
					youkuVID=parseYoukuVID2270341(youkuUrl);
					if (youkuVID == 'ERR') {
						alert("优酷视频网址不正确");
					} else {
					
						$('#invite_detail_byouku2270341').val('1');
						$('#iframepage').contents().find("#youkuvideo2270341").show();
						$('#iframepage').contents().find("#youtubevideo2270341").hide();
						$('#iframepage').contents().find("#flashvideo2270341").hide();
						//window.frames.iframepage.showYoukuVideo("youkuplayer",youkuVID);
						$('#iframepage').get(0).contentWindow.showYoukuVideo2270341("youkuplayer2270341",youkuUrl);

						//$('#iframepage').get(0).contentWindow.global_youku_vid = youkuVID;
						//$('#iframepage').get(0).contentWindow.clickObj("reloadYoukuVideoBut");
						toggleYoukuPanel2270341();
					}
				}

				function toggleYoutubePanel2270341() {
					var ele;
					ele = document.getElementById("createmv_panel2270341");
					ele.style.display = "none";
					ele = document.getElementById("youku_panel2270341");
					ele.style.display = "none";
					ele = document.getElementById("youtube_panel2270341");
					if(ele.style.display == "block") {
						ele.style.display = "none";
					}
					else {
						ele.style.display = "block";
					}
				} 


				function parseYoutubeVID2270341(url) {
				 	//urlBuf = url.toLowerCase();
					urlBuf = url;

					var youtubeVID = urlBuf.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&]+)/);
					if(youtubeVID != null) {
					   return youtubeVID[1];
					} else { 
						return "ERR"; 
					}				

				} 


				function setYoutubeUrl2270341() {
					
					youtubeUrl = document.form_invite.invite_detail_youtubeurl2270341.value;
					youtubeVID=parseYoutubeVID2270341(youtubeUrl);
					if (youtubeVID == 'ERR') {
						alert("Youtube影片网址不正确");
					} else {
					
						$('#invite_detail_byouku2270341').val('2');
						$('#invite_detail_youtubevid2270341').val(youtubeVID);
						$('#iframepage').contents().find("#youkuvideo2270341").hide();
						$('#iframepage').contents().find("#youtubevideo2270341").show();
						$('#iframepage').contents().find("#flashvideo2270341").hide();
						//window.frames.iframepage.showYoukuVideo("youkuplayer",youkuVID);
						
						
						toggleYoutubePanel2270341();
						$('#iframepage').get(0).contentWindow.youtubePlayer2270341.cueVideoById(youtubeVID);

						//$('#iframepage').get(0).contentWindow.global_youku_vid = youkuVID;
						//$('#iframepage').get(0).contentWindow.clickObj("reloadYoukuVideoBut");
					}
				}
				
				-->
            </script>

		 
        <input value="使用优酷视频" type="button" onClick="javascript:toggleYoukuPanel2270341();" /> 
		 
        <input value="使用YouTube视频" type="button" onClick="javascript:toggleYoutubePanel2270341();" /> 

      	<input type="hidden" name="invite_detail_byouku2270341" id="invite_detail_byouku2270341" value="0">


        <div id="youku_panel2270341" style="position:absolute; left:0; right:0; margin-left:auto; margin-right:auto; display:none; font-size: 10pt; width: 500px; border: #F3C thin solid; padding:10px 10px 10px 10px; background:#FFFFCC;">

            <div>请填入优酷视频网址</div>
            <div>
            	<input type="input" name="invite_detail_youkuurl2270341" value="" size="60">
            </div>
            <div><input type="button" name="sub" value=" 确定 " onclick="setYouKuUrl2270341();">  <input type="button" onClick="javascript:toggleYoukuPanel2270341();" value=" 关闭 "></div>
        </div>
        
        <div id="youtube_panel2270341" style="position:absolute; left:0; right:0; margin-left:auto; margin-right:auto; display:none; font-size: 10pt; width: 500px; border: #F3C thin solid; padding:10px 10px 10px 10px; background:#FFFFCC;">

            <div>请填入Youtube视频网址(中国大陆地区不支持)</div>
            <div>
            	<input type="input" name="invite_detail_youtubeurl2270341" value="" size="60">
            </div>
            <div><input type="button" name="sub" value=" 确定 " onclick="setYoutubeUrl2270341();">  <input type="button" onClick="javascript:toggleYoutubePanel2270341();" value=" 关闭 "></div>
        </div>
        
        
	
		<iframe id="videoframepage2270341" allowtransparency="true" scrolling="auto" style="height: 450px; width: 100%; " src="mobile_invite_select_video.asp?invite_detail_id=2270341" frameborder="0" marginwidth="0"  ></iframe>

	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270342">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270342" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="3" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270342" type="checkbox" id="bshow2270342" value="0" checked="checked" /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$("#invite_detail_name2270342").addClass("tab_name_hide");
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270342').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270342").attr("disabled",true);
					$("#invite_detail_name2270342").addClass("tab_name_hide");


					bshow2270342 = 0
					$('#iframepage').contents().find("#invite_detail_title2270342").hide();
					$('#iframepage').contents().find("#invite_detail_content2270342").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270342").attr("disabled",false);
					$("#invite_detail_name2270342").removeClass("tab_name_hide");
					bshow2270342 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270342").show();
					$('#iframepage').contents().find("#invite_detail_content2270342").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>

<script>
$(document).ready(function(){
  $("#question_sortable li").hover(function(){
    //$(this).find("table tr td:first-child").css("background-color","gray");
    //$(this).find("table tr td:first-child").addClass("ui-icon ui-icon-arrow-2-n-s");
    //$(this).find("table tr td:first-child span").addClass("ui-corner-all ui-icon ui-icon-arrow-2-n-s");
    $(this).find("table tr td:first-child").addClass("moveable");
    $(this).addClass("li_boder");
    },function(){
    //$(this).find("table tr td:first-child").css("background-color","white");
    //$(this).find("table tr td:first-child").removeClass("ui-icon ui-icon-arrow-2-n-s");
    //$(this).find("table tr td:first-child span").removeClass("ui-corner-all ui-icon ui-icon-arrow-2-n-s");
    $(this).find("table tr td:first-child").removeClass("moveable");
    $(this).removeClass("li_boder");
  });
  
  $("#question_sortable li input").hover(function(){
    
    //alert($(this).closest("ul").attr("id"));
    //$(this).closest("li").find("table tr td:first-child span").removeClass("ui-corner-all ui-icon ui-icon-arrow-2-n-s");
    $(this).css("cursor","pointer");
    $(this).closest("li").find("table tr td:first-child").removeClass("moveable");
    $(this).closest("li").removeClass("li_boder");
    },function(){
    
    //$(this).closest("li").find("table tr td:first-child span").addClass("ui-corner-all ui-icon ui-icon-arrow-2-n-s");
    $(this).css("cursor","n-resize");
    $(this).closest("li").find("table tr td:first-child").addClass("moveable");
    $(this).closest("li").addClass("li_boder");
  });


});


    
    
</script>
<style>
  
  .li_boder{
     
       border: #3a89b5 1px dotted; 
     
  }
    
  .moveable{
     
     //background:url(images/move.png) left top no-repeat;  
     cursor: pointer;
  }
  
  #question_sortable { list-style-type: none; margin: 0; padding: 0; width: 100%; }
  #question_sortable li { }

  #question_sortable li :hover {
    cursor: n-resize;
    
    /***border: #3a89b5 1px dotted;  ***/
  }



#question_sortable li.ui-sortable-helper{
    cursor: n-resize;
}  
</style>
  <script>
  $(function() {
    $( "#question_sortable" ).sortable({ axis: "y" ,
      
		items: 'li',
		update: function(event, ui) {
			 var id_selected = ui.item.attr("id");
			 var id_array = $(this).sortable('toArray');
			 index_selected = indexOfStr(id_array,id_selected);
    
    
      	//var id_moveto = id_array[index_selected-1];
				
				//alert(index_selected + '/' + id_moveto);
			  
			 if (index_selected != 0) {
				var id_moveto = id_array[index_selected-1];
				$('#iframepage').contents().find('#' + id_selected ).insertAfter($('#iframepage').contents().find('#' + id_moveto));	 
				 
			 } else {
				var id_moveto = id_array[1];
				$('#iframepage').contents().find('#' + id_selected ).insertBefore($('#iframepage').contents().find('#' + id_moveto));	 
			 }

    $('#iframepage').contents().find("#rsvptable tr[style*='block']").each( function(n){            
      n++;
      
      $(this).find("span:eq(0)").html(n);
    });  
/***		 

			try { 
				$('#iframepage').contents().find('#' + id_selected ).insertAfter($('#iframepage').contents().find('#' + id_selected));
			}
			catch(err) {
				//do nothing
			}
			finally {
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 
				// alert(id_selected + ":3");
			}

***/
			
		}      
      
      
    });
    //draggable({ axis: "y" });
    //$( "#question_sortable" ).disableSelection();
  });
  </script>

<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr><td colspan="2" align="left" bgcolor="#ffffff"><span style="color:#C6593D" ><img src="images/info.gif" width="16" height="15" />&nbsp;左侧打钩选取要问的问题，点击问题后可修改内容，鼠标上下拖拉问题可调整顺序<br>右侧打钩选择请帖中公开展示的回答，完整回复报表在右上角[帐户后台]>[我的请帖]中查看</span></td>
   </tr>

 <tr>
   <td width="10%" align="center" >
 	提示文字
   
   </td>
   <td width="90%">
	

<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
  <td width="40%" align="left" bgcolor="#ffffff">	

	<textarea name="qaprompt" id="qaprompt" cols="30" rows="3" style="font-family:微软雅黑,Microsoft YaHei,Microsoft JhengHei,verdana; font-size:9pt;">为了方便统整婚宴资料，请您花几分钟填写以下内容，并请及时回复，我们的婚宴会因您的协助更加美好。</textarea>     
  </td>

  


<td width="60%" align="left" valign="top" bgcolor="#FFFFFF">	</td>



<script>
$(function() {
    $('.popper2').hover(function(e) {
   
        var target = '#' + ($(this).attr('data-popbox'));
         
        $(target).show();
    }, function() {
        var target = '#' + ($(this).attr('data-popbox'));
        $(target).hide();
    });
 
 	$('#pop2').click(function() {
        $('#pop2').hide();
    });

});
</script>                                

</tr>
</table>

 <script>
$(document).ready(function() { 
		
		$("#qaprompt").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#qaprompt").find("span:eq(0)").html($(this).val().ReplaceAll('\r\n','\n').ReplaceAll('\n','<br>')); 
			//setHiddenHtml('remindtitle');
		});
		//$("#remindtitle").bind('focus',function (){
	  // $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
		//});

    $('.showText').each(function(){
      
      
      //var count = $(this).val().split('\n').length;
      
  		$(this).css('height','auto');
  		$(this).height(this.scrollHeight );
  
    });


  	$('.showText').on('keyup',function(){
  		
  		//var count = $(this).val().split('\n').length;
  		
  		$(this).css('height','auto');
  		$(this).height(this.scrollHeight);
  	});
});		


  	
</script>		



   </td>
 </tr>

</table>

<div id="pop2" class="popbox" style="width:450px" >
    <h2>如何使用二维码签到</h2>
    <div align="left" style="padding: 20px 20px 20px 20px ">
		1. 打勾启用此功能后,宾客送出活动回函后会在下方生成二维码<br><br>2. 活动当天宾客在报到柜台出示此二维码, 由工作人员以微信扫码验证身分<br><br>3. 工作人员填入[签到确认验证码], 即可完成报到<br><br>4. 所有签到数据汇整在[帐户后台 > 我的请帖] 的宾客问卷回覆报表<br><br>    
	</div>
</div>
<div id="pop3" class="popbox" style="width:450px" >
    <h2>什么是公开留言?</h2>
    <div align="left" style="padding: 20px 20px 20px 20px ">
		在问题的右侧打勾，该题目的宾客回答会显示在请帖的回函子页下方。<br>你可对不具隐私性质的问题，在右侧打勾公开。<br>例如: 名字, 留言祝福语 等
	</div>
</div>

<table width="100%" cellpadding="3" cellspacing="1" border="0">
<!-- leo move to form beginning
<input type="hidden" name="invite_id" value="260347">
-->
 <tr>
     <td width="8%" height="30" align="center" valign="middle" bgcolor="#C7C7C7">选取</td>
     <td width="84%" height="30" valign="middle" bgcolor="#C7C7C7">问题</td>
     <td width="8%" height="30" align="center" valign="middle" bgcolor="#C7C7C7">
        <span class="popper2" data-popbox="pop3" style="color:#06C">
        公开<br>留言<br><img src="images/tooltip_icon.png" width="12" height="12" align="absmiddle" />
        </span>
	 
	 
     
     </td>
     
 </tr>
</table> 

<ul id="question_sortable">


 

  <li id="ta2772246">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772246">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="1">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772246', this.checked, 0);" value="2772246"  checked>
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="您的姓名" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772246', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772246', this.value);">您的姓名</textarea>
         <br/>
     
     <div id="q2772246"> 


     <!--<input type="text" name="t2772246" value="" size="26">-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772246" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772247">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772247">
      <input type="hidden" name="answertype" value="1">
      <input type="hidden" name="switch_status" value="1">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772247', this.checked, 1);" value="2772247"  checked>
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="您会来参与我们的婚宴吗?" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772247', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772247', this.value);">您会来参与我们的婚宴吗?</textarea>
         <br/>
     
     <div id="q2772247"> 


            <div id="s8695348">
            
            <!--<img src="./image/del.png" onclick="delRow('q2772247','s8695348');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o2772247" size="24" value="非常乐意，有{1-10}人参加" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('8695348', this.value);">-->
            
              
                <img src="./image/del.png" onclick="delRow('q2772247','s8695348');" style="cursor:pointer;" vspace="5" hspace="5" align="top">
                          
                <!--<input type="text" name="o2772247" size="48" value="非常乐意，有{1-10}人参加" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695348', this.value);">-->
                <textarea name="o2772247" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695348', this.value);">非常乐意，有{1-10}人参加</textarea>

            
            
            </div> 

            <div id="s8695349">
            
            <!--<img src="./image/del.png" onclick="delRow('q2772247','s8695349');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o2772247" size="24" value="无法参加" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('8695349', this.value);">-->
            
              
                <img src="./image/del.png" onclick="delRow('q2772247','s8695349');" style="cursor:pointer;" vspace="5" hspace="5" align="top">
                          
                <!--<input type="text" name="o2772247" size="48" value="无法参加" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695349', this.value);">-->
                <textarea name="o2772247" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695349', this.value);">无法参加</textarea>

            
            
            </div> 

                       
     </div>
     
     
     <img src="./image/add.png" onclick="javascript: addRow('q2772247');" style="cursor: pointer;" vspace="5" hspace="5" align="absmiddle">
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772247" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772248">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772248">
      <input type="hidden" name="answertype" value="1">
      <input type="hidden" name="switch_status" value="0">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772248', this.checked, 2);" value="2772248" >
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="您是新郎还是新娘的宾客？" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772248', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772248', this.value);">您是新郎还是新娘的宾客？</textarea>
         <br/>
     
     <div id="q2772248"> 


            <div id="s8695350">
            
            <!--<img src="./image/del.png" onclick="delRow('q2772248','s8695350');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o2772248" size="24" value="我是帅新郎的{亲戚|朋友|同学|同事}" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('8695350', this.value);">-->
            
              
                <img src="./image/del.png" onclick="delRow('q2772248','s8695350');" style="cursor:pointer;" vspace="5" hspace="5" align="top">
                          
                <!--<input type="text" name="o2772248" size="48" value="我是帅新郎的{亲戚|朋友|同学|同事}" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695350', this.value);">-->
                <textarea name="o2772248" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695350', this.value);">我是帅新郎的{亲戚|朋友|同学|同事}</textarea>

            
            
            </div> 

            <div id="s8695351">
            
            <!--<img src="./image/del.png" onclick="delRow('q2772248','s8695351');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o2772248" size="24" value="我是俏新娘的{亲戚|朋友|同学|同事}" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('8695351', this.value);">-->
            
              
                <img src="./image/del.png" onclick="delRow('q2772248','s8695351');" style="cursor:pointer;" vspace="5" hspace="5" align="top">
                          
                <!--<input type="text" name="o2772248" size="48" value="我是俏新娘的{亲戚|朋友|同学|同事}" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695351', this.value);">-->
                <textarea name="o2772248" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695351', this.value);">我是俏新娘的{亲戚|朋友|同学|同事}</textarea>

            
            
            </div> 

            <div id="s8695352">
            
            <!--<img src="./image/del.png" onclick="delRow('q2772248','s8695352');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o2772248" size="24" value="其他:{}" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('8695352', this.value);">-->
            
              
                <img src="./image/del.png" onclick="delRow('q2772248','s8695352');" style="cursor:pointer;" vspace="5" hspace="5" align="top">
                          
                <!--<input type="text" name="o2772248" size="48" value="其他:{}" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695352', this.value);">-->
                <textarea name="o2772248" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695352', this.value);">其他:{}</textarea>

            
            
            </div> 

                       
     </div>
     
     
     <img src="./image/add.png" onclick="javascript: addRow('q2772248');" style="cursor: pointer;" vspace="5" hspace="5" align="absmiddle">
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772248" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772249">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772249">
      <input type="hidden" name="answertype" value="1">
      <input type="hidden" name="switch_status" value="0">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772249', this.checked, 3);" value="2772249" >
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="需要为您准备素食吗？" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772249', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772249', this.value);">需要为您准备素食吗？</textarea>
         <br/>
     
     <div id="q2772249"> 


            <div id="s8695353">
            
            <!--<img src="./image/del.png" onclick="delRow('q2772249','s8695353');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o2772249" size="20" value="是的，我需要{1-10}份" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('8695353', this.value);">-->
            
              
                <img src="./image/del.png" onclick="delRow('q2772249','s8695353');" style="cursor:pointer;" vspace="5" hspace="5" align="top">
                          
                <!--<input type="text" name="o2772249" size="48" value="是的，我需要{1-10}份" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695353', this.value);">-->
                <textarea name="o2772249" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695353', this.value);">是的，我需要{1-10}份</textarea>

            
            
            </div> 

            <div id="s8695354">
            
            <!--<img src="./image/del.png" onclick="delRow('q2772249','s8695354');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o2772249" size="20" value="谢谢，不需要" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('8695354', this.value);">-->
            
              
                <img src="./image/del.png" onclick="delRow('q2772249','s8695354');" style="cursor:pointer;" vspace="5" hspace="5" align="top">
                          
                <!--<input type="text" name="o2772249" size="48" value="谢谢，不需要" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695354', this.value);">-->
                <textarea name="o2772249" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695354', this.value);">谢谢，不需要</textarea>

            
            
            </div> 

                       
     </div>
     
     
     <img src="./image/add.png" onclick="javascript: addRow('q2772249');" style="cursor: pointer;" vspace="5" hspace="5" align="absmiddle">
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772249" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772250">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772250">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="1">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772250', this.checked, 4);" value="2772250"  checked>
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="若您需要我们寄送纸本喜帖，请填写地址" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772250', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772250', this.value);">若您需要我们寄送纸本喜帖，请填写地址</textarea>
         <br/>
     
     <div id="q2772250"> 


     <!--<input type="text" name="t2772250" value="" size="26">-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772250" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772251">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772251">
      <input type="hidden" name="answertype" value="1">
      <input type="hidden" name="switch_status" value="0">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772251', this.checked, 5);" value="2772251" >
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="我们会提供游览车从台中出发，您需要座位吗?" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772251', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772251', this.value);">我们会提供游览车从台中出发，您需要座位吗?</textarea>
         <br/>
     
     <div id="q2772251"> 


            <div id="s8695355">
            
            <!--<img src="./image/del.png" onclick="delRow('q2772251','s8695355');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o2772251" size="42" value="请提供{1-10}个" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('8695355', this.value);">-->
            
              
                <img src="./image/del.png" onclick="delRow('q2772251','s8695355');" style="cursor:pointer;" vspace="5" hspace="5" align="top">
                          
                <!--<input type="text" name="o2772251" size="48" value="请提供{1-10}个" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695355', this.value);">-->
                <textarea name="o2772251" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695355', this.value);">请提供{1-10}个</textarea>

            
            
            </div> 

            <div id="s8695356">
            
            <!--<img src="./image/del.png" onclick="delRow('q2772251','s8695356');" style="cursor:pointer;" vspace="5" hspace="5" align="absmiddle"><input type="text" name="o2772251" size="42" value="不需要" class="showText" onmouseover="javascript: this.className='showInput';this.size=20;this.focus();"  onfocus="javascript: this.className='showInput';this.size=20;" onblur="javascript: this.className='showText';this.size=this.value.length*2;" onkeyup="setOptionTitle('8695356', this.value);">-->
            
              
                <img src="./image/del.png" onclick="delRow('q2772251','s8695356');" style="cursor:pointer;" vspace="5" hspace="5" align="top">
                          
                <!--<input type="text" name="o2772251" size="48" value="不需要" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695356', this.value);">-->
                <textarea name="o2772251" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setOptionTitle('8695356', this.value);">不需要</textarea>

            
            
            </div> 

                       
     </div>
     
     
     <img src="./image/add.png" onclick="javascript: addRow('q2772251');" style="cursor: pointer;" vspace="5" hspace="5" align="absmiddle">
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772251" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772252">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772252">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="1">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772252', this.checked, 6);" value="2772252"  checked>
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="请留下您的手机号码" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772252', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772252', this.value);">请留下您的手机号码</textarea>
         <br/>
     
     <div id="q2772252"> 


     <!--<input type="text" name="t2772252" value="" size="26">-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772252" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772253">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772253">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="0">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772253', this.checked, 7);" value="2772253" >
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="请留下您的email" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772253', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772253', this.value);">请留下您的email</textarea>
         <br/>
     
     <div id="q2772253"> 


     <!--<input type="text" name="t2772253" value="" size="26">-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772253" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772254">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772254">
      <input type="hidden" name="answertype" value="3">
      <input type="hidden" name="switch_status" value="1">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772254', this.checked, 8);" value="2772254"  checked>
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="请留下您对我们的祝福，衷心感谢您" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772254', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772254', this.value);">请留下您对我们的祝福，衷心感谢您</textarea>
         <br/>
     
     <div id="q2772254"> 


     <!--<textarea name="t2772254" cols="20" rows="6"></textarea>-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772254" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772255">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772255">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="0">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772255', this.checked, 9);" value="2772255" >
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="备用问题1" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772255', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772255', this.value);">备用问题1</textarea>
         <br/>
     
     <div id="q2772255"> 


     <!--<input type="text" name="t2772255" value="" size="26">-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772255" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772256">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772256">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="0">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772256', this.checked, 10);" value="2772256" >
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="备用问题2" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772256', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772256', this.value);">备用问题2</textarea>
         <br/>
     
     <div id="q2772256"> 


     <!--<input type="text" name="t2772256" value="" size="26">-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772256" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772257">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772257">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="0">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772257', this.checked, 11);" value="2772257" >
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="备用问题3" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772257', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772257', this.value);">备用问题3</textarea>
         <br/>
     
     <div id="q2772257"> 


     <!--<input type="text" name="t2772257" value="" size="26">-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772257" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772258">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772258">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="0">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772258', this.checked, 12);" value="2772258" >
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="备用问题4" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772258', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772258', this.value);">备用问题4</textarea>
         <br/>
     
     <div id="q2772258"> 


     <!--<input type="text" name="t2772258" value="" size="26">-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772258" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

  <li id="ta2772259">
  
<table width="100%" cellpadding="3" cellspacing="1" border="0">
 <tr>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="hidden" name="questionid" value="2772259">
      <input type="hidden" name="answertype" value="2">
      <input type="hidden" name="switch_status" value="0">
      
           
      <input type="checkbox" name="status" onclick="showQuestion('q2772259', this.checked, 13);" value="2772259" >
      <span></span>
     </td>
     <td width="84%" height="30" valign="top" bgcolor="#ffffff">
      
      
         
          <!--<input type="text" name="qq" value="备用问题5" size="52" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772259', this.value);">-->
          <textarea name="qq" cols="45" rows="1" class="showText" onfocus="javascript: this.className='showInput';" onblur="javascript: this.className='showText';" onkeyup="setQuestionTitle('2772259', this.value);">备用问题5</textarea>
         <br/>
     
     <div id="q2772259"> 


     <!--<input type="text" name="t2772259" value="" size="26">-->

                       
     </div>
     
     

     </td>
     <td width="8%" height="30" align="center" valign="top" bgcolor="#ffffff">
      <input type="checkbox" name="bshowbless2772259" value="1" >
     
     </td>     
 </tr>
</table> 

</li>

 

</ul>


			


	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270343">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270343" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="4" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270343" type="checkbox" id="bshow2270343" value="0"  /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270343').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270343").attr("disabled",true);
					$("#invite_detail_name2270343").addClass("tab_name_hide");


					bshow2270343 = 0
					$('#iframepage').contents().find("#invite_detail_title2270343").hide();
					$('#iframepage').contents().find("#invite_detail_content2270343").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270343").attr("disabled",false);
					$("#invite_detail_name2270343").removeClass("tab_name_hide");
					bshow2270343 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270343").show();
					$('#iframepage').contents().find("#invite_detail_content2270343").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>


  <div class="ui-widget">
  <span id="use_google_map2270343"><span style="color:#C6593D" > 使用下方的电子地图定位，或</span><input id="select_map2270343" name="select_map2270343" type="button" value="选择上传地图" /><br></span><input id="remove_map2270343" name="remove_map2270343" type="button"  value="移除地图重新选择" />
  </div>
  
    <input type="hidden" name="invite_detail_latmarker2270343" id="invite_detail_latmarker2270343"  value="40.007474">
    <input type="hidden" name="invite_detail_lngmarker2270343" id="invite_detail_lngmarker2270343" value="116.397859">
    <input type="hidden" name="invite_detail_latcenter2270343" id="invite_detail_latcenter2270343" value="40.007474">
    <input type="hidden" name="invite_detail_lngcenter2270343" id="invite_detail_lngcenter2270343" value="116.397859">
    <input type="hidden" name="invite_detail_zoom2270343" id="invite_detail_zoom2270343" value="16">
    <input type="hidden" name="invite_detail_mapimgurl2270343" id="invite_detail_mapimgurl2270343" value="">

    <table width="100%" border="0">
      <tr>
        <td valign="top">

    <img id="invite_detail_mapimg2270343" style="width:240px; border:thin; border-style:solid; border-color:#999;" src="" width="240" align="top"/>    
    
     <div id="invite_detail_googlemap2270343">   
        <input name="address2270343" type="text" id="address2270343" title="请填写详细省市城镇街道门牌地址" value="" size="24" />
        <input type="button" id="button_setmap2270343" value="定位"  />
        <br>
        <div id="map_canvas2270343" style="width:240px; height:300px; border:thin; border-style:solid; border-color:#999; margin-bottom:5px;"></div>
        
     </div>   
        </td>
        <td valign="top">
    交通指引说明:<br>
	<textarea name="invite_detail_mapdesc2270343" id="invite_detail_mapdesc2270343" cols="32" rows="10">奥雅婚礼园(北京奥雅会展中心)
地址：北京市朝阳区天辰东路2号

路线1:
驾车走北四环(自东向西), 通过五洲大酒店后进入北四环中路辅路, 到达北辰东路后右拐;
1)沿北辰东路行驶1.6公里，到达大屯路后，左拐;
2)沿大屯路直行(向西)约800米右拐，(和保安说明参加婚礼)进入天辰东路100米即到;

路线2:
驾车走北四环(自东向西), 通过五洲大酒店后进入北四环中路辅路, 到达北辰西路后右拐;
1) 沿北辰西路行驶1.8公里，到达大屯北路后, 右拐;
2) 沿大屯北路直行(向东)280米右拐, (和保安说明参加婚礼)进入天辰东路100米即到;
在路两侧停车均可

地铁:
坐地铁8号线(朱辛庄方向),在奥林匹克公园站下车(F口出), 步行720米至北京奥雅会展中心</textarea>
    <div style=" margin-top:60px;">
    电子地图编辑帮助:<br>←地图定位: 上方填入完整地址後点击定位<br>←调整大小: 点击左上角[+][-]按钮<br>←移动图面: 以鼠标拖放移动地图<br>←移动地标: 以鼠标拖放移动红心
    </div>
        </td>
      </tr>
    </table>


	 <script language="javascript">
    $(document).ready(function() { 
		$('#button_setmap2270343').click(function() {
		  codeAddress2270343($('#address2270343').val());
		});

		$("#invite_detail_mapdesc2270343").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#map_desc2270343").html($(this).val().ReplaceAll('\r\n','\n').ReplaceAll('\n','<br>')); 
			//setHiddenHtml('remindtitle');
		});
		//$("#remindtitle").bind('focus',function (){
	  // $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
		//});
	
		
		
	//	console.log("mapurl="+$("#invite_detail_mapimgurl2270343").val()); 

		if ($("#invite_detail_mapimgurl2270343").val() == '') {
			$("#invite_detail_mapimg2270343").hide();
			$("#invite_detail_googlemap2270343").show();
			//$("#remove_map2270343").attr("disabled", true);
			$("#remove_map2270343").hide();
			$("#use_google_map2270343").show();
			
		} else {
			$("#invite_detail_mapimg2270343").show();
			$("#invite_detail_googlemap2270343").hide();
			//$("#remove_map2270343").attr("disabled", false);
			$("#remove_map2270343").show();
			$("#use_google_map2270343").hide();
	}
		
		
		
		$("#select_map2270343").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			//var page = 'mobile_invite_select_map_detail_plu_leo.asp?invite_detail_id=2270343';
			var page = 'mobile_invite_select_map_detail_plu_s3oss.asp?invite_detail_id=2270343';
			var pagetitle = '请上传或选择图片作为地图';
			$dialog_photo = $('<div></div>')
			.html('<iframe frameborder="0" border="0" cellspacing="0" style="border: none; " src="' + page + '" width="100%" height="100%"></iframe>')
			.dialog({
				position: {my: "center", at: "top", of: document},
				autoOpen: false,
				modal: false,
				//position: "right",
				height: 610,
				width: 580,
				title: pagetitle,
				buttons: [{
					text: '关闭',
					"class": 'closeButtonClass',
					click: function() {
                         $( this ).dialog( "close" );
					}
				}]
			});
			$dialog_photo.dialog('open');




			//$('#title_editor').elrte('val', $('#iframepage').contents().find("#title").html() );
			//$('#title_editor').elrte('updateSource');
		});

		$("#remove_map2270343").bind('click', function (e) {

			$("#iframepage").contents().find('#invite_detail_mapimg2270343').hide();
			$("#iframepage").contents().find('#map_canvas2270343').show();
			$("#iframepage").contents().find('#map_direction2270343').show();
			
			
			$("#iframepage").contents().find('#invite_detail_mapimg2270343').attr('src', '');
			$("#iframepage").contents().find('#invite_detail_mapimgurl2270343').val('');

			if ($('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active") != $("#tabs").tabs( "option", "selected" ) ) {

				$('#iframepage').get(0).contentWindow.$("#accordion").accordion("activate",$("#tabs").tabs( "option", "selected" ));
			}
			$('#iframepage').get(0).contentWindow.initialize2270343();
		
			
			
			
			
			$("#invite_detail_mapimg2270343").hide();
			$("#invite_detail_googlemap2270343").show();
			$("#invite_detail_mapimg2270343").attr('src', '');
			$("#invite_detail_mapimgurl2270343").val('');
			//$("#remove_map2270343").attr("disabled", true);
			$("#remove_map2270343").hide();
			$("#use_google_map2270343").show();
			initialize2270343();

			//alert("移除MV视频完成");

			
		});



    });		
    </script>		



	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270344">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270344" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="6" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270344" type="checkbox" id="bshow2270344" value="0"  /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270344').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270344").attr("disabled",true);
					$("#invite_detail_name2270344").addClass("tab_name_hide");


					bshow2270344 = 0
					$('#iframepage').contents().find("#invite_detail_title2270344").hide();
					$('#iframepage').contents().find("#invite_detail_content2270344").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270344").attr("disabled",false);
					$("#invite_detail_name2270344").removeClass("tab_name_hide");
					bshow2270344 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270344").show();
					$('#iframepage').contents().find("#invite_detail_content2270344").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>

	<div style="color:#C6593D" > 设置倒数计时及自动提醒短信,短信由系统自动发送</div><br>

				<script>

				
                $(function() {

					$.datepicker.regional['en-UK'] = {
						closeText: 'Done',
						prevText: 'Prev',
						nextText: 'Next',
						currentText: 'Today',
						monthNames: ['January','February','March','April','May','June',
						'July','August','September','October','November','December'],
						monthNamesShort: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
						'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
						dayNames: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],
						dayNamesShort: ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],
						dayNamesMin: ['Su','Mo','Tu','We','Th','Fr','Sa'],
						weekHeader: 'Wk',
						dateFormat: 'yy/mm/dd',
						firstDay: 1,
						isRTL: false,
						showMonthAfterYear: false,
						yearSuffix: ''};
					
					$.datepicker.regional['zh-TW'] = {
						closeText: 'P]',
						prevText: '&#x3c;上月',
						nextText: '下月&#x3e;',
						currentText: '今天',
						monthNames: ['一月','二月','三月','四月','五月','六月',
						'七月','八月','九月','十月','十一月','十二月'],
						monthNamesShort: ['一','二','三','四','五','六',
						'七','八','九','十','十一','十二'],
						dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
						dayNamesShort: ['周日','周一','周二','周三','周四','周五','周六'],
						dayNamesMin: ['日','一','二','三','四','五','六'],
						weekHeader: '周',
						dateFormat: 'yy/mm/dd',
						firstDay: 1,
						isRTL: false,
						showMonthAfterYear: true,
						yearSuffix: '年'};

					$.datepicker.regional['zh-CN'] = {
						closeText: '关闭',
						prevText: '&#x3c;上月',
						nextText: '下月&#x3e;',
						currentText: '今天',
						monthNames: ['一月','二月','三月','四月','五月','六月',
						'七月','八月','九月','十月','十一月','十二月'],
						monthNamesShort: ['一','二','三','四','五','六',
						'七','八','九','十','十一','十二'],
						dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
						dayNamesShort: ['周日','周一','周二','周三','周四','周五','周六'],
						dayNamesMin: ['日','一','二','三','四','五','六'],
						weekHeader: '周',
						dateFormat: 'yy-mm-dd',
						firstDay: 1,
						isRTL: false,
						showMonthAfterYear: true,
						yearSuffix: '年'};
						
/* Japanese initialisation for the jQuery UI date picker plugin. */
/* Written by Kentaro SATO (kentaro@ranvis.com). */
        $.datepicker.regional['ja'] = {
                closeText: ']じる',
                prevText: '&#x3c;前',
                nextText: '次&#x3e;',
                currentText: '今日',
                monthNames: ['1月','2月','3月','4月','5月','6月',
                '7月','8月','9月','10月','11月','12月'],
                monthNamesShort: ['1月','2月','3月','4月','5月','6月',
                '7月','8月','9月','10月','11月','12月'],
                dayNames: ['日曜日','月曜日','火曜日','水曜日','木曜日','金曜日','土曜日'],
                dayNamesShort: ['日','月','火','水','木','金','土'],
                dayNamesMin: ['日','月','火','水','木','金','土'],
                weekHeader: 'L',
                dateFormat: 'yy/mm/dd',
                firstDay: 0,
                isRTL: false,
                showMonthAfterYear: true,
                yearSuffix: '年'};
						
/*
                    $( "#reminddate" ).datepicker({
						//changeMonth: true,
						//changeYear: true,
						closeText: 'P]',
						prevText: '&#x3c;上月',
						nextText: '下月&#x3e;',
						currentText: '今天',
						monthNames: ['一月','二月','三月','四月','五月','六月',
						'七月','八月','九月','十月','十一月','十二月'],
						monthNamesShort: ['一','二','三','四','五','六',
						'七','八','九','十','十一','十二'],
						dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
						dayNamesShort: ['周日','周一','周二','周三','周四','周五','周六'],
						dayNamesMin: ['日','一','二','三','四','五','六'],
						weekHeader: '周',
						dateFormat: 'yy/mm/dd',
						firstDay: 1,
						isRTL: false,
						showMonthAfterYear: true,
						yearSuffix: '年'
                    });
*/					
					$( "#reminddate" ).datepicker( $.datepicker.regional[ 'zh-CN' ] );
					$( "#countdowndate" ).datepicker( $.datepicker.regional[ 'zh-CN' ]).
					datepicker("option",{
							onSelect: function(dateText, inst) { 
								var date = $(this).datepicker('getDate'),
									day  = date.getDate(),  
									month = date.getMonth(),              
									year =  date.getFullYear();
									$('#iframepage').get(0).contentWindow.countdown_yy = year;
									$('#iframepage').get(0).contentWindow.countdown_mm = month;
									$('#iframepage').get(0).contentWindow.countdown_dd = day;
									$('#iframepage').get(0).contentWindow.CountDownTimer('countdown');
									
								//alert(day + '-' + month + '-' + year);
							}
					});
						
						
					$("#countdownhour").bind('change keydown keyup paste input propertychange',function (){
						$('#iframepage').get(0).contentWindow.countdown_hh = $(this).val();
						$('#iframepage').get(0).contentWindow.CountDownTimer('countdown');
					});
						
					$("#countdownminute").bind('change keydown keyup paste input propertychange',function (){
						$('#iframepage').get(0).contentWindow.countdown_mn = $(this).val();
						$('#iframepage').get(0).contentWindow.CountDownTimer('countdown');
					});
						
                }); //$(function()




                </script>    
<table width="100%" cellpadding="0" cellspacing="0" border="0">
 <tr><td width="23%" height="30" valign="top" bgcolor="#ffffff">倒数计时提示文字</td>
     <td width="77%" height="30" valign="top" bgcolor="#ffffff">
<textarea name="countdowntitle" id="countdowntitle" cols="40" rows="2" style="font-family:微软正黑体,Microsoft JhengHei,Microsoft YaHei,verdana;font-size:9pt;">距离开始时间还有</textarea>     

	 </td>
  </tr>
 <tr>
    <td width="23%" height="30" valign="top" bgcolor="#ffffff">倒数计时设定</td>
    <td width="77%" height="30" valign="top" bgcolor="#ffffff">
    <input type="text"  id="countdowndate" name="countdowndate" value="2015-5-2"  size="15" />

    <input type="text" id="countdownhour" name="countdownhour" value="10"  size="4" /> 时

    <input type="text" id="countdownminute" name="countdownminute" value="18"  size="4" /> 分
<BR>
<BR>
    
             
    </td>
 </tr>
 <tr><td width="23%" height="30" valign="top" bgcolor="#ffffff">提示说明文字</td>
     <td width="77%" height="30" valign="top" bgcolor="#ffffff">
<textarea name="remindtitle" id="remindtitle" cols="40" rows="3" style="font-family:微软正黑体,Microsoft JhengHei,Microsoft YaHei,verdana;font-size:9pt;">亲爱的各位亲友，输入您的姓名与手机号码， 婚宴前，我们会有贴心的手机短信提醒</textarea>     

	 </td>
  </tr>
 <tr>
    <td width="23%" height="30" valign="top" bgcolor="#ffffff">短信发送时间</td>
    <td width="77%" height="30" valign="top" bgcolor="#ffffff">
    <input type="text" readonly='true' id="reminddate" name="reminddate" value="2015-4-30"  size="15" />

    
    <select id="remindtime" name="remindtime">
      
      <option value="00" >00</option>
      
      <option value="01" >01</option>
      
      <option value="02" >02</option>
      
      <option value="03" >03</option>
      
      <option value="04" >04</option>
      
      <option value="05" >05</option>
      
      <option value="06" >06</option>
      
      <option value="07" >07</option>
      
      <option value="08" >08</option>
      
      <option value="09" >09</option>
      
      <option value="10" >10</option>
      
      <option value="11" >11</option>
      
      <option value="12" >12</option>
      
      <option value="13" >13</option>
      
      <option value="14" selected>14</option>
      
      <option value="15" >15</option>
      
      <option value="16" >16</option>
      
      <option value="17" >17</option>
      
      <option value="18" >18</option>
      
      <option value="19" >19</option>
      
      <option value="20" >20</option>
      
      <option value="21" >21</option>
      
      <option value="22" >22</option>
      
      <option value="23" >23</option>
      
    </select> : 00
    
             
    </td>
 </tr>
 <tr>
    <td width="23%" height="30" valign="top" bgcolor="#ffffff">短信发送内容</td>
    <td width="77%" height="30" valign="top" bgcolor="#ffffff"><textarea name="remindmsg" id="remindmsg" cols="40" rows="5" onkeyup="javascript: countWords();" style="font-family:微软正黑体,Microsoft JhengHei,Microsoft YaHei,verdana;font-size:9pt;">尹盛与曹锐怡将于2015年05月02日10时18分在奥雅婚礼园(北京奥雅会展中心)举行婚宴，地址:北京市朝阳区天辰东路2号，期待您的到来！</textarea>
      
      <br/>可以输入<span id="limitcount">70</span>个字，已输入<span id="keycount">0</span>个字。
      </td>
 </tr>

</table>
 <script>
$(document).ready(function() { 
		
		$("#remindtitle").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#remindtitle").find("span:eq(0)").html($(this).val().ReplaceAll('\r\n','\n').ReplaceAll('\n','<br>')); 
			//setHiddenHtml('remindtitle');
		});
		//$("#remindtitle").bind('focus',function (){
	  // $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
		//});

		$("#countdowntitle").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#countdowntitle").find("span:eq(0)").html($(this).val().ReplaceAll('\r\n','\n').ReplaceAll('\n','<br>')); 
			//setHiddenHtml('remindtitle');
		});


});		
</script>		





	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270345">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270345" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="5" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270345" type="checkbox" id="bshow2270345" value="0" checked="checked" /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$("#invite_detail_name2270345").addClass("tab_name_hide");
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270345').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270345").attr("disabled",true);
					$("#invite_detail_name2270345").addClass("tab_name_hide");


					bshow2270345 = 0
					$('#iframepage').contents().find("#invite_detail_title2270345").hide();
					$('#iframepage').contents().find("#invite_detail_content2270345").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270345").attr("disabled",false);
					$("#invite_detail_name2270345").removeClass("tab_name_hide");
					bshow2270345 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270345").show();
					$('#iframepage').contents().find("#invite_detail_content2270345").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>

<div style="color:#C6593D" > 当手机打开请帖时，<br><br>会在本子页配置分享按钮，<br><br>可点击按钮后转发分享请帖<br><br><br><br><br><br></div>
<br>
<input id="bs0" name="bshow_share" type="hidden" value="0" />
<input id="bs1"  name="bshow_share" type="hidden" value="0" />
<input id="bs2"  name="bshow_share" type="hidden" value="0" />
<input id="bs3"  name="bshow_share" type="hidden" value="0" />


	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270346">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270346" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="1" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270346" type="checkbox" id="bshow2270346" value="0" checked="checked" /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$("#invite_detail_name2270346").addClass("tab_name_hide");
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270346').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270346").attr("disabled",true);
					$("#invite_detail_name2270346").addClass("tab_name_hide");


					bshow2270346 = 0
					$('#iframepage').contents().find("#invite_detail_title2270346").hide();
					$('#iframepage').contents().find("#invite_detail_content2270346").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270346").attr("disabled",false);
					$("#invite_detail_name2270346").removeClass("tab_name_hide");
					bshow2270346 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270346").show();
					$('#iframepage').contents().find("#invite_detail_content2270346").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>

        	<input type="hidden" name="invite_detail_fontindex2270346" id="invite_detail_fontindex2270346" value="0">
			<div style="color:#C6593D" ><img src="images/info.gif" width="16" height="15" /> 修改文字后,请点击工具列左侧 <img src="ckeditor/plugins/reloadwebfont/reload2.png" width="10" height="10" /> 按钮刷新。编辑时如需要上下行对齐文字请使用全角空格</div>
			<br>
			<textarea id="invite_detail_editor2270346" name="invite_detail_editor2270346"><p style="text-align: center;"><span style="font-size: 18px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">那一年，我们偶然相遇</span></span></p>

<p style="text-align: center;"><span style="font-size: 18px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">没想到世界这么大</span></span></p>

<p style="text-align: center;"><span style="font-size: 18px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">两颗小小的心却从此被系在一起</span></span></p>

<p style="text-align: center;"><span style="font-size: 18px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">我们看到彼此的好</span></span></p>

<p style="text-align: center;"><span style="font-size: 18px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">也看到彼此对自己的重要</span></span></p>

<p style="text-align: center;"><span style="font-size: 18px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">在这个美丽的日子</span></span></p>

<p style="text-align: center;"><span style="font-size: 18px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">我们决定让幸福延续</span></span></p>

<p style="text-align: center;"><span style="font-size: 18px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">期望快乐的回忆里，有您的参与</span></span></p>

<p style="text-align: right;">&nbsp;</p>

<p style="text-align: right;"><span style="font-size: 18px;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;">{新郎}与{新娘}敬邀</span></span></p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<fieldset style="margin: 0px; padding: 7px; border: 1px solid rgb(204, 204, 204); max-width: 100%; background-color: rgb(250, 250, 240); border-image: none;"><legend style="margin: 0px; padding: 0px; text-align: right; color: rgb(0, 0, 0); max-width: 100%;"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 14px;"><strong><span style="color: rgb(255, 255, 255);"><span style="padding: 2px 10px; border-radius: 4px; max-width: 100%; background-color: rgb(153, 3, 3);">男方婚宴</span></span></strong></span></span></legend>

<table border="0" cellpadding="1" cellspacing="1" style="width: 100%;">
	<tbody>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">日期：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{宴客日期}</span></span></span></td>
		</tr>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">时间：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{宴客时间}</span></span></span></td>
		</tr>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">地点：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{场所名称}</span></span></span></td>
		</tr>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">地址：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{场所地址}</span></span></span></td>
		</tr>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">电话：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{联络电话}</span></span></span></td>
		</tr>
	</tbody>
</table>
</fieldset>

<p>&nbsp;</p>

<fieldset style="margin: 0px; padding: 7px; border: 1px solid rgb(204, 204, 204); max-width: 100%; background-color: rgb(250, 250, 240); border-image: none;"><legend style="margin: 0px; padding: 0px; text-align: right; color: rgb(0, 0, 0); max-width: 100%;"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 14px;"><strong><span style="color: rgb(255, 255, 255);"><span style="padding: 2px 10px; border-radius: 4px; max-width: 100%; background-color: rgb(153, 3, 3);">女方婚宴</span></span></strong></span></span></legend>

<table border="0" cellpadding="1" cellspacing="1" style="width: 100%; background-color: rgb(250, 250, 240);">
	<tbody>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">日期：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{宴客日期}</span></span></span></td>
		</tr>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">时间：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{宴客时间}</span></span></span></td>
		</tr>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">地点：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{场所名称}</span></span></span></td>
		</tr>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">地址：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{场所地址}</span></span></span></td>
		</tr>
		<tr>
			<td style="width: 48px; text-align: right; vertical-align: top; white-space: nowrap;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">电话：</span></span></span></td>
			<td style="vertical-align: top;"><span style="color: rgb(178, 34, 34);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">{联络电话}</span></span></span></td>
		</tr>
	</tbody>
</table>
</fieldset>

<p>&nbsp;</p>
</textarea>
			<script type="text/javascript">
			//no use now			
			function striphtml(html)
			{
			   var tmp = document.createElement("DIV");
			   tmp.innerHTML = html;
			   return tmp.textContent||tmp.innerText;
			}			


			//?建求XMLHttpRequest?象
			function createRequest() {
				try {
					request = new XMLHttpRequest();
				} catch (trymicrosoft) {
					try {
						request = new ActiveXObject("Msxml2.XMLHTTP");
					} catch (othermicrosoft) {
						try {
							request = new ActiveXObject("Microsoft.XMLHTTP");
						} catch (failed) {
							request = false;
						}
					}
				}
				if (!request)
					alert("ERROR XMLHttpRequest!");
			}
			
			
			
			var ck_editor2270346;
			var contentcss_array =new Array();


			var webfontinfo_array = ['粗钢笔|粗钢笔1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E9%92%A2%E7%AC%941&font=%E7%B2%97%E9%92%A2%E7%AC%94|2','粗圆|粗圆1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E5%9C%861&font=%E7%B2%97%E5%9C%86|2','古印体|古印体1|http://42.121.32.43:443/Fonts/csslink?family=%E5%8F%A4%E5%8D%B0%E4%BD%931&font=%E5%8F%A4%E5%8D%B0%E4%BD%93|2','黑体|黑体1|http://42.121.32.43:443/Fonts/csslink?family=%E9%BB%91%E4%BD%931&font=%E9%BB%91%E4%BD%93|2','粗广告体|粗广告体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%931&font=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%93|2','隶书|隶书1|http://42.121.32.43:443/Fonts/csslink?family=%E9%9A%B6%E4%B9%A61&font=%E9%9A%B6%E4%B9%A6|2','书宋二|书宋二1|http://42.121.32.43:443/Fonts/csslink?family=%E4%B9%A6%E5%AE%8B%E4%BA%8C1&font=%E4%B9%A6%E5%AE%8B%E4%BA%8C|2','中行书|中行书1|http://42.121.32.43:443/Fonts/csslink?family=%E4%B8%AD%E8%A1%8C%E4%B9%A61&font=%E4%B8%AD%E8%A1%8C%E4%B9%A6|2','粗行楷体|粗行楷体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%931&font=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%93|2','甜妞体|甜妞体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%94%9C%E5%A6%9E%E4%BD%931&font=%E7%94%9C%E5%A6%9E%E4%BD%93|2'];
			var webfontnum = 10;


	        $(function() { //jquery functiom


			function   familyParser(text) {
				var familyArray = [];
				var textArray = [] ;
				var tagArray = [];
				var parser = new CKEDITOR.htmlParser();
				var font = null;
			
				parser.onText = function (text) {
					if (font == null) return;
					var indexS = font.indexOf('font-family:');
					var indexE1 = font.indexOf(',', indexS); // -1 , n
					var indexE2 = font.indexOf(';', indexS); // -1 , n
					if (indexE1 == -1 )
						indexE1 = font.length;
					if (indexE2 == -1 )
						indexE2 = font.length;
					indexE = Math.min(indexE1,indexE2);
					
					
					
					var fontName = font.substring(indexS + 12, indexE).trim().ReplaceAll("'", "").ReplaceAll('"', '');
					var bFound = false;
					for (var i = familyArray.length - 1; i >= 0; i--) {
						if (familyArray[i].localeCompare(fontName) == 0) {
							textArray[i] += text;
							bFound = true;
							break;
						}
					}
			
					if (bFound == false) {
						familyArray.push(fontName);
						textArray.push(text);
					}
				}
			
				parser.onTagClose = function (tagName) {
					tag = tagArray.pop();
					if (tag == null) return;
					if (tag.indexOf("font-family") != -1) {
						for (i = tagArray.length - 1; i >= 0; i--) {
							if (tagArray[i] == null) continue;
							if (tagArray[i].indexOf("font-family") != -1) {
								font = tagArray[i];
								return;
							}
						}
					}
					//font = null;
				}
			
				parser.onTagOpen = function (tagName, attributes, selfClosing) {
					if ((attributes == null) || (attributes.style == null)) {
						tagArray.push(null);
						return;
					}
			
					tagArray.push(attributes.style);
					if (attributes.style.indexOf("font-family") != -1) {
						font = attributes.style;
					}
			
				};
			
				parser.parse(text);
				parser = null;
				return {family:familyArray, text:textArray};
			}

			CKEDITOR.on('instanceReady', function(e) {
				
				e.editor.dataProcessor.htmlFilter.addRules(
					{
						elements:
						{
							$: function (element) {
								// Output dimensions of images as width and height
								if (element.name == 'img') {
									var style = element.attributes.style;
			
									if (style) {
										// Get the width from the style.
										var match = /(?:^|\s)width\s*:\s*(\d+)px/i.exec(style),
											width = match && match[1];
			
										// Get the height from the style.
										match = /(?:^|\s)height\s*:\s*(\d+)px/i.exec(style);
										var height = match && match[1];
			
										if (width) {
											element.attributes.style = element.attributes.style.replace(/(?:^|\s)width\s*:\s*(\d+)px;?/i, '');
											element.attributes.width = width;
										}
			
										if (height) {
											element.attributes.style = element.attributes.style.replace(/(?:^|\s)height\s*:\s*(\d+)px;?/i, '');
											element.attributes.height = height;
										}
									}
								}
			
			
			
								if (!element.attributes.style)
									delete element.attributes.style;
			
								return element;
							}
						}
					});


				//e.editor.execCommand( 'reloadWebFont');
								
			}); //CKEDITOR.on('instanceReady', function(e) 



			CKEDITOR.on( 'dialogDefinition', function( ev )
			{
			  // Take the dialog name and its definition from the event data.
			  var dialogName = ev.data.name;
			  var dialogDefinition = ev.data.definition;
			
			  // Check if the definition is from the dialog we're
			  // interested in (the 'image' dialog). This dialog name found using DevTools plugin



			  if ( dialogName == 'image' )
			  {

				 // Remove the 'Link' and 'Advanced' tabs from the 'Image' dialog.
				 dialogDefinition.removeContents( 'Link' );
				 dialogDefinition.removeContents( 'advanced' );
			
				 // Get a reference to the 'Image Info' tab.
				 var infoTab = dialogDefinition.getContents( 'info' );
			
				 // Remove unnecessary widgets/elements from the 'Image Info' tab.         
				 infoTab.remove( 'txtHSpace');
				 infoTab.remove( 'txtVSpace');
				 infoTab.remove( 'txtBorder' );
				 infoTab.remove( 'txtAlt' );
				 infoTab.remove( 'txtWidth' );
				 infoTab.remove( 'txtHeight' );
				 infoTab.remove( 'ratioLock' );
				 //infoTab.remove( 'htmlPreview' );
				 
				dialogDefinition.onSelect = function()
				{
					alert("onfocus");
					//var urlField = this.getContentElement( 'info', 'url' );
					//urlField.select();
				};
				  
			  }

			  
			  if ( dialogName == 'link' )
			  {
				// Remove the "Target" tab from the "Link" dialog.


				// Get a reference to the "Target" tab and set default to '_blank'
				/*
				var targetTab = dialogDefinition.getContents('target');
				var targetField = targetTab.get('linkTargetType');
				targetField['default'] = '_blank';
				*/
				/*
				var advTab =  dialogDefinition.getContents( 'advanced' );
				var cssField = advTab.get( 'advCSSClasses' );
				cssField['default'] = 'inviteTextLinkClass';
				*/
				
				var infoTab = dialogDefinition.getContents( 'info' );
				// Set the default value for the URL field.
				var urlField = infoTab.get( 'url' );
				urlField['default'] = 'www.example.com';
			
			
			
				// Rewrite the 'onFocus' handler to always focus 'url' field.
				dialogDefinition.onFocus = function()
				{
					var urlField = this.getContentElement( 'info', 'url' );
					urlField.select();
				};



				dialogDefinition.removeContents( 'target' );
				dialogDefinition.removeContents( 'advanced' );
				// Get a reference to the "Link Info" tab.
			
			
				// Remove the "Link Type" combo and the "Browser
				// Server" button from the "info" tab.
				infoTab.remove( 'linkType' );
				infoTab.remove( 'browse' );

			
			  }
			  
			  
			  
			});
			
			CKEDITOR.on('instanceCreated', function(e) {

				e.editor.addCommand( 'reloadWebFont',
				{
					exec : function( edr )
					{    
						htmltext2 =	edr.getData();
	
						//alert("reloadwebfont");
						//plaintext = edr.getData().replace( /(<[^<|>]+?>|\r\n|\n|\r|^\s*|\s*$|\s+|&nbsp;)/gim,'' );
						//plaintext_min = getMinTextInOrder(plaintext)
						//alert (plaintext_min);
			
						//1. update html
							cc = -1;
							//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
							$(edr.document.$).find('link').each(function() {
								
							//console.log(edr);	
							//console.log($(edr.document.$).find('link'));	
							//console.log($(CKEDITOR.instances[1].document.$).find('link'))
							//$(CKEDITOR.instances[1].document.$).find('link').each(function() {
								//	alert(cc);
								//bypass the first #webfontinfo_array.length css
								//if (cc >= 0) {
								if (cc>=0 && cc<webfontnum ) {
									tmp_webfontname = webfontinfo_array[cc].split('|')[0];
									tmp_webfont = webfontinfo_array[cc].split('|')[1];
									tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
									tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
									
									if (tmp_webfonttype==1 || tmp_webfonttype==3) {
									}else{
										new_webfont = tmp_webfont + $('#invite_detail_fontindex2270346').val();
										
										var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
										htmltext2 = htmltext2.replace(reg, new_webfont);
										htmltext2 = htmltext2.ReplaceAll(tmp_webfont+'_youvivid_dynamic_font',new_webfont);
									}
								} //if (cc>=0)
						
								cc=cc+1;
							
							
							});
							//}
	
	//console.log(htmltext);
							$('#iframepage').contents().find("#invite_detail_editor2270346").html(htmltext2);
							
							
							//////edr.setData(htmltext2, function(){
								//this.checkDirty();  // true
	
							//2. update csslink
	
								var fontArray = familyParser( htmltext2 );
	
	//console.log(fontArray);
	
								cc = -1;
								//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
								$(edr.document.$).find('link').each(function() {
								//edr.find('link').each(function() {	
									
									//bypass the first css
	
									//if (cc>=0) {
									if (cc>=0 && cc<webfontnum ) {
										tmp_webfontname = webfontinfo_array[cc].split('|')[0];
										tmp_webfont = webfontinfo_array[cc].split('|')[1];
										tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
										tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
										
	
										//if (  edr.getData().toUpperCase().indexOf(tmp_webfont.toUpperCase()) >= 0 ) {
										//	var_text = tmp_webfontname + plaintext_min;
										//}else{
										//	var_text = tmp_webfontname ;
										//}
										//fontArray_idx = fontArray.family.indexOf(tmp_webfont.toLowerCase());
	
										fontArray_idx = -1;
										
										for (var i = 0; i < fontArray.family.length; i++) {
										  if (fontArray.family[i].trim() == tmp_webfont.toLowerCase()) {
											fontArray_idx = i;
											break;
										  }
										}
										
										//alert(tmp_webfont.toLowerCase() + ", fontArray_idx:" + fontArray_idx + ", font: " +  fontArray.family[fontArray_idx]+ ", text: " +  fontArray.text[fontArray_idx] );
										
										if ( fontArray_idx == -1 ){
											//nothing to do 
										} else {
											
											var_text = getMinTextInOrder(fontArray.text[fontArray_idx]);
		
											if (tmp_webfonttype==1 || tmp_webfonttype==3) {
												//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
												new_css_url = tmp_webfonturl ;
			
											}else{
												new_webfont = tmp_webfont + $('#invite_detail_fontindex2270346').val();
												
												post_url = tmp_webfonturl.split('?')[0];
												post_vars = tmp_webfonturl.split('?')[1] + "&text=" + encodeURIComponent(var_text);
		
												post_vars=post_vars.ReplaceAll(tmp_webfont,new_webfont);
												post_vars=post_vars.ReplaceAll(encodeURIComponent(tmp_webfont),encodeURIComponent(new_webfont));
		
												createRequest();
	
												//post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
												//serverUrl = 'http://cn.youvivid.com/';
												//post_url = "http://" + serverUrl.split(/\/+/g)[1] + ":8080/Fonts/csslink";
												//alert(post_url);
	
												
							
													if($.browser.msie && parseInt($.browser.version, 10) <= 9) {
														post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
													} else {
														post_url = "http://42.121.32.43:443/Fonts/csslink";
													}
							
												
	
	
												request.open("POST", post_url, false);
												request.setRequestHeader("Content-type","application/x-www-form-urlencoded");
											//	alert(post_url+"," + post_vars);
												request.send(post_vars);
												post_response = request.responseText; //?取服?器返回的JSON字串
											//	alert("post_response=" + post_response);
												// this is for testing 
												//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
												new_css_url = post_response;
												
												//ex: http://176.34.27.47:8080/Fonts/getcss/88b676b2-ef25-4a41-98da-365bf8299d42;jsessionid=E7BD1CD3D9271040A72A5952BC4ED719?family=粗P 
												//contentcss_url_part1=post_response.split('?family=')[0];
												//contentcss_url_part2=post_response.split('?family=')[1];
												//contentcss_url = contentcss_url_part1 + '?family=' + encodeURIComponent(contentcss_url_part2);
												//new_css_url =  contentcss_url;
												
								//console.log('tmp_webfont:' + tmp_webfont + ', new_webfont:' + new_webfont);
								//				var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
								//				htmltext = htmltext.replace(reg, new_webfont);
											}
			
											
										//	alert(new_css_url);
										//	console.log(new_css_url + ", id=" + tmp_webfont);
											$('#iframepage').contents().find("#" + tmp_webfont ).attr('href', new_css_url )
											
											
											$(this).attr('href', new_css_url );
										}//( fontArray_idx == -1 ){
									} //if (cc>=0)
							
									cc=cc+1;
								
								
								});
								//}
								// useless below
								//ev.editor.config.font_names = 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w';
								//CKEDITOR.config.font_names = 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w';
								
								// new ckeditor 4.3 no need to update fontindex 
								//$('#invite_detail_fontindex2270346').val(Number($('#invite_detail_fontindex2270346').val())+1);
			
	
						//////	});//edr.setData(htmltext2, function(){
	
	
	
						edr.resetDirty();
	
	
	
					},
					async : true //FIREFOX NEED THIS
				}); //end of e.editor.addCommand( 'reloadWebFont',
				/*
					e.editor.on( 'afterCommandExec', function(ev) { 
						alert(ev.data.name );
					});
					e.editor.on( 'selectionChange', function(ev) { 
								delay(function(){
									ev.editor.execCommand( 'reloadWebFont');
								},1000);
						//console.log(ev.data.selection );
						//console.log(ev.data.path );
						//alert(ev.data.selection + "," + ev.data.path );
					});
				*/
			
				e.editor.on( 'saveSnapshot', function(ev) { 
					delay(function(){
						ev.editor.execCommand( 'reloadWebFont');
					},200);
				});
			
			 

				//onchange plugin event
				e.editor.on( 'change', function(ev) { 
					
					if (ev.editor.checkDirty()) {
					// ... ok, we've really changed: respond here ...

						//alert('change');
						htmltext =	ev.editor.getData();
						$('#iframepage').contents().find("#invite_detail_editor2270346").html(htmltext);
							
						//if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	
	
							//delay(function(){
								//ev.editor.execCommand( 'reloadWebFont');
							//},1000);
	
						//} //if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	


					}

				

				});

				e.editor.on( 'key', function(ev) { 
					if (ev.editor.checkDirty()) {
					// ... ok, we've really changed: respond here ...
						//alert('change');
						delay(function(){ //key down event use as key up event
							htmltext =	ev.editor.getData();
							$('#iframepage').contents().find("#invite_detail_editor2270346").html(htmltext);
						},1000);

					}

				});


			}); //CKEDITOR.on('instanceCreated', function(e) 
				

			CKEDITOR.config.templates_files = [
				//CKEDITOR.getUrl( 'plugins/templates/templates/default.js' )
				//CKEDITOR.getUrl( 'plugins/templates3/templates/funssage.js.asp?tcid=7' )
				CKEDITOR.getUrl( '../ckeditor_template.js.asp?tcid=7' )
			];


			if ( window.CKEDITOR && ( !CKEDITOR.env.ie || CKEDITOR.env.version > 7 ) )
				CKEDITOR.env.isCompatible = true;

			var invite_detail_editor2270346 = CKEDITOR.replace( 'invite_detail_editor2270346',
			{
				
				//filebrowserBrowseUrl: 'mobile_invite_select_photo_editor_plu_leo.asp?invite_detail_id=2270346',
				filebrowserBrowseUrl: 'mobile_invite_select_photo_editor_plu_s3oss.asp?invite_detail_id=2270346',
				filebrowserWindowWidth: '480',
				filebrowserWindowHeight: '610',
				//filebrowserImageBrowseUrl: 'mobile_invite_select_photo_editor.asp',
				//filebrowserUploadUrl: 'mobile_slideshow_select_photo_header.asp?invite_detail_id=1160483',
				//filebrowserImageUploadUrl: 'mobile_slideshow_select_photo_header.asp?invite_detail_id=1160483',
				//extraPlugins : 'templates3,reloadwebfont,devtools', 
				extraPlugins : 'templates3,reloadwebfont,confighelper,autogrow', 
				//extraPlugins : 'reloadwebfont', 
				//templates_replaceContent : true,
				//templates_files : [ CKEDITOR.getUrl( 'plugins/templates/templates/default.js.asp' )],
				toolbar :
				[
				
				
					{ name: 'reloadWebFont', items : ['reloadWebFont'] },{ name: 'source', items : ['Source'] },{ name: 'templates_page', items : ['Templates_page'] },{ name: 'templates_component', items : ['Templates_component'] },'/', //source cause problem for access document in change event
					
					//{ name: 'font face', items : [ 'Source','Font','FontSize' ] }, //source cause problem for access document in change event
					{ name: 'font face', items : [ 'Font','FontSize' ] },
					{ name: 'font type', items : [ 'Bold','Italic','TextColor','BGColor' ] },
					{ name: 'paragraph', items : [ 'JustifyLeft','JustifyCenter','JustifyRight' ] },
					{ name: 'links', items : [ 'Link','Unlink'] }
				],
				startupShowBorders : false,
				resize_enabled : false,
				toolbarCanCollapse : false,
				toolbarStartupExpanded : true,
				//height: 350,
				autoGrow_minHeight : 350,
				autoGrow_maxHeight : 700,
				//skin : 'office2003',
				skin : 'moono',
				language : 'zh-cn',
				//skin : 'v2',
				
				// use inline config instead
				//customConfig : '/ckeditor/config_leo.js'
				//enterMode : CKEDITOR.ENTER_BR,
				enterMode : CKEDITOR.ENTER_P,
				//font_names : 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w, Microsoft JhengHei, Microsoft YaHei, arial;' ,	
				font_names : "手机预设字体/Microsoft JhengHei,Microsoft YaHei,arial;粗钢笔/粗钢笔1,粗钢笔10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗圆/粗圆1,粗圆10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;古印体/古印体1,古印体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗广告体/粗广告体1,粗广告体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;隶书/隶书1,隶书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;书宋二/书宋二1,书宋二10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;中行书/中行书1,中行书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;", 
				//config.contentsCss = ['/ckeditor/contents_leo.css', 'http://176.34.27.47/fontScript/getfont.pl?family=%E7%B2%97%E9%8B%BC%E7%AD%86&text=ABCDEFG'] 
				//contentsCss : ['/ckeditor/contents_leo.css']
				//contentsCss : []	
				//contentsCss : contentcss_array, 
			    contentsCss : ["/ckeditor4.3.4_leo/contents2.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css"],
				removePlugins: 'elementspath',
				allowedContent: true 

			});				
			ck_editor2270346 = invite_detail_editor2270346;

			////console.log('手机预设字体/Microsoft JhengHei,Microsoft YaHei,arial;粗钢笔/粗钢笔1,粗钢笔10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗圆/粗圆1,粗圆10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;古印体/古印体1,古印体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗广告体/粗广告体1,粗广告体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;隶书/隶书1,隶书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;书宋二/书宋二1,书宋二10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;中行书/中行书1,中行书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;');

	
			});  //jquery functiom
					
			</script>
			


	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270347">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270347" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="4" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270347" type="checkbox" id="bshow2270347" value="0" checked="checked" /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$("#invite_detail_name2270347").addClass("tab_name_hide");
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270347').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270347").attr("disabled",true);
					$("#invite_detail_name2270347").addClass("tab_name_hide");


					bshow2270347 = 0
					$('#iframepage').contents().find("#invite_detail_title2270347").hide();
					$('#iframepage').contents().find("#invite_detail_content2270347").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270347").attr("disabled",false);
					$("#invite_detail_name2270347").removeClass("tab_name_hide");
					bshow2270347 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270347").show();
					$('#iframepage').contents().find("#invite_detail_content2270347").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>


  <div class="ui-widget">
  <span id="use_google_map2270347"><span style="color:#C6593D" > 使用下方的电子地图定位，或</span><input id="select_map2270347" name="select_map2270347" type="button" value="选择上传地图" /><br></span><input id="remove_map2270347" name="remove_map2270347" type="button"  value="移除地图重新选择" />
  </div>
  
    <input type="hidden" name="invite_detail_latmarker2270347" id="invite_detail_latmarker2270347"  value="31.241401">
    <input type="hidden" name="invite_detail_lngmarker2270347" id="invite_detail_lngmarker2270347" value="121.512876">
    <input type="hidden" name="invite_detail_latcenter2270347" id="invite_detail_latcenter2270347" value="31.240629">
    <input type="hidden" name="invite_detail_lngcenter2270347" id="invite_detail_lngcenter2270347" value="121.512625">
    <input type="hidden" name="invite_detail_zoom2270347" id="invite_detail_zoom2270347" value="16">
    <input type="hidden" name="invite_detail_mapimgurl2270347" id="invite_detail_mapimgurl2270347" value="">

    <table width="100%" border="0">
      <tr>
        <td valign="top">

    <img id="invite_detail_mapimg2270347" style="width:240px; border:thin; border-style:solid; border-color:#999;" src="" width="240" align="top"/>    
    
     <div id="invite_detail_googlemap2270347">   
        <input name="address2270347" type="text" id="address2270347" title="请填写详细省市城镇街道门牌地址" value="" size="24" />
        <input type="button" id="button_setmap2270347" value="定位"  />
        <br>
        <div id="map_canvas2270347" style="width:240px; height:300px; border:thin; border-style:solid; border-color:#999; margin-bottom:5px;"></div>
        
     </div>   
        </td>
        <td valign="top">
    交通指引说明:<br>
	<textarea name="invite_detail_mapdesc2270347" id="invite_detail_mapdesc2270347" cols="32" rows="10">{场所名称}
地址：{场所地址}
电话：{联络电话}</textarea>
    <div style=" margin-top:60px;">
    电子地图编辑帮助:<br>←地图定位: 上方填入完整地址後点击定位<br>←调整大小: 点击左上角[+][-]按钮<br>←移动图面: 以鼠标拖放移动地图<br>←移动地标: 以鼠标拖放移动红心
    </div>
        </td>
      </tr>
    </table>


	 <script language="javascript">
    $(document).ready(function() { 
		$('#button_setmap2270347').click(function() {
		  codeAddress2270347($('#address2270347').val());
		});

		$("#invite_detail_mapdesc2270347").bind('change keydown keyup paste input propertychange',function (){
			$('#iframepage').contents().find("#map_desc2270347").html($(this).val().ReplaceAll('\r\n','\n').ReplaceAll('\n','<br>')); 
			//setHiddenHtml('remindtitle');
		});
		//$("#remindtitle").bind('focus',function (){
	  // $('#iframepage').contents().find('html, body').animate({scrollTop: 0});
		//});
	
		
		
	//	console.log("mapurl="+$("#invite_detail_mapimgurl2270347").val()); 

		if ($("#invite_detail_mapimgurl2270347").val() == '') {
			$("#invite_detail_mapimg2270347").hide();
			$("#invite_detail_googlemap2270347").show();
			//$("#remove_map2270347").attr("disabled", true);
			$("#remove_map2270347").hide();
			$("#use_google_map2270347").show();
			
		} else {
			$("#invite_detail_mapimg2270347").show();
			$("#invite_detail_googlemap2270347").hide();
			//$("#remove_map2270347").attr("disabled", false);
			$("#remove_map2270347").show();
			$("#use_google_map2270347").hide();
	}
		
		
		
		$("#select_map2270347").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			//var page = 'mobile_invite_select_map_detail_plu_leo.asp?invite_detail_id=2270347';
			var page = 'mobile_invite_select_map_detail_plu_s3oss.asp?invite_detail_id=2270347';
			var pagetitle = '请上传或选择图片作为地图';
			$dialog_photo = $('<div></div>')
			.html('<iframe frameborder="0" border="0" cellspacing="0" style="border: none; " src="' + page + '" width="100%" height="100%"></iframe>')
			.dialog({
				position: {my: "center", at: "top", of: document},
				autoOpen: false,
				modal: false,
				//position: "right",
				height: 610,
				width: 580,
				title: pagetitle,
				buttons: [{
					text: '关闭',
					"class": 'closeButtonClass',
					click: function() {
                         $( this ).dialog( "close" );
					}
				}]
			});
			$dialog_photo.dialog('open');




			//$('#title_editor').elrte('val', $('#iframepage').contents().find("#title").html() );
			//$('#title_editor').elrte('updateSource');
		});

		$("#remove_map2270347").bind('click', function (e) {

			$("#iframepage").contents().find('#invite_detail_mapimg2270347').hide();
			$("#iframepage").contents().find('#map_canvas2270347').show();
			$("#iframepage").contents().find('#map_direction2270347').show();
			
			
			$("#iframepage").contents().find('#invite_detail_mapimg2270347').attr('src', '');
			$("#iframepage").contents().find('#invite_detail_mapimgurl2270347').val('');

			if ($('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active") != $("#tabs").tabs( "option", "selected" ) ) {

				$('#iframepage').get(0).contentWindow.$("#accordion").accordion("activate",$("#tabs").tabs( "option", "selected" ));
			}
			$('#iframepage').get(0).contentWindow.initialize2270347();
		
			
			
			
			
			$("#invite_detail_mapimg2270347").hide();
			$("#invite_detail_googlemap2270347").show();
			$("#invite_detail_mapimg2270347").attr('src', '');
			$("#invite_detail_mapimgurl2270347").val('');
			//$("#remove_map2270347").attr("disabled", true);
			$("#remove_map2270347").hide();
			$("#use_google_map2270347").show();
			initialize2270347();

			//alert("移除MV视频完成");

			
		});



    });		
    </script>		



	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270348">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270348" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="7" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270348" type="checkbox" id="bshow2270348" value="0" checked="checked" /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$("#invite_detail_name2270348").addClass("tab_name_hide");
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270348').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270348").attr("disabled",true);
					$("#invite_detail_name2270348").addClass("tab_name_hide");


					bshow2270348 = 0
					$('#iframepage').contents().find("#invite_detail_title2270348").hide();
					$('#iframepage').contents().find("#invite_detail_content2270348").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270348").attr("disabled",false);
					$("#invite_detail_name2270348").removeClass("tab_name_hide");
					bshow2270348 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270348").show();
					$('#iframepage').contents().find("#invite_detail_content2270348").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>


<!-- case 7 -->
<!--
<div style="color:#C6593D" > 请选择添加相酝计</div>
-->   

              <style>
              #sortable2270348 { list-style-type: none; margin: 0; padding: 0; width: 350px; }
              #sortable2270348 li { margin: 3px 3px 3px 0; padding: 1px; float: left; width: 100px; height: 110px; font-size: 8pt; text-align: center; cursor: move;}
              #sortable2270348 li span{ cursor: pointer; }
				.thumb {
					width: 100px;
					height: 100px;
					overflow: hidden;
				}
				.thumb .thumbimage  {
					width:100%; height:100%; background-size:cover; background-position:center center;
				}
              </style>
              <script>
              $(function() {
                  $("#sortable2270348").sortable({
                      
                      deactivate: function(ev, ui){
                          
                          syncGallery2270348();
                      }
                      

                  });
                  
                  $("#sortable2270348").disableSelection();
              });
              </script>
              
              <input id="select_image22270348" name="select_image22270348" type="button" value="添加相册图片" />
              

			<input type="hidden" id="slideshow2270348" name="slideshow2270348" value="">
            
            <input type="hidden" name="sn2270348" value="W93TV">
            
            <input type="hidden" name="invite_usrcookies2270348" value="">
          
            <table width="100%" cellpadding="0" cellspacing="0" border="0">
             <tr><td width="100%" height="30" >

<span id="nopicture2270348"  style="color:#C6593D" >没有图片, 请点击上方按钮添加图片</span>          
              
              <ul id="sortable2270348" name="sortable2270348">
<!--<li id="40240" class="ui-state-default" fileurl="uploads/image/f0904273C82W2683.jpg"  style="text-align: right"><span><img src="./images/close_button.png"></span><BR><img src="uploads/image/f0904273C82W2683.jpg" width="100" height="90"></li>-->

              </ul>
               
              
              
              
              </td></tr>
          
            </table>
            




<script>
		
var $dialog_photo2;		
		
$(document).ready(function() { 
		     
       
	
		
		$("#select_image22270348").bind('click', function (e) {
			//alert("select_image");
			e.preventDefault();
			//$('#iframepage').contents().find('html, body').animate({scrollTop: 1000});
			//var page = 'mobile_slideshow_select_photo_header_plu_leo.asp?invite_detail_id=2270348';
			var page = 'mobile_slideshow_select_photo_header_plu_s3oss.asp?invite_detail_id=2270348';
			var pagetitle = '请选择婚纱相册的相片';
			$dialog_photo2 = $('<div></div>')
			.html('<iframe frameborder="0" border="0" cellspacing="0" style="border: none; " src="' + page + '" width="100%" height="100%"></iframe>')
			.dialog({
				position: {my: "left top", at: "left top", of: document},
				autoOpen: false,
				modal: true,
				height: 610,
				width: 580,
				title: pagetitle,
				buttons: [{
					text: '关闭',
					"class": 'closeButtonClass',
					click: function() {
                         $( this ).dialog( "close" );
					}
				}],
				beforeClose: function (event, ui) {
				   syncGallery2270348();
			  }
				  
			});
			$dialog_photo2.dialog('open');

		});


    $("#sortable2270348 li span").live("click",function() {
      
          $(this).closest('li').remove();
           
           syncGallery2270348(); 
    
    });
    
});

function syncGallery2270348(){

         var list = '';
  
     		 $('#nopicture2270348').html("");
     		 $('#iframepage').contents().find('#nopicture2270348').html("");
     		 
     		 $('#iframepage').contents().find('#Gallery2270348 li').remove();    
         
         $('#iframepage').contents().find("#invite_webimg,#img_decoration1,#img_decoration2,#img_decoration3").css('cursor', 'default');			
         
         if ($('#sortable2270348 li').size() > 0){
             
             $('#sortable2270348 li').each(function(){
               
                var current = $(this);
    
               if(current.children().size() > 0) {
                
                   var img = current.children().eq(2); 
                   //alert( current.attr('id') + current.attr('fileurl'));    
                   //window.parent.$("#iframepage")[0].contentWindow.addPhotoSwipe( current.attr('id'), img.attr('src'), current.attr('fileurl'), $('#sortable li').size()); // prevent cross domain access restriction of xitie
                   //alert(img.attr('src'));
				   $("#iframepage")[0].contentWindow.addPhotoSwipe2270348( current.attr('id'), img.attr('src'), current.attr('fileurl'), $('#sortable2270348 li').size());
                    
                   list = list + "'" + current.attr('id') + "," +  img.attr('src') + "," + current.attr('fileurl') + "'";
                }            
                
                 
             });
             
             $('#iframepage').contents().find("#invite_webimg,#img_decoration1,#img_decoration2,#img_decoration3").css('cursor', 'pointer');			
             
             
         }else{
             $('#nopicture2270348').html("没有图片, 请点击上方按钮添加图片");
             $('#iframepage').contents().find('#nopicture2270348').html("没有图片");
             
         }
         
         document.form_invite.slideshow2270348.value = list.ReplaceAll("''", "|").ReplaceAll("'", "");

}



  var oldonload2270348 = window.onload;
  if (typeof window.onload != 'function') {
    window.onload = syncGallery2270348;
  } else {
    window.onload = function() {
      if (oldonload2270348) {
        oldonload2270348();
      }
      syncGallery2270348();
    }
  }



</script>


<!-- case 7 -->




	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270349">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270349" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="1" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270349" type="checkbox" id="bshow2270349" value="0" checked="checked" /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$("#invite_detail_name2270349").addClass("tab_name_hide");
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270349').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270349").attr("disabled",true);
					$("#invite_detail_name2270349").addClass("tab_name_hide");


					bshow2270349 = 0
					$('#iframepage').contents().find("#invite_detail_title2270349").hide();
					$('#iframepage').contents().find("#invite_detail_content2270349").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270349").attr("disabled",false);
					$("#invite_detail_name2270349").removeClass("tab_name_hide");
					bshow2270349 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270349").show();
					$('#iframepage').contents().find("#invite_detail_content2270349").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>

        	<input type="hidden" name="invite_detail_fontindex2270349" id="invite_detail_fontindex2270349" value="0">
			<div style="color:#C6593D" ><img src="images/info.gif" width="16" height="15" /> 修改文字后,请点击工具列左侧 <img src="ckeditor/plugins/reloadwebfont/reload2.png" width="10" height="10" /> 按钮刷新。编辑时如需要上下行对齐文字请使用全角空格</div>
			<br>
			<textarea id="invite_detail_editor2270349" name="invite_detail_editor2270349"><p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">2008年秋，他们初次见面</span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">她，外型亮眼，美女一位 </span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">他，外型俊俏，酷男一枚</span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">在互相看了一眼后，彼此吸引 </span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">就此沉迷于爱恋中 </span></span></p>

<p style="text-align: center;">&nbsp;</p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">爱情，让她下厨烹调</span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">只想绑住他的胃 </span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">爱情，让他走向户外</span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">与她一起迎向阳光 </span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">爱情，让双方更有勇气面对困难 </span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">爱情，让彼此更能看见自己</span></span></p>

<p style="text-align: center;">&nbsp;</p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">于是在今年 </span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">犹豫的两人终于下定决心 </span></span></p>

<p style="text-align: center;"><span style="font-family: 粗钢笔1,粗钢笔10,微软雅黑,宋体,microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 16px;">&quot;未来，让我们一起手牵手走下去!&quot;</span></span></p>

<p style="text-align: center;">&nbsp;</p>
</textarea>
			<script type="text/javascript">
			//no use now			
			function striphtml(html)
			{
			   var tmp = document.createElement("DIV");
			   tmp.innerHTML = html;
			   return tmp.textContent||tmp.innerText;
			}			


			//?建求XMLHttpRequest?象
			function createRequest() {
				try {
					request = new XMLHttpRequest();
				} catch (trymicrosoft) {
					try {
						request = new ActiveXObject("Msxml2.XMLHTTP");
					} catch (othermicrosoft) {
						try {
							request = new ActiveXObject("Microsoft.XMLHTTP");
						} catch (failed) {
							request = false;
						}
					}
				}
				if (!request)
					alert("ERROR XMLHttpRequest!");
			}
			
			
			
			var ck_editor2270349;
			var contentcss_array =new Array();


			var webfontinfo_array = ['粗钢笔|粗钢笔1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E9%92%A2%E7%AC%941&font=%E7%B2%97%E9%92%A2%E7%AC%94|2','粗圆|粗圆1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E5%9C%861&font=%E7%B2%97%E5%9C%86|2','古印体|古印体1|http://42.121.32.43:443/Fonts/csslink?family=%E5%8F%A4%E5%8D%B0%E4%BD%931&font=%E5%8F%A4%E5%8D%B0%E4%BD%93|2','黑体|黑体1|http://42.121.32.43:443/Fonts/csslink?family=%E9%BB%91%E4%BD%931&font=%E9%BB%91%E4%BD%93|2','粗广告体|粗广告体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%931&font=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%93|2','隶书|隶书1|http://42.121.32.43:443/Fonts/csslink?family=%E9%9A%B6%E4%B9%A61&font=%E9%9A%B6%E4%B9%A6|2','书宋二|书宋二1|http://42.121.32.43:443/Fonts/csslink?family=%E4%B9%A6%E5%AE%8B%E4%BA%8C1&font=%E4%B9%A6%E5%AE%8B%E4%BA%8C|2','中行书|中行书1|http://42.121.32.43:443/Fonts/csslink?family=%E4%B8%AD%E8%A1%8C%E4%B9%A61&font=%E4%B8%AD%E8%A1%8C%E4%B9%A6|2','粗行楷体|粗行楷体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%931&font=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%93|2','甜妞体|甜妞体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%94%9C%E5%A6%9E%E4%BD%931&font=%E7%94%9C%E5%A6%9E%E4%BD%93|2'];
			var webfontnum = 10;


	        $(function() { //jquery functiom


			function   familyParser(text) {
				var familyArray = [];
				var textArray = [] ;
				var tagArray = [];
				var parser = new CKEDITOR.htmlParser();
				var font = null;
			
				parser.onText = function (text) {
					if (font == null) return;
					var indexS = font.indexOf('font-family:');
					var indexE1 = font.indexOf(',', indexS); // -1 , n
					var indexE2 = font.indexOf(';', indexS); // -1 , n
					if (indexE1 == -1 )
						indexE1 = font.length;
					if (indexE2 == -1 )
						indexE2 = font.length;
					indexE = Math.min(indexE1,indexE2);
					
					
					
					var fontName = font.substring(indexS + 12, indexE).trim().ReplaceAll("'", "").ReplaceAll('"', '');
					var bFound = false;
					for (var i = familyArray.length - 1; i >= 0; i--) {
						if (familyArray[i].localeCompare(fontName) == 0) {
							textArray[i] += text;
							bFound = true;
							break;
						}
					}
			
					if (bFound == false) {
						familyArray.push(fontName);
						textArray.push(text);
					}
				}
			
				parser.onTagClose = function (tagName) {
					tag = tagArray.pop();
					if (tag == null) return;
					if (tag.indexOf("font-family") != -1) {
						for (i = tagArray.length - 1; i >= 0; i--) {
							if (tagArray[i] == null) continue;
							if (tagArray[i].indexOf("font-family") != -1) {
								font = tagArray[i];
								return;
							}
						}
					}
					//font = null;
				}
			
				parser.onTagOpen = function (tagName, attributes, selfClosing) {
					if ((attributes == null) || (attributes.style == null)) {
						tagArray.push(null);
						return;
					}
			
					tagArray.push(attributes.style);
					if (attributes.style.indexOf("font-family") != -1) {
						font = attributes.style;
					}
			
				};
			
				parser.parse(text);
				parser = null;
				return {family:familyArray, text:textArray};
			}

			CKEDITOR.on('instanceReady', function(e) {
				
				e.editor.dataProcessor.htmlFilter.addRules(
					{
						elements:
						{
							$: function (element) {
								// Output dimensions of images as width and height
								if (element.name == 'img') {
									var style = element.attributes.style;
			
									if (style) {
										// Get the width from the style.
										var match = /(?:^|\s)width\s*:\s*(\d+)px/i.exec(style),
											width = match && match[1];
			
										// Get the height from the style.
										match = /(?:^|\s)height\s*:\s*(\d+)px/i.exec(style);
										var height = match && match[1];
			
										if (width) {
											element.attributes.style = element.attributes.style.replace(/(?:^|\s)width\s*:\s*(\d+)px;?/i, '');
											element.attributes.width = width;
										}
			
										if (height) {
											element.attributes.style = element.attributes.style.replace(/(?:^|\s)height\s*:\s*(\d+)px;?/i, '');
											element.attributes.height = height;
										}
									}
								}
			
			
			
								if (!element.attributes.style)
									delete element.attributes.style;
			
								return element;
							}
						}
					});


				//e.editor.execCommand( 'reloadWebFont');
								
			}); //CKEDITOR.on('instanceReady', function(e) 



			CKEDITOR.on( 'dialogDefinition', function( ev )
			{
			  // Take the dialog name and its definition from the event data.
			  var dialogName = ev.data.name;
			  var dialogDefinition = ev.data.definition;
			
			  // Check if the definition is from the dialog we're
			  // interested in (the 'image' dialog). This dialog name found using DevTools plugin



			  if ( dialogName == 'image' )
			  {

				 // Remove the 'Link' and 'Advanced' tabs from the 'Image' dialog.
				 dialogDefinition.removeContents( 'Link' );
				 dialogDefinition.removeContents( 'advanced' );
			
				 // Get a reference to the 'Image Info' tab.
				 var infoTab = dialogDefinition.getContents( 'info' );
			
				 // Remove unnecessary widgets/elements from the 'Image Info' tab.         
				 infoTab.remove( 'txtHSpace');
				 infoTab.remove( 'txtVSpace');
				 infoTab.remove( 'txtBorder' );
				 infoTab.remove( 'txtAlt' );
				 infoTab.remove( 'txtWidth' );
				 infoTab.remove( 'txtHeight' );
				 infoTab.remove( 'ratioLock' );
				 //infoTab.remove( 'htmlPreview' );
				 
				dialogDefinition.onSelect = function()
				{
					alert("onfocus");
					//var urlField = this.getContentElement( 'info', 'url' );
					//urlField.select();
				};
				  
			  }

			  
			  if ( dialogName == 'link' )
			  {
				// Remove the "Target" tab from the "Link" dialog.


				// Get a reference to the "Target" tab and set default to '_blank'
				/*
				var targetTab = dialogDefinition.getContents('target');
				var targetField = targetTab.get('linkTargetType');
				targetField['default'] = '_blank';
				*/
				/*
				var advTab =  dialogDefinition.getContents( 'advanced' );
				var cssField = advTab.get( 'advCSSClasses' );
				cssField['default'] = 'inviteTextLinkClass';
				*/
				
				var infoTab = dialogDefinition.getContents( 'info' );
				// Set the default value for the URL field.
				var urlField = infoTab.get( 'url' );
				urlField['default'] = 'www.example.com';
			
			
			
				// Rewrite the 'onFocus' handler to always focus 'url' field.
				dialogDefinition.onFocus = function()
				{
					var urlField = this.getContentElement( 'info', 'url' );
					urlField.select();
				};



				dialogDefinition.removeContents( 'target' );
				dialogDefinition.removeContents( 'advanced' );
				// Get a reference to the "Link Info" tab.
			
			
				// Remove the "Link Type" combo and the "Browser
				// Server" button from the "info" tab.
				infoTab.remove( 'linkType' );
				infoTab.remove( 'browse' );

			
			  }
			  
			  
			  
			});
			
			CKEDITOR.on('instanceCreated', function(e) {

				e.editor.addCommand( 'reloadWebFont',
				{
					exec : function( edr )
					{    
						htmltext2 =	edr.getData();
	
						//alert("reloadwebfont");
						//plaintext = edr.getData().replace( /(<[^<|>]+?>|\r\n|\n|\r|^\s*|\s*$|\s+|&nbsp;)/gim,'' );
						//plaintext_min = getMinTextInOrder(plaintext)
						//alert (plaintext_min);
			
						//1. update html
							cc = -1;
							//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
							$(edr.document.$).find('link').each(function() {
								
							//console.log(edr);	
							//console.log($(edr.document.$).find('link'));	
							//console.log($(CKEDITOR.instances[1].document.$).find('link'))
							//$(CKEDITOR.instances[1].document.$).find('link').each(function() {
								//	alert(cc);
								//bypass the first #webfontinfo_array.length css
								//if (cc >= 0) {
								if (cc>=0 && cc<webfontnum ) {
									tmp_webfontname = webfontinfo_array[cc].split('|')[0];
									tmp_webfont = webfontinfo_array[cc].split('|')[1];
									tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
									tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
									
									if (tmp_webfonttype==1 || tmp_webfonttype==3) {
									}else{
										new_webfont = tmp_webfont + $('#invite_detail_fontindex2270349').val();
										
										var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
										htmltext2 = htmltext2.replace(reg, new_webfont);
										htmltext2 = htmltext2.ReplaceAll(tmp_webfont+'_youvivid_dynamic_font',new_webfont);
									}
								} //if (cc>=0)
						
								cc=cc+1;
							
							
							});
							//}
	
	//console.log(htmltext);
							$('#iframepage').contents().find("#invite_detail_editor2270349").html(htmltext2);
							
							
							//////edr.setData(htmltext2, function(){
								//this.checkDirty();  // true
	
							//2. update csslink
	
								var fontArray = familyParser( htmltext2 );
	
	//console.log(fontArray);
	
								cc = -1;
								//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
								$(edr.document.$).find('link').each(function() {
								//edr.find('link').each(function() {	
									
									//bypass the first css
	
									//if (cc>=0) {
									if (cc>=0 && cc<webfontnum ) {
										tmp_webfontname = webfontinfo_array[cc].split('|')[0];
										tmp_webfont = webfontinfo_array[cc].split('|')[1];
										tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
										tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
										
	
										//if (  edr.getData().toUpperCase().indexOf(tmp_webfont.toUpperCase()) >= 0 ) {
										//	var_text = tmp_webfontname + plaintext_min;
										//}else{
										//	var_text = tmp_webfontname ;
										//}
										//fontArray_idx = fontArray.family.indexOf(tmp_webfont.toLowerCase());
	
										fontArray_idx = -1;
										
										for (var i = 0; i < fontArray.family.length; i++) {
										  if (fontArray.family[i].trim() == tmp_webfont.toLowerCase()) {
											fontArray_idx = i;
											break;
										  }
										}
										
										//alert(tmp_webfont.toLowerCase() + ", fontArray_idx:" + fontArray_idx + ", font: " +  fontArray.family[fontArray_idx]+ ", text: " +  fontArray.text[fontArray_idx] );
										
										if ( fontArray_idx == -1 ){
											//nothing to do 
										} else {
											
											var_text = getMinTextInOrder(fontArray.text[fontArray_idx]);
		
											if (tmp_webfonttype==1 || tmp_webfonttype==3) {
												//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
												new_css_url = tmp_webfonturl ;
			
											}else{
												new_webfont = tmp_webfont + $('#invite_detail_fontindex2270349').val();
												
												post_url = tmp_webfonturl.split('?')[0];
												post_vars = tmp_webfonturl.split('?')[1] + "&text=" + encodeURIComponent(var_text);
		
												post_vars=post_vars.ReplaceAll(tmp_webfont,new_webfont);
												post_vars=post_vars.ReplaceAll(encodeURIComponent(tmp_webfont),encodeURIComponent(new_webfont));
		
												createRequest();
	
												//post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
												//serverUrl = 'http://cn.youvivid.com/';
												//post_url = "http://" + serverUrl.split(/\/+/g)[1] + ":8080/Fonts/csslink";
												//alert(post_url);
	
												
							
													if($.browser.msie && parseInt($.browser.version, 10) <= 9) {
														post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
													} else {
														post_url = "http://42.121.32.43:443/Fonts/csslink";
													}
							
												
	
	
												request.open("POST", post_url, false);
												request.setRequestHeader("Content-type","application/x-www-form-urlencoded");
											//	alert(post_url+"," + post_vars);
												request.send(post_vars);
												post_response = request.responseText; //?取服?器返回的JSON字串
											//	alert("post_response=" + post_response);
												// this is for testing 
												//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
												new_css_url = post_response;
												
												//ex: http://176.34.27.47:8080/Fonts/getcss/88b676b2-ef25-4a41-98da-365bf8299d42;jsessionid=E7BD1CD3D9271040A72A5952BC4ED719?family=粗P 
												//contentcss_url_part1=post_response.split('?family=')[0];
												//contentcss_url_part2=post_response.split('?family=')[1];
												//contentcss_url = contentcss_url_part1 + '?family=' + encodeURIComponent(contentcss_url_part2);
												//new_css_url =  contentcss_url;
												
								//console.log('tmp_webfont:' + tmp_webfont + ', new_webfont:' + new_webfont);
								//				var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
								//				htmltext = htmltext.replace(reg, new_webfont);
											}
			
											
										//	alert(new_css_url);
										//	console.log(new_css_url + ", id=" + tmp_webfont);
											$('#iframepage').contents().find("#" + tmp_webfont ).attr('href', new_css_url )
											
											
											$(this).attr('href', new_css_url );
										}//( fontArray_idx == -1 ){
									} //if (cc>=0)
							
									cc=cc+1;
								
								
								});
								//}
								// useless below
								//ev.editor.config.font_names = 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w';
								//CKEDITOR.config.font_names = 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w';
								
								// new ckeditor 4.3 no need to update fontindex 
								//$('#invite_detail_fontindex2270349').val(Number($('#invite_detail_fontindex2270349').val())+1);
			
	
						//////	});//edr.setData(htmltext2, function(){
	
	
	
						edr.resetDirty();
	
	
	
					},
					async : true //FIREFOX NEED THIS
				}); //end of e.editor.addCommand( 'reloadWebFont',
				/*
					e.editor.on( 'afterCommandExec', function(ev) { 
						alert(ev.data.name );
					});
					e.editor.on( 'selectionChange', function(ev) { 
								delay(function(){
									ev.editor.execCommand( 'reloadWebFont');
								},1000);
						//console.log(ev.data.selection );
						//console.log(ev.data.path );
						//alert(ev.data.selection + "," + ev.data.path );
					});
				*/
			
				e.editor.on( 'saveSnapshot', function(ev) { 
					delay(function(){
						ev.editor.execCommand( 'reloadWebFont');
					},200);
				});
			
			 

				//onchange plugin event
				e.editor.on( 'change', function(ev) { 
					
					if (ev.editor.checkDirty()) {
					// ... ok, we've really changed: respond here ...

						//alert('change');
						htmltext =	ev.editor.getData();
						$('#iframepage').contents().find("#invite_detail_editor2270349").html(htmltext);
							
						//if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	
	
							//delay(function(){
								//ev.editor.execCommand( 'reloadWebFont');
							//},1000);
	
						//} //if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	


					}

				

				});

				e.editor.on( 'key', function(ev) { 
					if (ev.editor.checkDirty()) {
					// ... ok, we've really changed: respond here ...
						//alert('change');
						delay(function(){ //key down event use as key up event
							htmltext =	ev.editor.getData();
							$('#iframepage').contents().find("#invite_detail_editor2270349").html(htmltext);
						},1000);

					}

				});


			}); //CKEDITOR.on('instanceCreated', function(e) 
				

			CKEDITOR.config.templates_files = [
				//CKEDITOR.getUrl( 'plugins/templates/templates/default.js' )
				//CKEDITOR.getUrl( 'plugins/templates3/templates/funssage.js.asp?tcid=7' )
				CKEDITOR.getUrl( '../ckeditor_template.js.asp?tcid=7' )
			];


			if ( window.CKEDITOR && ( !CKEDITOR.env.ie || CKEDITOR.env.version > 7 ) )
				CKEDITOR.env.isCompatible = true;

			var invite_detail_editor2270349 = CKEDITOR.replace( 'invite_detail_editor2270349',
			{
				
				//filebrowserBrowseUrl: 'mobile_invite_select_photo_editor_plu_leo.asp?invite_detail_id=2270349',
				filebrowserBrowseUrl: 'mobile_invite_select_photo_editor_plu_s3oss.asp?invite_detail_id=2270349',
				filebrowserWindowWidth: '480',
				filebrowserWindowHeight: '610',
				//filebrowserImageBrowseUrl: 'mobile_invite_select_photo_editor.asp',
				//filebrowserUploadUrl: 'mobile_slideshow_select_photo_header.asp?invite_detail_id=1160483',
				//filebrowserImageUploadUrl: 'mobile_slideshow_select_photo_header.asp?invite_detail_id=1160483',
				//extraPlugins : 'templates3,reloadwebfont,devtools', 
				extraPlugins : 'templates3,reloadwebfont,confighelper,autogrow', 
				//extraPlugins : 'reloadwebfont', 
				//templates_replaceContent : true,
				//templates_files : [ CKEDITOR.getUrl( 'plugins/templates/templates/default.js.asp' )],
				toolbar :
				[
				
				
					{ name: 'reloadWebFont', items : ['reloadWebFont'] },{ name: 'source', items : ['Source'] },{ name: 'templates_page', items : ['Templates_page'] },{ name: 'templates_component', items : ['Templates_component'] },'/', //source cause problem for access document in change event
					
					//{ name: 'font face', items : [ 'Source','Font','FontSize' ] }, //source cause problem for access document in change event
					{ name: 'font face', items : [ 'Font','FontSize' ] },
					{ name: 'font type', items : [ 'Bold','Italic','TextColor','BGColor' ] },
					{ name: 'paragraph', items : [ 'JustifyLeft','JustifyCenter','JustifyRight' ] },
					{ name: 'links', items : [ 'Link','Unlink'] }
				],
				startupShowBorders : false,
				resize_enabled : false,
				toolbarCanCollapse : false,
				toolbarStartupExpanded : true,
				//height: 350,
				autoGrow_minHeight : 350,
				autoGrow_maxHeight : 700,
				//skin : 'office2003',
				skin : 'moono',
				language : 'zh-cn',
				//skin : 'v2',
				
				// use inline config instead
				//customConfig : '/ckeditor/config_leo.js'
				//enterMode : CKEDITOR.ENTER_BR,
				enterMode : CKEDITOR.ENTER_P,
				//font_names : 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w, Microsoft JhengHei, Microsoft YaHei, arial;' ,	
				font_names : "手机预设字体/Microsoft JhengHei,Microsoft YaHei,arial;粗钢笔/粗钢笔1,粗钢笔10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗圆/粗圆1,粗圆10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;古印体/古印体1,古印体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗广告体/粗广告体1,粗广告体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;隶书/隶书1,隶书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;书宋二/书宋二1,书宋二10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;中行书/中行书1,中行书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;", 
				//config.contentsCss = ['/ckeditor/contents_leo.css', 'http://176.34.27.47/fontScript/getfont.pl?family=%E7%B2%97%E9%8B%BC%E7%AD%86&text=ABCDEFG'] 
				//contentsCss : ['/ckeditor/contents_leo.css']
				//contentsCss : []	
				//contentsCss : contentcss_array, 
			    contentsCss : ["/ckeditor4.3.4_leo/contents2.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css"],
				removePlugins: 'elementspath',
				allowedContent: true 

			});				
			ck_editor2270349 = invite_detail_editor2270349;

			////console.log('手机预设字体/Microsoft JhengHei,Microsoft YaHei,arial;粗钢笔/粗钢笔1,粗钢笔10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗圆/粗圆1,粗圆10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;古印体/古印体1,古印体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗广告体/粗广告体1,粗广告体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;隶书/隶书1,隶书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;书宋二/书宋二1,书宋二10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;中行书/中行书1,中行书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;');

	
			});  //jquery functiom
					
			</script>
			


	</div><!--End Tab-XXX -->



	<div id="invite_detail_content2270350">
		<div align="right">
        	<input name="invite_detail_id" id="invite_detail_id" type="hidden" value="2270350" />
            <input name="invite_detail_type" id="invite_detail_type" type="hidden" value="1" />
			<div class="switch-wrapper">
            <input class="switch_button" name="bshow2270350" type="checkbox" id="bshow2270350" value="0" checked="checked" /> 
            </div>
        </div>
		<script>
		$(document).ready(function() {
			//set initial state.
			
			$("#invite_detail_name2270350").addClass("tab_name_hide");
			
			
			$(".switch_button").switchButton({
			  on_label: '隐藏',
			  off_label: '显示',
			  width: 30,
			  height: 12,
			  button_width: 15
			  
			});
			
			$('#bshow2270350').change(function() {
				if ($(this).is(':checked')) {
         			//alert('hide');
					
					//$("#invite_detail_name2270350").attr("disabled",true);
					$("#invite_detail_name2270350").addClass("tab_name_hide");


					bshow2270350 = 0
					$('#iframepage').contents().find("#invite_detail_title2270350").hide();
					$('#iframepage').contents().find("#invite_detail_content2270350").hide();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "activate" , false )
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } );
				} else {
         			//alert('show');
					//$("#invite_detail_name2270350").attr("disabled",false);
					$("#invite_detail_name2270350").removeClass("tab_name_hide");
					bshow2270350 = 1;
					$('#iframepage').contents().find("#invite_detail_title2270350").show();
					$('#iframepage').contents().find("#invite_detail_content2270350").show();
					$('#iframepage').get(0).contentWindow.$("#accordion").accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
//					$('#iframepage').get(0).contentWindow.$("#accordion").accordion('destroy').accordion({ autoHeight: false },{ collapsible: true,active: false } ).accordion( "option", "active", $('#tabs').tabs( "option", "selected" ) );
				}
				$('#iframepage').get(0).contentWindow.processButtonBackground();	//call iframe function	 

			});
		});
 
        </script>

        	<input type="hidden" name="invite_detail_fontindex2270350" id="invite_detail_fontindex2270350" value="0">
			<div style="color:#C6593D" ><img src="images/info.gif" width="16" height="15" /> 修改文字后,请点击工具列左侧 <img src="ckeditor/plugins/reloadwebfont/reload2.png" width="10" height="10" /> 按钮刷新。编辑时如需要上下行对齐文字请使用全角空格</div>
			<br>
			<textarea id="invite_detail_editor2270350" name="invite_detail_editor2270350"><p>&nbsp;</p>

<fieldset style="margin: 0px; padding: 7px; border: 1px solid rgb(204, 204, 204); max-width: 100%; background-color: rgb(250, 250, 240); border-image: none;"><legend align="right" style="margin: 0px; padding: 0px; text-align: right; color: rgb(0, 0, 0); max-width: 100%;"><span style="font-size: 16px;"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><strong><span style="color: rgb(255, 255, 255);"><span style="padding: 2px 10px; border-radius: 4px; max-width: 100%; background-color: rgb(153, 3, 3);">新郎介绍</span></span></strong></span></span></legend><img alt="" src="http://youvividcnupload1.oss.aliyuncs.com/images/2014/50/f1412115488fcc0bfce1.jpg" style="margin: 0px 6px 0px 0px; float: left;" width="90" /><span style="color: rgb(128, 0, 0);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 18px;"><strong><span style="line-height: 1.2em; background-color: rgb(250, 250, 240);">h克</span></strong></span></span></span>

<p style="margin: 0px 0px 2px; line-height: 1.2em;"><span style="color: rgb(128, 0, 0);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="line-height: 19.2px; font-size: 16px; background-color: rgb(250, 250, 240);">1978年生，天蝎座O型，软件工程师。台面上不苟言笑、拘谨沉稳，私下阳光又搞笑。喜爱天马行空的想像。梦想与老婆白头偕老。</span></span></span></p>
</fieldset>

<p>&nbsp;</p>

<fieldset style="margin: 0px; padding: 7px; border: 1px solid rgb(204, 204, 204); max-width: 100%; background-color: rgb(250, 250, 240); border-image: none;"><legend align="right" style="margin: 0px; padding: 0px; text-align: right; color: rgb(0, 0, 0); max-width: 100%;"><span style="font-size: 16px;"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><strong><span style="color: rgb(255, 255, 255);"><span style="padding: 2px 10px; border-radius: 4px; max-width: 100%; background-color: rgb(153, 3, 3);">新娘介绍</span></span></strong></span></span></legend><img alt="" src="http://youvividcnupload1.oss.aliyuncs.com/images/2014/50/f1412115488fcc0bfce1.jpg" style="margin: 0px 6px 0px 0px; float: left;" width="90" /><span style="color: rgb(128, 0, 0);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="font-size: 18px;"><strong><span style="line-height: 1.2em; background-color: rgb(250, 250, 240);">卡}</span></strong></span></span></span>

<p style="margin: 0px 0px 2px; line-height: 1.2em;"><span style="color: rgb(128, 0, 0);"><span style="font-family: microsoft jhenghei,microsoft yahei,arial;"><span style="line-height: 19.2px; font-size: 16px; background-color: rgb(250, 250, 240);">1979年生，女座A型，室仍O。面上w敏感、小家碧玉，私下崆橛坌ΑＯ刍花草草的味道。粝肱c老公永浴酆印</span></span></span></p>
</fieldset>

<p>&nbsp;</p>
</textarea>
			<script type="text/javascript">
			//no use now			
			function striphtml(html)
			{
			   var tmp = document.createElement("DIV");
			   tmp.innerHTML = html;
			   return tmp.textContent||tmp.innerText;
			}			


			//?建求XMLHttpRequest?象
			function createRequest() {
				try {
					request = new XMLHttpRequest();
				} catch (trymicrosoft) {
					try {
						request = new ActiveXObject("Msxml2.XMLHTTP");
					} catch (othermicrosoft) {
						try {
							request = new ActiveXObject("Microsoft.XMLHTTP");
						} catch (failed) {
							request = false;
						}
					}
				}
				if (!request)
					alert("ERROR XMLHttpRequest!");
			}
			
			
			
			var ck_editor2270350;
			var contentcss_array =new Array();


			var webfontinfo_array = ['粗钢笔|粗钢笔1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E9%92%A2%E7%AC%941&font=%E7%B2%97%E9%92%A2%E7%AC%94|2','粗圆|粗圆1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E5%9C%861&font=%E7%B2%97%E5%9C%86|2','古印体|古印体1|http://42.121.32.43:443/Fonts/csslink?family=%E5%8F%A4%E5%8D%B0%E4%BD%931&font=%E5%8F%A4%E5%8D%B0%E4%BD%93|2','黑体|黑体1|http://42.121.32.43:443/Fonts/csslink?family=%E9%BB%91%E4%BD%931&font=%E9%BB%91%E4%BD%93|2','粗广告体|粗广告体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%931&font=%E7%B2%97%E5%B9%BF%E5%91%8A%E4%BD%93|2','隶书|隶书1|http://42.121.32.43:443/Fonts/csslink?family=%E9%9A%B6%E4%B9%A61&font=%E9%9A%B6%E4%B9%A6|2','书宋二|书宋二1|http://42.121.32.43:443/Fonts/csslink?family=%E4%B9%A6%E5%AE%8B%E4%BA%8C1&font=%E4%B9%A6%E5%AE%8B%E4%BA%8C|2','中行书|中行书1|http://42.121.32.43:443/Fonts/csslink?family=%E4%B8%AD%E8%A1%8C%E4%B9%A61&font=%E4%B8%AD%E8%A1%8C%E4%B9%A6|2','粗行楷体|粗行楷体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%931&font=%E7%B2%97%E8%A1%8C%E6%A5%B7%E4%BD%93|2','甜妞体|甜妞体1|http://42.121.32.43:443/Fonts/csslink?family=%E7%94%9C%E5%A6%9E%E4%BD%931&font=%E7%94%9C%E5%A6%9E%E4%BD%93|2'];
			var webfontnum = 10;


	        $(function() { //jquery functiom


			function   familyParser(text) {
				var familyArray = [];
				var textArray = [] ;
				var tagArray = [];
				var parser = new CKEDITOR.htmlParser();
				var font = null;
			
				parser.onText = function (text) {
					if (font == null) return;
					var indexS = font.indexOf('font-family:');
					var indexE1 = font.indexOf(',', indexS); // -1 , n
					var indexE2 = font.indexOf(';', indexS); // -1 , n
					if (indexE1 == -1 )
						indexE1 = font.length;
					if (indexE2 == -1 )
						indexE2 = font.length;
					indexE = Math.min(indexE1,indexE2);
					
					
					
					var fontName = font.substring(indexS + 12, indexE).trim().ReplaceAll("'", "").ReplaceAll('"', '');
					var bFound = false;
					for (var i = familyArray.length - 1; i >= 0; i--) {
						if (familyArray[i].localeCompare(fontName) == 0) {
							textArray[i] += text;
							bFound = true;
							break;
						}
					}
			
					if (bFound == false) {
						familyArray.push(fontName);
						textArray.push(text);
					}
				}
			
				parser.onTagClose = function (tagName) {
					tag = tagArray.pop();
					if (tag == null) return;
					if (tag.indexOf("font-family") != -1) {
						for (i = tagArray.length - 1; i >= 0; i--) {
							if (tagArray[i] == null) continue;
							if (tagArray[i].indexOf("font-family") != -1) {
								font = tagArray[i];
								return;
							}
						}
					}
					//font = null;
				}
			
				parser.onTagOpen = function (tagName, attributes, selfClosing) {
					if ((attributes == null) || (attributes.style == null)) {
						tagArray.push(null);
						return;
					}
			
					tagArray.push(attributes.style);
					if (attributes.style.indexOf("font-family") != -1) {
						font = attributes.style;
					}
			
				};
			
				parser.parse(text);
				parser = null;
				return {family:familyArray, text:textArray};
			}

			CKEDITOR.on('instanceReady', function(e) {
				
				e.editor.dataProcessor.htmlFilter.addRules(
					{
						elements:
						{
							$: function (element) {
								// Output dimensions of images as width and height
								if (element.name == 'img') {
									var style = element.attributes.style;
			
									if (style) {
										// Get the width from the style.
										var match = /(?:^|\s)width\s*:\s*(\d+)px/i.exec(style),
											width = match && match[1];
			
										// Get the height from the style.
										match = /(?:^|\s)height\s*:\s*(\d+)px/i.exec(style);
										var height = match && match[1];
			
										if (width) {
											element.attributes.style = element.attributes.style.replace(/(?:^|\s)width\s*:\s*(\d+)px;?/i, '');
											element.attributes.width = width;
										}
			
										if (height) {
											element.attributes.style = element.attributes.style.replace(/(?:^|\s)height\s*:\s*(\d+)px;?/i, '');
											element.attributes.height = height;
										}
									}
								}
			
			
			
								if (!element.attributes.style)
									delete element.attributes.style;
			
								return element;
							}
						}
					});


				//e.editor.execCommand( 'reloadWebFont');
								
			}); //CKEDITOR.on('instanceReady', function(e) 



			CKEDITOR.on( 'dialogDefinition', function( ev )
			{
			  // Take the dialog name and its definition from the event data.
			  var dialogName = ev.data.name;
			  var dialogDefinition = ev.data.definition;
			
			  // Check if the definition is from the dialog we're
			  // interested in (the 'image' dialog). This dialog name found using DevTools plugin



			  if ( dialogName == 'image' )
			  {

				 // Remove the 'Link' and 'Advanced' tabs from the 'Image' dialog.
				 dialogDefinition.removeContents( 'Link' );
				 dialogDefinition.removeContents( 'advanced' );
			
				 // Get a reference to the 'Image Info' tab.
				 var infoTab = dialogDefinition.getContents( 'info' );
			
				 // Remove unnecessary widgets/elements from the 'Image Info' tab.         
				 infoTab.remove( 'txtHSpace');
				 infoTab.remove( 'txtVSpace');
				 infoTab.remove( 'txtBorder' );
				 infoTab.remove( 'txtAlt' );
				 infoTab.remove( 'txtWidth' );
				 infoTab.remove( 'txtHeight' );
				 infoTab.remove( 'ratioLock' );
				 //infoTab.remove( 'htmlPreview' );
				 
				dialogDefinition.onSelect = function()
				{
					alert("onfocus");
					//var urlField = this.getContentElement( 'info', 'url' );
					//urlField.select();
				};
				  
			  }

			  
			  if ( dialogName == 'link' )
			  {
				// Remove the "Target" tab from the "Link" dialog.


				// Get a reference to the "Target" tab and set default to '_blank'
				/*
				var targetTab = dialogDefinition.getContents('target');
				var targetField = targetTab.get('linkTargetType');
				targetField['default'] = '_blank';
				*/
				/*
				var advTab =  dialogDefinition.getContents( 'advanced' );
				var cssField = advTab.get( 'advCSSClasses' );
				cssField['default'] = 'inviteTextLinkClass';
				*/
				
				var infoTab = dialogDefinition.getContents( 'info' );
				// Set the default value for the URL field.
				var urlField = infoTab.get( 'url' );
				urlField['default'] = 'www.example.com';
			
			
			
				// Rewrite the 'onFocus' handler to always focus 'url' field.
				dialogDefinition.onFocus = function()
				{
					var urlField = this.getContentElement( 'info', 'url' );
					urlField.select();
				};



				dialogDefinition.removeContents( 'target' );
				dialogDefinition.removeContents( 'advanced' );
				// Get a reference to the "Link Info" tab.
			
			
				// Remove the "Link Type" combo and the "Browser
				// Server" button from the "info" tab.
				infoTab.remove( 'linkType' );
				infoTab.remove( 'browse' );

			
			  }
			  
			  
			  
			});
			
			CKEDITOR.on('instanceCreated', function(e) {

				e.editor.addCommand( 'reloadWebFont',
				{
					exec : function( edr )
					{    
						htmltext2 =	edr.getData();
	
						//alert("reloadwebfont");
						//plaintext = edr.getData().replace( /(<[^<|>]+?>|\r\n|\n|\r|^\s*|\s*$|\s+|&nbsp;)/gim,'' );
						//plaintext_min = getMinTextInOrder(plaintext)
						//alert (plaintext_min);
			
						//1. update html
							cc = -1;
							//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
							$(edr.document.$).find('link').each(function() {
								
							//console.log(edr);	
							//console.log($(edr.document.$).find('link'));	
							//console.log($(CKEDITOR.instances[1].document.$).find('link'))
							//$(CKEDITOR.instances[1].document.$).find('link').each(function() {
								//	alert(cc);
								//bypass the first #webfontinfo_array.length css
								//if (cc >= 0) {
								if (cc>=0 && cc<webfontnum ) {
									tmp_webfontname = webfontinfo_array[cc].split('|')[0];
									tmp_webfont = webfontinfo_array[cc].split('|')[1];
									tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
									tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
									
									if (tmp_webfonttype==1 || tmp_webfonttype==3) {
									}else{
										new_webfont = tmp_webfont + $('#invite_detail_fontindex2270350').val();
										
										var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
										htmltext2 = htmltext2.replace(reg, new_webfont);
										htmltext2 = htmltext2.ReplaceAll(tmp_webfont+'_youvivid_dynamic_font',new_webfont);
									}
								} //if (cc>=0)
						
								cc=cc+1;
							
							
							});
							//}
	
	//console.log(htmltext);
							$('#iframepage').contents().find("#invite_detail_editor2270350").html(htmltext2);
							
							
							//////edr.setData(htmltext2, function(){
								//this.checkDirty();  // true
	
							//2. update csslink
	
								var fontArray = familyParser( htmltext2 );
	
	//console.log(fontArray);
	
								cc = -1;
								//$(CKEDITOR.instances[i].document.$).find('link').each(function() {
								$(edr.document.$).find('link').each(function() {
								//edr.find('link').each(function() {	
									
									//bypass the first css
	
									//if (cc>=0) {
									if (cc>=0 && cc<webfontnum ) {
										tmp_webfontname = webfontinfo_array[cc].split('|')[0];
										tmp_webfont = webfontinfo_array[cc].split('|')[1];
										tmp_webfonturl = webfontinfo_array[cc].split('|')[2];
										tmp_webfonttype = webfontinfo_array[cc].split('|')[3];
										
	
										//if (  edr.getData().toUpperCase().indexOf(tmp_webfont.toUpperCase()) >= 0 ) {
										//	var_text = tmp_webfontname + plaintext_min;
										//}else{
										//	var_text = tmp_webfontname ;
										//}
										//fontArray_idx = fontArray.family.indexOf(tmp_webfont.toLowerCase());
	
										fontArray_idx = -1;
										
										for (var i = 0; i < fontArray.family.length; i++) {
										  if (fontArray.family[i].trim() == tmp_webfont.toLowerCase()) {
											fontArray_idx = i;
											break;
										  }
										}
										
										//alert(tmp_webfont.toLowerCase() + ", fontArray_idx:" + fontArray_idx + ", font: " +  fontArray.family[fontArray_idx]+ ", text: " +  fontArray.text[fontArray_idx] );
										
										if ( fontArray_idx == -1 ){
											//nothing to do 
										} else {
											
											var_text = getMinTextInOrder(fontArray.text[fontArray_idx]);
		
											if (tmp_webfonttype==1 || tmp_webfonttype==3) {
												//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
												new_css_url = tmp_webfonturl ;
			
											}else{
												new_webfont = tmp_webfont + $('#invite_detail_fontindex2270350').val();
												
												post_url = tmp_webfonturl.split('?')[0];
												post_vars = tmp_webfonturl.split('?')[1] + "&text=" + encodeURIComponent(var_text);
		
												post_vars=post_vars.ReplaceAll(tmp_webfont,new_webfont);
												post_vars=post_vars.ReplaceAll(encodeURIComponent(tmp_webfont),encodeURIComponent(new_webfont));
		
												createRequest();
	
												//post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
												//serverUrl = 'http://cn.youvivid.com/';
												//post_url = "http://" + serverUrl.split(/\/+/g)[1] + ":8080/Fonts/csslink";
												//alert(post_url);
	
												
							
													if($.browser.msie && parseInt($.browser.version, 10) <= 9) {
														post_url = "http://cn.youvivid.com/mobile_invite_getcontentcssurl.asp";
													} else {
														post_url = "http://42.121.32.43:443/Fonts/csslink";
													}
							
												
	
	
												request.open("POST", post_url, false);
												request.setRequestHeader("Content-type","application/x-www-form-urlencoded");
											//	alert(post_url+"," + post_vars);
												request.send(post_vars);
												post_response = request.responseText; //?取服?器返回的JSON字串
											//	alert("post_response=" + post_response);
												// this is for testing 
												//new_css_url = tmp_webfonturl + "&text=" + encodeURIComponent(var_text);
												new_css_url = post_response;
												
												//ex: http://176.34.27.47:8080/Fonts/getcss/88b676b2-ef25-4a41-98da-365bf8299d42;jsessionid=E7BD1CD3D9271040A72A5952BC4ED719?family=粗P 
												//contentcss_url_part1=post_response.split('?family=')[0];
												//contentcss_url_part2=post_response.split('?family=')[1];
												//contentcss_url = contentcss_url_part1 + '?family=' + encodeURIComponent(contentcss_url_part2);
												//new_css_url =  contentcss_url;
												
								//console.log('tmp_webfont:' + tmp_webfont + ', new_webfont:' + new_webfont);
								//				var reg = new RegExp( tmp_webfont + '\\d+' , 'gim');
								//				htmltext = htmltext.replace(reg, new_webfont);
											}
			
											
										//	alert(new_css_url);
										//	console.log(new_css_url + ", id=" + tmp_webfont);
											$('#iframepage').contents().find("#" + tmp_webfont ).attr('href', new_css_url )
											
											
											$(this).attr('href', new_css_url );
										}//( fontArray_idx == -1 ){
									} //if (cc>=0)
							
									cc=cc+1;
								
								
								});
								//}
								// useless below
								//ev.editor.config.font_names = 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w';
								//CKEDITOR.config.font_names = 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w';
								
								// new ckeditor 4.3 no need to update fontindex 
								//$('#invite_detail_fontindex2270350').val(Number($('#invite_detail_fontindex2270350').val())+1);
			
	
						//////	});//edr.setData(htmltext2, function(){
	
	
	
						edr.resetDirty();
	
	
	
					},
					async : true //FIREFOX NEED THIS
				}); //end of e.editor.addCommand( 'reloadWebFont',
				/*
					e.editor.on( 'afterCommandExec', function(ev) { 
						alert(ev.data.name );
					});
					e.editor.on( 'selectionChange', function(ev) { 
								delay(function(){
									ev.editor.execCommand( 'reloadWebFont');
								},1000);
						//console.log(ev.data.selection );
						//console.log(ev.data.path );
						//alert(ev.data.selection + "," + ev.data.path );
					});
				*/
			
				e.editor.on( 'saveSnapshot', function(ev) { 
					delay(function(){
						ev.editor.execCommand( 'reloadWebFont');
					},200);
				});
			
			 

				//onchange plugin event
				e.editor.on( 'change', function(ev) { 
					
					if (ev.editor.checkDirty()) {
					// ... ok, we've really changed: respond here ...

						//alert('change');
						htmltext =	ev.editor.getData();
						$('#iframepage').contents().find("#invite_detail_editor2270350").html(htmltext);
							
						//if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	
	
							//delay(function(){
								//ev.editor.execCommand( 'reloadWebFont');
							//},1000);
	
						//} //if (htmltext.indexOf('_youvivid_dynamic_font')!= -1) {	


					}

				

				});

				e.editor.on( 'key', function(ev) { 
					if (ev.editor.checkDirty()) {
					// ... ok, we've really changed: respond here ...
						//alert('change');
						delay(function(){ //key down event use as key up event
							htmltext =	ev.editor.getData();
							$('#iframepage').contents().find("#invite_detail_editor2270350").html(htmltext);
						},1000);

					}

				});


			}); //CKEDITOR.on('instanceCreated', function(e) 
				

			CKEDITOR.config.templates_files = [
				//CKEDITOR.getUrl( 'plugins/templates/templates/default.js' )
				//CKEDITOR.getUrl( 'plugins/templates3/templates/funssage.js.asp?tcid=7' )
				CKEDITOR.getUrl( '../ckeditor_template.js.asp?tcid=7' )
			];


			if ( window.CKEDITOR && ( !CKEDITOR.env.ie || CKEDITOR.env.version > 7 ) )
				CKEDITOR.env.isCompatible = true;

			var invite_detail_editor2270350 = CKEDITOR.replace( 'invite_detail_editor2270350',
			{
				
				//filebrowserBrowseUrl: 'mobile_invite_select_photo_editor_plu_leo.asp?invite_detail_id=2270350',
				filebrowserBrowseUrl: 'mobile_invite_select_photo_editor_plu_s3oss.asp?invite_detail_id=2270350',
				filebrowserWindowWidth: '480',
				filebrowserWindowHeight: '610',
				//filebrowserImageBrowseUrl: 'mobile_invite_select_photo_editor.asp',
				//filebrowserUploadUrl: 'mobile_slideshow_select_photo_header.asp?invite_detail_id=1160483',
				//filebrowserImageUploadUrl: 'mobile_slideshow_select_photo_header.asp?invite_detail_id=1160483',
				//extraPlugins : 'templates3,reloadwebfont,devtools', 
				extraPlugins : 'templates3,reloadwebfont,confighelper,autogrow', 
				//extraPlugins : 'reloadwebfont', 
				//templates_replaceContent : true,
				//templates_files : [ CKEDITOR.getUrl( 'plugins/templates/templates/default.js.asp' )],
				toolbar :
				[
				
				
					{ name: 'reloadWebFont', items : ['reloadWebFont'] },{ name: 'source', items : ['Source'] },{ name: 'templates_page', items : ['Templates_page'] },{ name: 'templates_component', items : ['Templates_component'] },'/', //source cause problem for access document in change event
					
					//{ name: 'font face', items : [ 'Source','Font','FontSize' ] }, //source cause problem for access document in change event
					{ name: 'font face', items : [ 'Font','FontSize' ] },
					{ name: 'font type', items : [ 'Bold','Italic','TextColor','BGColor' ] },
					{ name: 'paragraph', items : [ 'JustifyLeft','JustifyCenter','JustifyRight' ] },
					{ name: 'links', items : [ 'Link','Unlink'] }
				],
				startupShowBorders : false,
				resize_enabled : false,
				toolbarCanCollapse : false,
				toolbarStartupExpanded : true,
				//height: 350,
				autoGrow_minHeight : 350,
				autoGrow_maxHeight : 700,
				//skin : 'office2003',
				skin : 'moono',
				language : 'zh-cn',
				//skin : 'v2',
				
				// use inline config instead
				//customConfig : '/ckeditor/config_leo.js'
				//enterMode : CKEDITOR.ENTER_BR,
				enterMode : CKEDITOR.ENTER_P,
				//font_names : 'Inconsolata/Inconsolata; 粗P/粗P, 微正黑w, Microsoft JhengHei, Microsoft YaHei, arial;' ,	
				font_names : "手机预设字体/Microsoft JhengHei,Microsoft YaHei,arial;粗钢笔/粗钢笔1,粗钢笔10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗圆/粗圆1,粗圆10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;古印体/古印体1,古印体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗广告体/粗广告体1,粗广告体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;隶书/隶书1,隶书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;书宋二/书宋二1,书宋二10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;中行书/中行书1,中行书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;", 
				//config.contentsCss = ['/ckeditor/contents_leo.css', 'http://176.34.27.47/fontScript/getfont.pl?family=%E7%B2%97%E9%8B%BC%E7%AD%86&text=ABCDEFG'] 
				//contentsCss : ['/ckeditor/contents_leo.css']
				//contentsCss : []	
				//contentsCss : contentcss_array, 
			    contentsCss : ["/ckeditor4.3.4_leo/contents2.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css","/ckeditor/empty.css"],
				removePlugins: 'elementspath',
				allowedContent: true 

			});				
			ck_editor2270350 = invite_detail_editor2270350;

			////console.log('手机预设字体/Microsoft JhengHei,Microsoft YaHei,arial;粗钢笔/粗钢笔1,粗钢笔10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗圆/粗圆1,粗圆10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;古印体/古印体1,古印体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;黑体/黑体1,黑体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗广告体/粗广告体1,粗广告体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;隶书/隶书1,隶书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;书宋二/书宋二1,书宋二10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;中行书/中行书1,中行书10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;粗行楷体/粗行楷体1,粗行楷体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;甜妞体/甜妞体1,甜妞体10,微软雅黑,宋体,Microsoft JhengHei,Microsoft YaHei,arial;');

	
			});  //jquery functiom
					
			</script>
			


	</div><!--End Tab-XXX -->



</div>

</div><!-- End invite_detail -->
                   </div>

                </div>
                <div style="margin-top: 15px" >
                  
                  <a href="javascript: updateOld('quicksave');" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('edit3','','images_we/cache_hover_cn.png',1)"><img src="images_we/cache_cn.png"  name="edit3"  border="0" id="edit3" style="vertical-align:middle" /></a>
                  &nbsp;&nbsp;
                  <a href="javascript: updateOld('nextstep');" onmouseout="MM_swapImgRestore()" onmouseover="MM_swapImage('edit1','','images_we/next_hover_cn.png',1)"><img src="images_we/next_cn.png"  name="edit1"  border="0" id="edit1" style="vertical-align:middle" /></a> <span  style="color:#C00; ">(点击下一步保存,K前往设置微信标题及文字)</span>       

  
                </div>
            
            </td>
          </tr>
        </table>
    </td>
  </tr>
</table>





</form>  









                    
                  </td>
                </tr>                  
              </table>    
                                           
          </td>
          <td width="10" class="right_side"></td>
        </tr>
      	<tr>
     			<td height="10" colspan="3" class="bottom_side"></td>
        </tr>
		  </table>             
<!-- For scrollToFixed plugin space-->
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>
        <BR>

		</td>
		
	</tr>
</table>
<div id="scroller-limit"></div>


<div id="copyright">
 
 <div id="copyright_top">
  
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td width="100%" align="center" valign="top">
                  
            <table width="800" border="0" cellpadding="0" cellspacing="0">
              <tr>
                <td width="133" align="center"><a href="http://cn.youvivid.net/we_contact.asp" >联络我们</a></td>
                <td width="4" align="center">|</td>
                <td width="133" align="center"><a href="http://cn.youvivid.net/mobile_invitation_faq" >常见问题</a></td>
                
                <!--
                <td width="4" align="center">|</td>
                <td width="133" align="center"><a href="http://cn.youvivid.net/designer_zone_0.asp">设计师专区</a></td>
                -->
                
                <td width="4" align="center">|</td>
                <td width="150" align="center"><a href="http://cn.youvivid.net" >微信请柬制作</a></td>
                
                <td width="4" align="center">|</td>
                <td width="110" align="center"><a href="http://cn.youvivid.com/wed_mv" >婚礼视频u作</a></td>
               
               
                <td width="4" align="center">|</td>
                <td width="133" align="center"><a href="http://cn.youvivid.net/we_eula.asp" target="_blank">会员服务条款</a></td>
                <td width="4" align="center">|</td>
                <td width="173" align="center"><a href="http://cn.youvivid.net/we_privacy.asp" target="_blank">隐私权保护政策</a></td>
                           
                <td width="13" align="center"></td>
              </tr>
            </table>
          
            </td>
           </tr>
          </table>            

  </div>

  <div id="copyright_bottom">

        <table width="100%" border="0" cellpadding="0" cellspacing="0">
          <tr>
            <td width="100%" align="center" valign="top">
                
                    
              <table width="944" border="0" cellpadding="0" cellspacing="0" >
                <tr>
                  <td width="7" align="right" ></td>
                  <td width="543">

					
                    
						雅安鑫盛网络科技有限责任公司<br>沪ICP备14000404号-2     
                    
                    
				
				
              	
              	</td>
                <td width="277" align="right">
              	
              
              				<a class="langlink" href="http://en.youvivid.com">English</a> | 
                          
              				<a class="langlink" href="http://cn.youvivid.com">简体中文</a> | 
                          
              				<a class="langlink" href="http://tw.youvivid.com">繁w中文</a> | 
                          
              				<a class="langlink" href="http://jp.youvivid.com">日本Z</a> | 
                          
              	
              	</td>
                <td width="12" align="left"></td>
                </tr>
              </table>
            </td>
           </tr>
          </table>       
            
  </div>  
  
</div>


<!--把下面代码加到<body>与</body>之间-->

		<style type="text/css">
        .box{width:140px; height:130px; border:0px solid #000; position:fixed; right:0%; top:100%;margin-left:-140px;margin-top:-150px;_position:absolute;_top:expression(eval(document.documentElement.clientHeight+document.documentElement.scrollTop)); _left:expression(eval(document.documentElement.clientWidth+document.documentElement.scrollLeft)); }
        </style>
        </p>
        <div class="box" id="box" align="right"><a href="#" onclick="document.getElementById('box').style.display = 'none';return false" style=" text-decoration: none;"><span style="color:#FFB321;">[X]</span></a><br><a href="mobile_invitation_faq" target="_blank"><img src="images_we/qna_online.png" alt="有}? c此M行上客服" width="140" height="129" border="0" title="有}? c此M行上客服"></a></div>
<!--
<script language="javascript" src="http://live.zoosnet.net/JS/LsJS.aspx?siteid=LEK80868421"></script>
-->
<!--
	
		<script language="javascript" src="http://live.zoosnet.net/JS/LsJS.aspx?siteid=LEK80868421&float=1&lng=cn"></script>
	
-->




<script src="js/detect_timezone.js" type="text/javascript"></script>
 
<script type="text/javascript">

function setCookie_timezone(c_name,value,exdays)
{
var exdate=new Date();
exdate.setDate(exdate.getDate() + exdays);
var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
document.cookie=c_name + "=" + c_value;
}

var timezone = jstz.determine();

setCookie_timezone('usrdata_timezone',timezone.name(),1);
//alert(timezone.name()); 

</script>


<script type="text/javascript" src="js/swfobject.js"></script>

<script language="JavaScript" type="text/JavaScript">
<!--
		//swfobject.embedSWF("test.swf", "view_area", "324", "274", "9.0.0","expressInstall.swf");
 var keep_objid;
 MM_preloadImages('images/tb3_btn_1_2.png','images/funssage_start_make_over_tw.png')

    function getFavorite( usrid, objid){

        var url = 'favorite_addnew_act.asp?sn=' + objid + '&usrid=' + usrid + '&rnd='+Math.random();

        if( window.XMLHttpRequest){

            xmlhttp2 = new XMLHttpRequest();
            xmlhttp2.open( 'GET', url, false);
            xmlhttp2.send( null);
            setFavorite();
            
        }
        
        else if( window.ActiveXObject){

            xmlhttp2 = new ActiveXObject('Microsoft.XMLHTTP');
            xmlhttp2.open( 'GET', url, false);
            xmlhttp2.onreadystatechange = setFavorite;
            xmlhttp2.send();
        }
              

        

    }
    
    function setFavorite(){

        var rtn;
        
        if( xmlhttp2.readyState == 4 ){ 

            if( xmlhttp2.status == 200){ 

                rtn = xmlhttp2.responseText;
                
                if( rtn == '1'){
                  
                  alert('成功加入模板到[我的收藏]');
                  
                }else if( rtn == '2'){
                  
                  alert('本模板已经存在[我的收藏]');
                  
                }
             }               
              
        }

    }


	var tb_objurl, tb_userdataurl, tb_makeucardurl;
	
// New function for reuse preview to make new asobj.previewid
	function switchSrc_variable3(objurl, userdataurl, objname, objdesc, objassetdesc, objid, asid, webimgurl, objauthor, makeucardurl) {
		
			
		tb_objurl = objurl;
		tb_userdataurl = userdataurl;
		document.getElementById('obj_name').innerHTML=objname;
		document.getElementById('obj_description').innerHTML=objdesc;
		if (objauthor.length > 0 ) document.getElementById('obj_author').innerHTML= '设计师: ' + objauthor;
		document.getElementById('obj_asset_desc').innerHTML=objassetdesc;
		tb_makeucardurl = makeucardurl
		keep_objid = objid;
		//switchSrc();
		//swfobject.embedSWF("expressInstall.swf", "view_area", "324", "274", "9.0.0","expressInstall.swf");

		//alert("set variable!" + objurl);
		
	}


	function switchSrc_variable(objurl, userdataurl, objname, objdesc, objassetdesc, objid, asid, webimgurl, objauthor) {
		tb_objurl = objurl;
		tb_userdataurl = userdataurl;
		document.getElementById('obj_name').innerHTML=objname;
		document.getElementById('obj_description').innerHTML=objdesc;
		if (objauthor.length > 0 ) document.getElementById('obj_author').innerHTML= '设计师: ' + objauthor;
		document.getElementById('obj_asset_desc').innerHTML=objassetdesc;
		tb_makeucardurl = 'preview_new.asp?objid=' + objid + '&asid=' + asid
		keep_objid = objid;
		//alert("set variable!" + objurl);
	}
//This is for index.asp use, no use now
	function switchSrc_variable2(objurl, userdataurl, objname, objdesc, objassetdesc, linkurl) {
		tb_objurl = objurl;
		tb_userdataurl = userdataurl;
		document.getElementById('obj_name').innerHTML=objname;
		document.getElementById('obj_description').innerHTML=objdesc;
		document.getElementById('obj_asset_desc').innerHTML=objassetdesc;
		tb_makeucardurl = linkurl;
		//keep_objid = objid;
		//alert("set variable!" + objurl);
	}

	function switchSrc_variable4(objurl, userdataurl) {
		//alert(objurl);
		tb_objurl = objurl;
		tb_userdataurl = userdataurl;
		switchSrc();
		$('#myOnPageContent').dialog('open');
		
	}


	function clearSrc() {
		tb_objurl = "";
		tb_userdataurl = "";
		switchSrc();
		//swfobject.embedSWF("test.swf", "view_area", "324", "274", "9.0.0","expressInstall.swf");
		//alert("clearSrc!");
	}

	

	function switchSrc(){
		// alert("switchSrc func!");
		
		var flashvars = {
		  playmode: "2",
		  controler: "controler1_newSkin3.swf",
		  objurl: tb_objurl,
		  userdataurl: tb_userdataurl,
		  reCheck: "1"
		};
		
		var params = {
		  base: ".",
		  quality: "high",
		  allowscriptaccess: "always",
		  allowFullScreen: "true",
		  wmode: "opaque"
		};
		
		swfobject.embedSWF("../view_151001_waterMarkv3_headNewSkin.swf", "view_area", "480", "406", "9.0.0","expressInstall.swf", flashvars, params);

/*
		if (navigator.appName.indexOf("Microsoft Internet")==-1){
			
			if (document.embeds && document.embeds['view']){
				document.embeds['view'].SetVariable("objurl",  tb_objurl);
				document.embeds['view'].SetVariable("userdataurl", tb_userdataurl);
				document.embeds['view'].SetVariable("reCheck", 1);
							  
				//document.embeds['view'].SetVariable("ServerUrl","http://www.youvivid.com/");
				//document.embeds['view'].SetVariable("objurl", "http://www.youvivid.com/" + objurl);
				//document.embeds['view'].SetVariable("userdataurl", "http://www.youvivid.com/" + userdataurl);
				//document.embeds['view'].SetVariable("playmode", "1");
				//document.embeds['view'].SetVariable("bautoplay", "1");
				//document.embeds['view'].SetVariable("reCheck", "1");
				//alert("func1");
			}
		} else if (navigator.appName.indexOf("Microsoft Internet")!=-1){
				document.getElementById('view').SetVariable("objurl", tb_objurl);
				document.getElementById('view').SetVariable("userdataurl", tb_userdataurl);
				document.getElementById('view').SetVariable("reCheck", 1);
		
				//document.getElementById('view').SetVariable("ServerUrl","http://www.youvivid.com/");
				//document.getElementById('view').SetVariable("objurl", "http://www.youvivid.com/" + objurl);
				//document.getElementById('view').SetVariable("userdataurl", "http://www.youvivid.com/" + userdataurl);
				//document.getElementById('view').SetVariable("playmode", "1");
				//document.getElementById('view').SetVariable("bautoplay", "1");
				//document.getElementById('view').SetVariable("reCheck", "1");
				//alert("func2");
		}  
		 //alert("done switchSrc func!");
*/
	}
	function showMoreSample(inobjid) {
		window.open('preview_showcase.asp?showobjid=' + inobjid, 'moreMVSamples' );
	}
-->
</script>
<script language="JavaScript" type="text/JavaScript">
<!--
function MM_preloadImages() { //v3.0
  var d=document; if(d.images){ if(!d.MM_p) d.MM_p=new Array();
    var i,j=d.MM_p.length,a=MM_preloadImages.arguments; for(i=0; i<a.length; i++)
    if (a[i].indexOf("#")!=0){ d.MM_p[j]=new Image; d.MM_p[j++].src=a[i];}}
}

function MM_swapImgRestore() { //v3.0
  var i,x,a=document.MM_sr; for(i=0;a&&i<a.length&&(x=a[i])&&x.oSrc;i++) x.src=x.oSrc;
}

function MM_findObj(n, d) { //v4.01
  var p,i,x;  if(!d) d</acument; if((p=n.indexOf("?"))>0&&parent.frames.length) {
    d=parent.frames[n.substring(p+1)].document; n=n.substring(0,p);}
  if(!(x=d[n])&&d.all) x=d.all[n]; for (i=0;!x&&i<d.forms.length;i++) x=d.forms[i][n];
  for(i=0;!x&&d.layers&&i<d.layers.length;i++) x=MM_findObj(n,d.layers[i].document);
  if(!x && d.getElementById) x=d.getElementById(n); return x;
}

function MM_swapImage() { //v3.0
  var i,j=0,x,a=MM_swapImage.arguments; document.MM_sr=new Array; for(i=0;i<(a.length-2);i+=3)
   if ((x=MM_findObj(a[i]))!=null){document.MM_sr[j++]=x; if(!x.oSrc) x.oSrc=x.src; x.src=a[i+2];}
}

MM_preloadImages('images/tb3_btn_1_1.png','images/funssage_start_make_over_tw.png');
//-->
</script>

<script>
	$(function() {
		
		
			$( "#myOnPageContent" ).dialog({
			    position: {my: "center", at: "center", of: window},
				autoOpen: false,
				width: 600, 
				height: 540, 
				modal: true, 
				dialogClass: 'noTitleStuff', 
				resizable: false
			});
	
			$( "#closeVideo" ).click(function() {
				//alert("closeVideo");
				clearSrc();
				$('#myOnPageContent').dialog('close');
				//dialogVideo.dialog("close");
				//setTimeout('tb_remove();',300);
				return false;
			});
	});
	


</script>



<div id="myOnPageContent" style="display:none" >

<div style="padding: 15px; padding-bottom: 15px; background-color: #eeeeee; border-radius: 10px; text-align: center;">

  <table width="540" border="0" cellspacing="0" cellpadding="0">
	  <tr>
	    <td align="right" valign="top">
	      <a id="closeVideo" href="#" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('ImageCloseWin','','images_youvivid/obj_close_hover.png',1)"><img src="images_youvivid/obj_close.png" alt="首页" name="ImageCloseWin" border="0" id="ImageCloseWin" style="border: 0px; cursor:pointer;" /></a>

	      </td>
	  </tr>
    <tr>
      
      <td align="center">

		<div id="view_area">
			<a href="http://www.adobe.com/go/getflashplayer"><img src="images/space.png" alt="Get Adobe Flash player" width="480" height="406" border="0" /></a>
		</div>

      </td>

    </tr>
	  <tr>
	    <td height="20" align="right" valign="top"></td>
	  </tr>
  </table>

</div>
<!--
  <table width="540" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td width="12" height="13" align="left" valign="bottom"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_1.png" width="12" height="13" /></td>
      <td style="behavior: url(css/iepngfix.htc)" background="images/tb3_7.png"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_7.png" width="21" height="13" /></td>
      <td width="21" height="13" align="left" valign="bottom"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_4.png" width="21" height="13" /></td>
    </tr>
    <tr>
      <td style="behavior: url(css/iepngfix.htc)" background="images/tb3_3.png"><img src="images/space.png" width="1" height="13" /></td>
      <td bgcolor="#fad1dd"><table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#fad1dd">
          <tr>
            <td width="33" height="33"  align="center" valign="middle">&nbsp;</td>
            <td align="center" valign="middle"></td>
            
            <td align="right" valign="top"><a id="closeVideo" href="#" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('ImageCloseWin','','images/tb3_btn_1_2.png',1)"><img src="images/tb3_btn_1_1.png" alt="首页" name="ImageCloseWin" border="0" id="ImageCloseWin" /></a></td>
          </tr>
          <tr>
            <td width="33" align="center" valign="middle"></td>
            <td >
            
		<div id="view_area">
			<a href="http://www.adobe.com/go/getflashplayer"><img src="images/space.png" alt="Get Adobe Flash player" width="480" height="406" border="0" /></a>
		</div>

			</td>
            <td align="left"  valign="top">
			</td>
          </tr>
          <tr>
            <td width="33" height="33" align="left">
            <img src="images/spacer.gif" width="33" height="1" /></td>
            <td align="right"
            >&nbsp;</td>
            <td align="right" valign="top"></td>
          </tr>
      </table></td>
      <td style="behavior: url(css/iepngfix.htc)" align="left" background="images/tb3_6.png">&nbsp;</td>
    </tr>
    <tr>
      <td width="12" height="21" align="left" valign="top"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_2.png" width="12" height="21" /></td>
      <td style="behavior: url(css/iepngfix.htc)" background="images/tb3_8.png">&nbsp;</td>
      <td width="21" height="21" align="left" valign="top"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_5.png" width="21" height="21" /></td>
    </tr>
  </table>

-->

</div>


<script>



function closeDialog(){
  
  $( "#PhotoSwipeTarget2" ).dialog("close"); 			
  
}


$(function() {
		$( "#closePhotoSwipe" ).click(function() {
			//alert("click closeVideo");
			$("#iframepage")[0].contentWindow.instance_hide();                       
			//$('#PhotoSwipeTarget2').dialog('close');
			return false;
		});
});

function showDialog(){
	
        						$("#PhotoSwipeTarget2").dialog({
							    position: {my: "center", at: "center", of: window},
								autoOpen: false,
								width: 640, 
								height: 540, 
								modal: true, 
								dialogClass: 'noTitleStuff', 
								resizable: false
                		});
                		
                		$( "#PhotoSwipeTarget2" ).dialog('open');        					
                    // $("#PhotoSwipeTarget").dialog('option', 'position', 'center');
        					
  
}

</script>

<div id="PhotoSwipeTarget2"  style="display:none" >


  <table width="540" border="0" cellspacing="0" cellpadding="0">
    <tr>
      <td width="12" height="13" align="left" valign="bottom"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_1.png" width="12" height="13" /></td>
      <td style="behavior: url(css/iepngfix.htc)" background="images/tb3_7.png"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_7.png" width="21" height="13" /></td>
      <td width="21" height="13" align="left" valign="bottom"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_4.png" width="21" height="13" /></td>
    </tr>
    <tr>
      <td style="behavior: url(css/iepngfix.htc)" background="images/tb3_3.png"><img src="images/space.png" width="1" height="13" /></td>
      <td bgcolor="#fad1dd"><table width="100%" border="0" cellpadding="0" cellspacing="0" bgcolor="#fad1dd">
          <tr>
            <td width="33" height="33"  align="center" valign="middle">&nbsp;</td>
            <td align="center" valign="middle"></td>
            <td align="right" valign="top"><a id="closePhotoSwipe" href="#" onMouseOut="MM_swapImgRestore()" onMouseOver="MM_swapImage('ImageCloseWin2','','images/tb3_btn_1_2.png',1)"><img src="images/tb3_btn_1_1.png" alt="首页" name="ImageCloseWin" border="0" id="ImageCloseWin2" /></a></td>
          </tr>
          <tr>
            <td width="33" align="center" valign="middle"></td>
            <td >
				<div id="PhotoSwipeTarget" style="width:480px; height: 406px"></div>
			</td>
            <td align="left"  valign="top">
			</td>
          </tr>
          <tr>
            <td width="33" height="33" align="left">
            <img src="images/spacer.gif" width="33" height="1" /></td>
            <td align="right"
            >&nbsp;</td>
            <td align="right" valign="top"></td>
          </tr>
      </table></td>
      <td style="behavior: url(css/iepngfix.htc)" align="left" background="images/tb3_6.png">&nbsp;</td>
    </tr>
    <tr>
      <td width="12" height="21" align="left" valign="top"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_2.png" width="12" height="21" /></td>
      <td style="behavior: url(css/iepngfix.htc)" background="images/tb3_8.png">&nbsp;</td>
      <td width="21" height="21" align="left" valign="top"><img style="behavior: url(css/iepngfix.htc)" src="images/tb3_5.png" width="21" height="21" /></td>
    </tr>
  </table>
</div>

    <script>
	
		String.prototype.ReplaceAll = function (AFindText,ARepText){
			raRegExp = new RegExp(AFindText,"g");
			return this.replace(raRegExp,ARepText)
		} 			
		//For ckeditor templates use
		function replaceVariable(html) {
			
			//alert($("#invite_activityplace").val());
			//html = html.ReplaceAll("{场所名称}",$("#invite_activityplace").val());
			//html = html.ReplaceAll("{场所地址}",$("#invite_activityplace").val());
			//return html;			
			
			
			//新郎
			if ($( "#invite_groomname" ).val().length!=0 ){ 
				html = html.ReplaceAll("{新郎}",$( "#invite_groomname" ).val());
			}
			//新娘
			if ($( "#invite_bridename" ).val().length!=0 ){ 
				html = html.ReplaceAll("{新娘}",$( "#invite_bridename" ).val());
			}
			//日期
			if ($("#invite_activitydate").datepicker( "getDate" ) != null ){ 
				var dateStr1 = $("#invite_activitydate").val();
				var dateStr2 = dateStr1.ReplaceAll("-","/");
				var yyyy = dateStr2.split('/')[0],
					mm = dateStr2.split('/')[1],
					dd = dateStr2.split('/')[2],
					str_activitydate=yyyy + "年" + mm + "月" + dd + "日";

					html = html.ReplaceAll("{宴客日期}",str_activitydate);
			//alert("{活动日期} >>> " + str_activitydate );
			}                                 
			//rg
			if ( $("#invite_activityhour").val().length != 0 ){
					var str_activitytime = '';
					var hr  = $("#invite_activityhour").val();
				
					str_activitytime = str_activitytime  + hr + "时"
						   
					if ( ! isNaN($("#invite_activityminute").val()) && $("#invite_activityminute").val() > 0  ){
						var mn = $("#invite_activityminute").val();
						str_activitytime = str_activitytime  + mn + "分"
					} 
					html = html.ReplaceAll("{宴客时间}",str_activitytime);
			} 
			//地c
			if ( $("#invite_activityplace").val().length!=0 ){ 
					var str_activityplace = $("#invite_activityplace").val();
					html = html.ReplaceAll("{场所名称}",str_activityplace);
			}
			//地址
			if ( $("#invite_activityaddress").val().length!=0 ){ 
					var str_activityaddress = $("#invite_activityaddress").val();
					html = html.ReplaceAll("{场所地址}",str_activityaddress);
			}
			//
			if ( $("#invite_contactphone").val().length!=0 ){ 
					var str_contactphone = $("#invite_contactphone").val();
					html = html.ReplaceAll("{联络电话}",str_contactphone);
			}
			return html;			
			
		}
	
	
        //$(function() {
		$(document).ready(function(){
			
                var invite_groomname = $( "#invite_groomname" ),
                    invite_bridename = $( "#invite_bridename" ),
                    invite_activityaddress = $( "#invite_activityaddress" ),
                    allFields = $( [] ).add( invite_groomname ).add( invite_bridename ),
                    tips = $( ".validateTips" );
        
				

                function updateTips( t ) {
                     tips
                        .text( t )
                        .addClass( "ui-state-highlight" );
                    setTimeout(function() {
                     tips
                        .removeClass( "ui-state-highlight", 1500 );
                    }, 4500 );
                }


			


        		// checkLength( invite_groomname, "invite_groomname", 1, 20 );
                function checkLength( o, n, min, max ) {
                    if ( o.val().length > max || o.val().length < min ) {
                        o.addClass( "ui-state-error" );
                        //updateTips( "入" + n + ", must be between " +  min + " and " + max + "." );
                        updateTips( "请输入" + n + ", 本栏位不得空白 " );
                        return false;
                    } else {
                        return true;
                    }
                }
        
		
		
		
		
		
        
                var basicInfoDialog = $( "#basicInfo" ).dialog({
				    position: {my: "center", at: "top", of: window},
                    width: 600, 
                    height: 420, 
                    modal: true, 
				 					
					autoOpen: false,
				 					
					
               		closeOnEscape: false,
        			//open: function(event, ui) {  $(".ui-dialog-titlebar-close", ui.dialog).hide(); },
					close: function(event, ui) { 
							
					
						},
                    resizable: false,
					buttons: [{
						text: '确定',
						"class": 'closeButtonClass',
						click: function() {
                            var bValid = true;
							var editorBuf, remindBuf, mapDescBuf;
							editorBuf = ck_editor2270339.getData();
							remindBuf = $("#remindmsg").val();
							mapDescBuf = $("#invite_detail_mapdesc2270343"  ).val();

							allFields.removeClass( "ui-state-error" );
                            bValid = bValid && checkLength( invite_groomname, "男方姓名", 1, 40 );
                            bValid = bValid && checkLength( invite_bridename, "女方姓名", 1, 40 );
                            if ( bValid ) {
                            	//新郎新娘
                                $("#invite_maintitle").val( $("#invite_maintitle").val().replace( '{新娘}', invite_bridename.val()).replace( '{新郎}', invite_groomname.val()) );	
                                $("#invite_maintitle").change();
								
								editorBuf = editorBuf.ReplaceAll("{新娘}",invite_bridename.val());
								editorBuf = editorBuf.ReplaceAll("{新郎}",invite_groomname.val());
								
								remindBuf = remindBuf.ReplaceAll("{新娘}",invite_bridename.val());
								remindBuf = remindBuf.ReplaceAll("{新郎}",invite_groomname.val());
								//alert(remindBuf);


								//alert(ck_editor2270339.getData());
                            	//日期
                                if ($("#invite_activitydate").datepicker( "getDate" ) != null ){ 
								
									var activityDate = new Date($("#invite_activitydate").val());
//alert($("#invite_activitydate").datepicker( "getDate" ));
//alert(activityDate);
									var activityDate = $("#invite_activitydate").datepicker( "getDate" )

									var alertDate = new Date();
									alertDate.setTime(activityDate.getTime()- 3*24*60*60*1000);
									var str_alertDate = '' + alertDate.getFullYear() + '/' + (alertDate.getMonth()+1) + '/' + alertDate.getDate(); 
									//alert(str_alertDate);
									$( "#countdowndate" ).datepicker( "setDate" , activityDate );
									$( "#reminddate" ).datepicker( "setDate" , alertDate );

									var dateStr1 = $("#invite_activitydate").val();
									var dateStr2 = dateStr1.ReplaceAll("-","/");
                                    var yyyy = dateStr2.split('/')[0],
                                        mm = dateStr2.split('/')[1],
                                        dd = dateStr2.split('/')[2],
                                        str_activitydate=yyyy + "年" + mm + "月" + dd + "日";
                                        $("#invite_subtitle").val( $("#invite_subtitle").val().replace( '{宴客日期}', str_activitydate) );	
                                        $("#invite_subtitle").change();

										editorBuf = editorBuf.ReplaceAll("{宴客日期}",str_activitydate);
										remindBuf = remindBuf.ReplaceAll("{宴客日期}",str_activitydate);


	                                //alert(yyyy);  
                                } else {
									// 未x 日期rg O置30天後
									var alertDate = new Date();
									
									alertDate.setTime(alertDate.getTime()+ 27*24*60*60*1000);
									
									$( "#reminddate" ).datepicker( "setDate" , alertDate );
									
									alertDate.setTime(alertDate.getTime()+ 3*24*60*60*1000);
									var str_alertDate = '' + alertDate.getFullYear() + '/' + (alertDate.getMonth()+1) + '/' + alertDate.getDate(); 
									//alert(str_alertDate);
									$( "#countdowndate" ).datepicker( "setDate" , alertDate );
								}
                                
								
                            	//rg

                                if ( $("#invite_activityhour").val().length != 0 ){
										$( "#countdownhour" ).val($("#invite_activityhour").val());
 
                                		var str_activitytime = '';
                                    	var hr  = $("#invite_activityhour").val();
                                    
										
                                        str_activitytime = str_activitytime  + hr + "时"
                                               
		                                if ( ! isNaN($("#invite_activityminute").val()) && $("#invite_activityminute").val() > 0  ){
											$( "#countdownminute" ).val($("#invite_activityminute").val());
                                        	var mn = $("#invite_activityminute").val();
                                        	str_activitytime = str_activitytime  + mn + "分"
                                        } else {
											$( "#countdownminute" ).val("0");
										}
					                                              
                                    
										editorBuf = editorBuf.ReplaceAll("{宴客时间}",str_activitytime);
										remindBuf = remindBuf.ReplaceAll("{宴客时间}",str_activitytime);
                                    
	                                //alert(str_activitytime);  
                                } else {
										$( "#countdownhour" ).val("0");
								}
                                
                                //地c

                                if ( $("#invite_activityplace").val().length!=0 ){ 
                                    	var str_activityplace = $("#invite_activityplace").val();
										editorBuf = editorBuf.ReplaceAll("{场所名称}",str_activityplace);
										remindBuf = remindBuf.ReplaceAll("{场所名称}",str_activityplace);
										mapDescBuf = mapDescBuf.ReplaceAll("{场所名称}",str_activityplace);
	                                //alert(invite_activityplace);  
                                }
                                //地址

                                if ( $("#invite_activityaddress").val().length!=0 ){ 
                                    	var str_activityaddress = $("#invite_activityaddress").val();
										editorBuf = editorBuf.ReplaceAll("{场所地址}",str_activityaddress);
										remindBuf = remindBuf.ReplaceAll("{场所地址}",str_activityaddress);
										mapDescBuf = mapDescBuf.ReplaceAll("{场所地址}",str_activityaddress);
										 $("#address2270343").val($("#invite_activityaddress").val());
										 //fire change event to remove the tip
										 $("#address2270343").change();

										 //alert(document.getElementById("address2270343").value);
										 // codeAddress2270343();
										
										//Set map location if valid
								
								
										var geocoder = new BMap.Geocoder();
										geocoder.getPoint($( "#invite_activityaddress" ).val(), function(point){
										  if (point) {
											map2270343_latcenter  = point.lat;
											map2270343_lngcenter  = point.lng;
											map2270343_latmarker  = point.lat;
											map2270343_lngmarker  = point.lng;
											$('#invite_detail_latcenter2270343').val(point.lat);  
											$('#invite_detail_lngcenter2270343').val(point.lng);  
											$('#invite_detail_latmarker2270343').val(point.lat);  
											$('#invite_detail_lngmarker2270343').val(point.lng);  
											$('#iframepage').get(0).contentWindow.map2270343_latcenter=point.lat;
											$('#iframepage').get(0).contentWindow.map2270343_lngcenter=point.lng;
											$('#iframepage').get(0).contentWindow.map2270343_latmarker=point.lat;
											$('#iframepage').get(0).contentWindow.map2270343_lngmarker=point.lng;
										  } else {
											  //nothing I can do
										  }
										});
								
										
										

                                }
                                //
                                if ( $("#invite_contactphone").val().length!=0 ){ 
                                    	var str_contactphone = $("#invite_contactphone").val();
										editorBuf = editorBuf.ReplaceAll("{联络电话}",str_contactphone);
										remindBuf = remindBuf.ReplaceAll("{联络电话}",str_contactphone);
										mapDescBuf = mapDescBuf.ReplaceAll("{联络电话}",str_contactphone);
	                                //alert(str_contactphone);  
                                }

                                ck_editor2270339.setData(editorBuf, function()
								{
	                                ck_editor2270339.fire( 'change' );
								});
								
								// default value of description for weixin
 								$("#invite_description").val(str_activitydate + ' ' + str_activitytime + ' ' + str_activityplace + ' ' + invite_groomname.val() + '&' + invite_bridename.val() );
								
								$("#remindmsg").val(remindBuf);
								$("#invite_detail_mapdesc2270343").val(mapDescBuf);
								$("#invite_detail_mapdesc2270343").change();
								 countWords();
								basicInfoDialog.closest('div.ui-dialog').appendTo('#form_invite'); //add dialog to form variable								
                                $( this ).dialog( "close" );
								
								reloadMainPanelFont();
								//ck_editor2270339.execCommand( 'reloadWebFont');

		
							
							
		
		
								
								$("#select_image").click();
                            }
						
						}
					}]
						
                }); //basicInfoDialog end
/*
				$( "#invite_activitydate" ).datepicker({
					//changeMonth: true,
					//changeYear: true,
					closeText: 'P]',
					prevText: '&#x3c;上月',
					nextText: '下月&#x3e;',
					currentText: '今天',
					monthNames: ['一月','二月','三月','四月','五月','六月',
					'七月','八月','九月','十月','十一月','十二月'],
					monthNamesShort: ['一','二','三','四','五','六',
					'七','八','九','十','十一','十二'],
					dayNames: ['星期日','星期一','星期二','星期三','星期四','星期五','星期六'],
					dayNamesShort: ['周日','周一','周二','周三','周四','周五','周六'],
					dayNamesMin: ['日','一','二','三','四','五','六'],
					weekHeader: '周',
					dateFormat: 'yy/mm/dd',
					firstDay: 1,
					isRTL: false,
					showMonthAfterYear: true,
					yearSuffix: '年'
				});
*/
				$( "#invite_activitydate" ).datepicker( $.datepicker.regional[ 'zh-CN' ] );
                
        
        }); //end of $(document).ready
        
    


    
    </script>
	
        <div id="basicInfo" title="请填写基本资料" style="display:; font-size:15px; overflow: hidden; width:650px" >
          <p class="validateTips">填写完成后点击确定,系统将自动生成您的请帖:</p>
    <br/>                
    
		    <table width="100%" border="0">
              <tr>
                <td width="19%" style="text-align: right"><label for="invite_groomname">男方姓名: </label></td>
                <td width="81%"><input class="text ui-widget-content ui-corner-all" type="text" title="例如:李大仁" id="invite_groomname" name="invite_groomname" value=""  size="15" /><!--(必填)--></td>
              </tr>
              <tr>
                <td style="text-align: right"><label for="invite_bridename">女方姓名: </label></td>
                <td><input class="text ui-widget-content ui-corner-all" type="text" title="例如:程又青"  id="invite_bridename" name="invite_bridename" value=""  size="15" /><!--(必填)--></td>
              </tr>
              <tr>
                <td style="text-align: right"><label for="invite_activitydate">宴客日期: </label></td>
                <td>
                    <table width="100%" border="0">
                      <tr>
                        <td><input type="text" title="例:2015-12-31" class="text ui-widget-content ui-corner-all" id="invite_activitydate" name="invite_activitydate" value=""  size="15" readonly="true" /></td>
                        <td><label for="invite_activityhour">时间: </label></td>
                        <td><input type="text" title="例:12"  class="text ui-widget-content ui-corner-all" id="invite_activityhour" name="invite_activityhour" value=""  size="4" /></td>
                        <td><label for="invite_activityminute">时</label></td>
                        <td><input type="text" title="例:30"  class="text ui-widget-content ui-corner-all" id="invite_activityminute" name="invite_activityminute" value=""  size="4" /></td>
                        <td><label for="invite_activityminute">分</label></td>
                      </tr>
                    </table>
                 </td>
              </tr>
              <tr>
                <td style="text-align: right"><label for="invite_activityplace">场所名称: </label></td>
                <td><input type="text" title="例如:国宾饭店二楼国际厅" class="text ui-widget-content ui-corner-all" id="invite_activityplace" name="invite_activityplace" value=""  size="30" /></td>
              </tr>
              <tr>
                <td style="text-align: right; vertical-align:top"><label for="invite_activityaddress">场所地址: </label></td>
                <td><input type="text" title="例如:台北市中山北路二段63号" class="text ui-widget-content ui-corner-all" id="invite_activityaddress" name="invite_activityaddress" value=""  size="40" /><div style=" color:#999">填写详细地址(省市到街道门牌)以便地图准确标示</div></td>
              </tr>
              <tr>
                <td style="text-align: right"><label for="invite_contactphone">连络电话: </label></td>
                <td><input type="text" title="例如:(02)2551-1111" class="text ui-widget-content ui-corner-all" id="invite_contactphone" name="invite_contactphone" value=""  size="20" /></td>
              </tr>
            </table>
        </div>

             

<script language='javascript'>
<!--

  function init(){

     // syncGallery();   
   
      if (document.getElementById('iframepage').contentWindow.document.getElementById('maintitlehtml').childNodes[0].style.fontWeight == 'bold') selOn( document.getElementById('maintitlehtmlbold'));        
      if (window.frames.iframepage.document.getElementById('maintitlehtml').childNodes[0].style.fontStyle == 'italic') selOn( document.getElementById('maintitlehtmlitalic'));     
      if (window.frames.iframepage.document.getElementById('maintitlehtml').childNodes[0].style.textDecoration == 'underline') selOn( document.getElementById('maintitlehtmlunderline'));
          
      document.getElementById('selSize1').value = window.frames.iframepage.document.getElementById('maintitlehtml').childNodes[0].style.fontSize.replace('px','');
      
      
      if (window.frames.iframepage.document.getElementById('subtitlehtml').childNodes[0].style.fontWeight == 'bold') selOn( document.getElementById('subtitlehtmlbold'));                            
      if (window.frames.iframepage.document.getElementById('subtitlehtml').childNodes[0].style.fontStyle == 'italic') selOn( document.getElementById('subtitlehtmlitalic'));
      if (window.frames.iframepage.document.getElementById('subtitlehtml').childNodes[0].style.textDecoration == 'underline') selOn( document.getElementById('subtitlehtmlunderline'));

      document.getElementById('selSize2').value = window.frames.iframepage.document.getElementById('subtitlehtml').childNodes[0].style.fontSize.replace('px','');
      
      
      countWords();  
  }


-->
</script>

</body>
</html>
